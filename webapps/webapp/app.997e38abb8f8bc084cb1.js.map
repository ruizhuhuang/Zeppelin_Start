{"version":3,"sources":["webpack:///app.997e38abb8f8bc084cb1.js","webpack:///webpack/bootstrap 997e38abb8f8bc084cb1","webpack:///./src/index.js","webpack:///./src/app/app.js","webpack:///./src/app/app.controller.js","webpack:///./src/app/home/home.controller.js","webpack:///./src/app/handsontable/handsonHelper.js","webpack:///./src/app/notebook/notebook.controller.js","webpack:///./src/app/tabledata/tabledata.js","webpack:///./src/app/tabledata/transformation.js","webpack:///./src/app/tabledata/pivot.js","webpack:///./src/app/tabledata/passthrough.js","webpack:///./src/app/tabledata/columnselector.js","webpack:///./src/app/visualization/visualization.js","webpack:///./src/app/visualization/builtins/visualization-table.js","webpack:///./src/app/visualization/builtins/visualization-nvd3chart.js","webpack:///./src/app/visualization/builtins/visualization-barchart.js","webpack:///./src/app/visualization/builtins/visualization-piechart.js","webpack:///./src/app/visualization/builtins/visualization-areachart.js","webpack:///./src/app/visualization/builtins/visualization-linechart.js","webpack:///./src/app/visualization/builtins/visualization-scatterchart.js","webpack:///./src/app/jobmanager/jobmanager.controller.js","webpack:///./src/app/jobmanager/jobs/job.controller.js","webpack:///./src/app/jobmanager/jobmanager.filter.js","webpack:///./src/app/interpreter/interpreter.controller.js","webpack:///./src/app/interpreter/interpreter.filter.js","webpack:///./src/app/credential/credential.controller.js","webpack:///./src/app/configuration/configuration.controller.js","webpack:///./src/app/notebook/paragraph/paragraph.controller.js","webpack:///./src/app/notebook/paragraph/result/result.controller.js","webpack:///./src/app/search/result-list.controller.js","webpack:///./src/app/notebookRepos/notebookRepos.controller.js","webpack:///./src/app/helium/helium.controller.js","webpack:///./src/components/arrayOrderingSrv/arrayOrdering.service.js","webpack:///./src/components/clipboard/clipboard.controller.js","webpack:///./src/components/navbar/navbar.controller.js","webpack:///./src/components/ngescape/ngescape.directive.js","webpack:///./src/components/interpreter/interpreter.directive.js","webpack:///./src/components/expandCollapse/expandCollapse.directive.js","webpack:///./src/components/noteName-create/notename.controller.js","webpack:///./src/components/noteName-import/notenameImport.controller.js","webpack:///./src/components/popover-html-unsafe/popover-html-unsafe.directive.js","webpack:///./src/components/popover-html-unsafe/popover-html-unsafe-popup.directive.js","webpack:///./src/components/editor/codeEditor.directive.js","webpack:///./src/components/ngenter/ngenter.directive.js","webpack:///./src/components/dropdowninput/dropdowninput.directive.js","webpack:///./src/components/resizable/resizable.directive.js","webpack:///./src/components/noteName-create/visible.directive.js","webpack:///./src/components/websocketEvents/websocketMsg.service.js","webpack:///./src/components/websocketEvents/websocketEvents.factory.js","webpack:///./src/components/noteListDataFactory/noteList.datafactory.js","webpack:///./src/components/baseUrl/baseUrl.service.js","webpack:///./src/components/browser-detect/browserDetect.service.js","webpack:///./src/components/saveAs/saveAs.service.js","webpack:///./src/components/searchService/search.service.js","webpack:///./src/components/login/login.controller.js","webpack:///./src/components/elasticInputCtrl/elasticInput.controller.js","webpack:///./src/components/noteAction/noteAction.service.js","webpack:///./src/components/notevarshareService/notevarshare.service.js","webpack:///./src/components/rename/rename.controller.js","webpack:///./src/components/rename/rename.service.js","webpack:///./src/components/helium/helium.service.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","auth","$http","angular","injector","get","baseUrlSrv","defaults","withCredentials","jQuery","ajaxSetup","dataType","xhrFields","crossDomain","getRestApiBase","then","response","zeppelinWebApp","run","$rootScope","ticket","fromJson","data","body","errorResponse","bootstrapApplication","$location","$on","event","next","current","$$route","publicAccess","path","bootstrap","document","filter","text","replace","config","$httpProvider","$routeProvider","ngToastProvider","visBundleLoad","load","heliumService","when","templateUrl","controller","resolve","controllerAs","otherwise","redirectTo","configure","dismissButton","dismissOnClick","combineDuplications","timeout","$provide","factory","$q","responseError","rejection","status","info","$broadcast","reject","interceptors","push","constant","element","ready","MainCtrl","$scope","$window","arrayOrderingSrv","looknfeel","init","asIframe","location","href","indexOf","defaultPrevented","preventDefault","noteName","note","_","isEmpty","getNoteName","BootstrapDialog","defaultOptions","onshown","this","find","focus","configDefaultOptions","animate","$inject","HomeCtrl","noteListDataFactory","websocketMsgSrv","ngToast","noteActionSrv","TRASH_FOLDER_ID","dismiss","vm","notes","notebookHome","noteCustomHome","undefined","staticHome","isReloading","query","q","initHome","getHomeNote","reloadNoteList","reloadAllNotesFromRepo","isReloadingNotes","toggleFolderNode","node","hidden","on","e","viewOnly","renameNote","nodeId","nodePath","moveNoteToTrash","noteId","moveFolderToTrash","folderId","restoreNote","restoreFolder","restoreAll","renameFolder","removeNote","removeFolder","emptyTrash","clearAllParagraphOutput","isFilterNote","name","toLowerCase","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","HandsonHelper","columns","rows","comment","_numericValidator","bind","columnNames","resultRows","self","colHeaders","rowHeaders","stretchH","sortIndicator","columnSorting","contextMenu","manualColumnResize","manualRowResize","readOnly","readOnlyCellClassName","fillHandle","fragmentSelection","disableVisualSelection","cells","ro","co","pro","cellProperties","colType","type","renderer","td","row","col","prop","_cellRenderer","afterGetColHeader","TH","menu","_buildDropDownMenu","button","_buildTypeSwitchButton","_addButtonMenuEvent","Handsontable","Dom","addEvent","nodeName","_setColumnType","firstChild","lastChild","removeChild","appendChild","style","changeTypeMenu","position","removeMenu","stopImmediatePropagation","querySelectorAll","len","display","getBoundingClientRect","top","window","scrollY","pageYOffset","left","parentNode","removeEvent","activeCellType","item","createElement","types","className","innerText","textContent","innerHTML","isNaN","Number","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","_isNumeric","format","textAlign","renderers","NumericRenderer","apply","arguments","substring","TextRenderer","callback","d","moment","isValid","_setColumnValidator","updateSettings","validateCells","_isColumnSorted","sort","sortOrder","sortingEnabled","sortColumn","validator","_dateValidator","default","NotebookCtrl","$route","$routeParams","$timeout","saveAsService","noteVarShareService","convertPermissionsToArray","permissions","owners","val","readers","writers","editorToggled","tableToggled","showSetting","looknfeelOption","cronOption","interpreterSettings","interpreterBindings","isNoteDirty","saveTimer","connectedOnce","isRevisionPath","pattern","RegExp","test","noteRevisions","currentRevision","revisionView","param","initNotebook","getCronOptionNameFromValue","o","blockAnonUsers","zeppelinVersion","url","content","show","closable","closeByBackdrop","closeByKeyboard","title","message","buttons","label","action","dialog","close","clear","revisionId","getNoteByRevision","getNote","listRevisionHistory","currentRoute","setTimeout","routeParams","params","$id","paragraph","offset","scrollTo","focusParagraphOnClick","clickEvent","paragraphs","paragraphId","contains","addEventListener","keyboardShortcut","keyEvent","paragraphOnDoubleClick","isTrash","split","exportNote","jsonContent","JSON","stringify","saveAs","cloneNote","confirm","result","checkpointNote","commitMessage","getElementById","setNoteRevision","revisionList","splice","index","findIndex","initializeLookAndFeel","visitRevision","revision","danger","verticalPosition","dismissOnTimeout","runAllParagraphs","map","settings","saveNote","forEach","par","scope","saveParagraph","toggleAllEditor","showAllEditor","hideAllEditor","toggleAllTable","showAllTable","hideAllTable","isNoteRunning","killSaveTimer","cancel","startSaveTimer","setLookAndFeel","setConfig","setCronScheduler","cronExpr","cronExecutingUser","principal","cron","setCronExecutingUser","setReleaseResource","releaseresource","updateNote","updateNoteName","newName","trimmedNewName","trim","cleanParagraphExcept","noteCopy","editorHide","tableHide","addPara","each","para","removePara","removeIdx","idx","paragraphUrl","newIdx","removedPara","getInterpreterBindings","interpreterBindingsOrig","copy","setting","selected","selectedIntp","interpreterSelectionListeners","accept","sourceItemHandleScope","destSortableScope","itemMoved","orderChanged","openSetting","closeSetting","isSettingDirty","$apply","saveSetting","selectedSettingIds","no","saveInterpreterBindings","n","regExp","exec","toggleSetting","closePermissions","getPermissions","success","headers","permissionsOrig","selectJson","tokenSeparators","ajax","term","delay","processResults","results","users","children","roles","pagination","more","cache","width","tags","minimumInputLength","setIamOwner","select2","error","openPermissions","showPermissions","isPermissionsDirty","restartInterpreter","interpeter","thisConfirm","payload","$modalFooter","addClass","html","put","savePermissions","alert","modal","togglePermissions","isAnonymous","isOwner","toggleNotePersonalizedMode","personalizedMode","modeText","updatePersonalizedMode","equals","click","hide","newIndex","prevParagraph","moveParagraph","nextParagraph","currentParagraphId","insertParagraph","$unBindKeyEvent","isPersonalized","off","removeEventListener","actionbarHeight","lastElementChild","clientHeight","css","TableData","paragraphResult","array","textRows","msg","commentRow","textRow","textCols","cols","cols2","j","aggr","Transformation","_emitter","tableData","targetEl","getSetting","_scope","k","_prevSettingScope","_createNewScope","template","endsWith","_templateRequest","t","_render","_targetEl","_compile","contents","_interopRequireDefault","obj","__esModule","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_transformation","_transformation2","PivotTransformation","_Transformation","getPrototypeOf","configObj","common","pivot","tableDataColumns","save","emitConfig","removeKey","keys","removeGroup","groups","removeValue","values","setValueAggr","firstTime","removeUnknown","selectDefault","unique","list","found","a","b","aggrFunc","sum","varA","parseFloat","varB","count","parseInt","min","Math","max","avg","aggrFuncDiv","schema","s","order","keyKey","g","group","groupKey","v","valueKey","PassthroughTransformation","ColumnselectorTransformation","columnSelectorProp","_this","remove","selectorName","fields","f","Array","_renderSetting","Visualization","_dirty","_active","refresh","isActive","_visualization","_visualization2","_passthrough","_passthrough2","_handsonHelper","_handsonHelper2","TableVisualization","_Visualization","passthrough","hot","render","height","container","pluck","destroy","handsonHelper","getHandsonTableConfig","Nvd3ChartVisualization","append","chart","update","d3g","nv","models","configureChart","animationDuration","numberOfDataThreshold","ignoreErr","d3","select","attr","datum","transition","duration","x","round","slice","xLabels","isFinite","abs","pow","customAbbrevFormatter","groupedThousandsWith3DigitsFormatter","allowTextXAxis","fillMissingValues","multiBarChart","concat","getSchemaUnderKey","traverse","sKey","rKey","r","func","rowName","rowValue","colName","valueOnly","cs","noKey","isMultiBarChart","rowNameIndex","rowIdx","colNameIndex","colIdx","rowIndexValue","xVar","yVar","y","withoutAggr","namesWithoutAggr","lastIndexOf","valueIndex","d3gIndex","join","selectAll","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getter","_visualizationNvd3chart","_visualizationNvd3chart2","_pivot","_pivot2","BarchartVisualization","_Nvd3ChartVisualizati","d3Data","d3DataFromPivot","yAxis","axisLabelDistance","tickFormat","yAxisTickFormat","stacked","dispatch","PiechartVisualization","generateLabel","suffix","prefix","showLabels","showTooltipPercent","AreachartVisualization","xLables","xAxis","xAxisTickFormat","useInteractiveGuideline","LinechartVisualization","lineWithFocus","currentMode","forceY","_columnselector","_columnselector2","ScatterchartVisualization","columnselectorProps","tooltip","columnselector","setScatterChart","yLabels","showDistX","showDistY","xValue","yValue","size","xValues","yValues","grpNameIndex","colIndexValue","grpIndexValue","grpIdx","grpName","isAllDiscrete","isDiscrete","setDiscreteScatterData","epsilon","sz","xval","yval","random","d3gvalues","grp","newRows","newRow","field","getUnique","uniqObj","uniqArr","String","threshold","options","JobmanagerCtrl","$interval","jobManagerFilter","asyncNotebookJobFilter","jobInfomations","filterConfig","JobInfomationsByFilter","jobTypeFilter","doFiltering","isLoadingFilter","filterValueToName","filterValue","maxStringLength","activeInterpreters","substr","setFilterValue","filterValueInterpreter","onChangeRunJobToAlwaysTopToggle","isRunningAlwaysTop","onChangeSortAsc","isSortByAsc","doFilterInputTyping","RETURN_KEY_CODE","dofilterTimeoutObject","isActiveSearchTimer","which","doForceFilterInputTyping","filterValueNotebookName","sortTooltipMsg","getNoteJobsList","$watch","unsubscribeJobManager","responseData","lastJobServerUnixTime","lastResponseUnixTime","jobs","jobInfomationsIndexs","indexBy","interpreterLists","uniq","indexStore","changedItem","newItem","changeOriginTarget","isRemoved","removeIndex","isRunningJob","noteType","interpreter","unixTimeLastRun","JobCtrl","jobInformation","progressValue","getProgress","statusList","notebookJob","runningJob","countBy","totalCount","runningJobCount","matchCount","ceil","runNotebookJob","notebookId","method","Content-Type","errorText","stopNotebookJob","lastExecuteTime","unixtime","unix","fromNow","filterContext","jobItems","filterItems","jobItem","where","lowerFilterValue","toLocaleLowerCase","lowerNotebookName","match","sortBy","sortItem","reverse","InterpreterCtrl","interpreterSettingsTmp","availableInterpreters","showAddNewSetting","showRepositoryInfo","searchInterpreter","showInterpreterAuth","getSelectJson","multiple","intpName","getInterpreterSettings","checkDownloadingDependencies","isDownloading","errorReason","originalPath","getAvailableInterpreters","emptyNewProperty","extend","propertyValue","propertyKey","emptyNewDependency","depArtifact","depExclude","removeTMPSettings","copyOriginInterpreterSettingProperties","settingId","setPerNoteOption","sessionOption","option","newInterpreterSetting","perNote","session","process","setPerUserOption","perUser","getPerNoteOption","getPerUserOption","getInterpreterRunningOption","sharedModeName","globallyModeName","perNoteModeName","perUserModeName","setInterpreterRunningOption","isPerNoteMode","isPerUserMode","updateInterpreterSetting","form","addNewInterpreterProperty","addNewInterpreterDependency","isExistingProcess","setPermission","isUserImpersonate","remote","request","properties","dependencies","$show","resetInterpreterSetting","removeInterpreterSetting","delete","newInterpreterGroupChange","el","intpInfo","defaultValue","description","restartInterpreterSetting","errorMsg","addNewInterpreterSetting","newSetting","newProperties","post","resetNewInterpreterSetting","cancelInterpreterSetting","removeInterpreterProperty","removeInterpreterDependency","artifact","groupArtifactVersion","exclusions","dep","resetNewRepositorySetting","newRepoSetting","snapshot","username","password","proxyProtocol","proxyHost","proxyPort","proxyLogin","proxyPassword","getRepositories","repositories","addNewRepository","removeRepository","repoId","isDefaultRepository","showErrorMessage","showSparkUI","open","sortByKey","sortedKeys","CredentialCtrl","credentialInfo","showAddNewCredentialInfo","getCredentialInfo","userCredentials","entity","addNewCredentialInfo","newCredential","resetCredentialInfo","autocomplete","source","toggleAddNewCredentialInfo","cancelCredentialInfo","copyOriginCredentialsInfo","updateCredentialInfo","removeCredentialInfo","ConfigurationCtrl","configrations","getConfigurations","configurations","ParagraphCtrl","$compile","ANGULAR_FUNCTION_OBJECT_NAME_PREFIX","parentNote","originalText","editor","editorSetting","pastePercentSign","setInterpreterBindings","paragraphScope","$new","compiledScope","z","runParagraph","filtered","angularBind","varName","clientBindAngularObject","angularUnbind","clientUnbindAngularObject","angularObjectRegistry","newParagraph","baseMapOption","colWidthOption","paragraphFocused","initializeDefault","forms","colWidth","enabled","runOnSelectionChange","editOnDblClick","isOutputHidden","getIframeDimensions","paragraphid","newValue","oldValue","$$absUrl","postMessage","toJson","getEditor","setReadOnly","isRunning","cancelParagraph","cancelParagraphRun","dirtyText","closeEditorAndOpenTable","openEditorAndOpenTable","commitParagraph","toggleEnableDisable","editorValue","turnOnAutoRun","moveUp","$emit","moveDown","insertNew","copyPara","getEditorValue","copyParagraph","removeParagraph","clearParagraphOutput","toggleEditor","openEditor","closeEditor","closeTable","openTable","openEditorAndCloseTable","manageEditorAndTableState","hideEditor","hideTable","showTitle","hideTitle","setTitle","showLineNumbers","lineNumbers","setShowGutter","hideLineNumbers","columnWidthClass","changeColWidth","removeClass","toggleOutput","loadForm","formulaire","toggleCheckbox","aceChanged","getSession","getValue","setParagraphMode","getCursorPosition","aceLoaded","_editor","langTools","ace","require","Range","$blockScrolling","Infinity","setShowFoldWidgets","setHighlightActiveLine","setHighlightGutterLine","setUseWrapMode","setTheme","goToEnd","autoAdjustEditorHeight","resize","navigator","appVersion","setKeyboardHandler","isMac","remoteCompleter","getCompletions","pos","isFocused","getTextRange","column","buf","completion","completions","score","setCompleters","keyWordCompleter","snippetCompleter","textCompleter","setOptions","enableBasicAutocompletion","enableSnippets","enableLiveAutocompletion","handleFocus","editSession","commands","bindKey","removeCommand","keyBindingEditorFocusAction","scrollValue","numRows","getLength","currentRow","scrollToCursor","keyBinding","origOnCommandKey","onCommandKey","hashId","keyCode","completer","activated","cursorPos","$cursorLayer","getPixelPosition","ROW_UP","ROW_DOWN","ctrlKey","altKey","isDigestPass","$digest","getEditorSetting","interpreterName","deferred","defer","promise","setEditorLanguage","language","mode","editorMode","setMode","paragraphText","magic","getInterpreterName","merge","intpNameRegexp","$parent","getScreenLength","lineHeight","scrollBar","getWidth","toString","lastCursorMove","scrollTargetPos","headerHeight","scrollTriggerEdgeMargin","documentHeight","windowHeight","scrollPosition","scrollTop","editorPosition","lastCursorPosition","calculatedCursorPosition","bodyEl","stop","finish","axis","interrupt","currentProgress","getExecutionTime","pdata","timeMs","Date","parse","dateFinished","dateStarted","isResultOutdated","user","getElapsedTime","dateUpdated","navigateFileEnd","getResultType","parseTableCell","cell","goToSingleParagraph","pathParams","redirectToUrl","protocol","host","pathname","showScrollDownIcon","doc","scrollHeight","innerHeight","scrollParagraphDown","keepScrollDown","showScrollUpIcon","scrollParagraphUp","registry","angularObject","interpreterGroupId","skipEmit","clearWatcher","updateAngularObject","funcName","dateCreated","jobName","errorMessage","statusChanged","resultRefreshed","newResult","oldResult","newConfig","oldConfig","aborted","progress","noShortcutDefined","shiftKey","mouseEvent","gotoLine","blur","ResultCtrl","$templateRequest","$sce","builtInTableDataVisualizationList","icon","transformation","builtInVisualizations","table","class","pieChart","stackedAreaChart","lineChart","scatterChart","resultIndex","enableHelium","graphMode","imageData","heliumVis","vis","trustAsHtml","updateData","renderResult","paragraphRef","appendTextOutput","clearTextOutput","graph","optionOpen","_tabledata2","loadParagraphResult","tableDataComment","activeApp","getSuggestions","getApplicationStates","app","apps","renderApp","retryRenderer","elem","renderGraph","renderHtml","renderAngular","renderText","htmlEl","hljs","highlightBlock","MathJax","Hub","Queue","err","getTextEl","textRendererInitialized","textEl","flushAppendQueue","textAppendQueueBeforeInitialize","pop","lines","graphContainerEl","builtInViz","deactivate","transformationSettingTargetEl","visualizationSettingTargetEl","getVizConfig","getTransformation","transformed","transform","renderSetting","activate","emitter","graphSetting","commitVizConfigChange","createNewScope","switchViz","newMode","newParams","set","commitParagraphResult","newParagraphConfig","toggleGraphSetting","vizId","commonSetting","changeHeight","exportToDSV","delimiter","dsv","exportedFileName","titleIndex","dsvRow","stringValue","extension","getBase64ImageSrc","base64Data","suggestion","switchApp","appId","commitConfig","loadApp","heliumPackage","appStates","pkg","output","currentAppState","newAppState","appState","getAppScope","paragraphAppState","getAppRegistry","_tabledata","_visualizationTable","_visualizationTable2","_visualizationBarchart","_visualizationBarchart2","_visualizationPiechart","_visualizationPiechart2","_visualizationAreachart","_visualizationAreachart2","_visualizationLinechart","_visualizationLinechart2","_visualizationScatterchart","_visualizationScatterchart2","SearchResultCtrl","searchService","isResult","searchTerm","search","$promise","page","allResults","highlightSearchResults","getEditorMode","editorModes","ace/mode/scala","ace/mode/python","ace/mode/r","ace/mode/sql","ace/mode/markdown","ace/mode/sh","reduce","res","getIndeces","str","indeces","setOption","header","snippet","line","__line","start","end","addMarker","setValue","NotebookReposCtrl","saveNotebookRepo","valueform","repo","notebookRepos","showDropdownSelected","_getInterpreterSettings","_init","HeliumCtrl","packageInfos","defaultVersions","showVersions","visualizationOrder","visualizationOrderChanged","buildDefaultVersionListToDisplay","pkgs","pkgIdx","getAllPackageInfo","getVisualizationOrder","visualizationOrderListeners","saveVisualizationOrder","setVisualizationOrder","getLicense","license","enable","disable","toggleVersions","pkgName","noteListOrdering","service","clipboardCtrl","complete","copied","clipError","NavCtrl","getZeppelinVersion","initController","isDrawNavbarNoteList","perfectScrollbar","suppressScrollX","loadNotes","listConfigurations","getNoteList","logout","logoutURL","userName","showLoginWindow","initNotebookListEventListener","connected","isConnected","searchForm","setNotes","ngEscape","attrs","$eval","directive","interpreterDirective","restrict","link","$last","expandCollapse","slideUp","toggleClass","first","slideToggle","stopPropagation","NotenameCtrl","clone","defaultInterpreter","createNote","notename","defaultInterpreterId","createNotebook","handleNameEnter","preVisible","sourceNoteName","cloneNoteName","newNoteName","newCount","flatList","lastCount","copyCount","newCloneName","lastIndex","endsWithNumber","noteNamePrefix","regexp","lastCopyCount","NoteImportCtrl","step1","step2","maxLimit","limit","resetFlags","uploadFile","importFile","files","file","reader","FileReader","onloadend","processImportJson","readAsText","uploadURL","importBack","importNote","importUrl","jsonp","xhr","ajaxOptions","thrownError","done","_typeof","noteImportName","Symbol","iterator","popoverHtmlUnsafe","$tooltip","popoverHtmlUnsafePopup","placement","animation","isOpen","codeEditor","onLoad","editorHtml","ngEnter","dropdownInput","resizable","resizableConfig","autoHide","handles","helper","$observe","resetResize","colStep","innerWidth","conf","graphType","grid","minHeight","maxWidth","allowresize","modalvisible","preVisibleCallback","postVisibleCallback","targetinput","previsibleMethod","postVisibleMethod","relatedTarget","websocketEvents","sendNewEvent","op","deleteNote","noteIdToClone","noteConfig","modeValue","personalized","folderName","paragraphTitle","paragraphData","paragraphConfig","paragraphParams","cursor","replName","getUpdateNoteJobsList","lastUpdateServerUnixTime","lastUpdateUnixTime","$websocket","pingIntervalId","websocketCalls","ws","getWebsocketUrl","reconnectIfNotNormalClose","onOpen","setInterval","send","socket","readyState","onMessage","noteJobs","noteRunningJobs","btn","closeAll","onError","onClose","clearInterval","root","flatFolderMap","notesList","nodes","addNode","curDir","shift","dir","newDir","getPort","port","wsProtocol","hostname","skipTrailingSlash","browserDetectService","detectIE","ua","userAgent","msie","trident","rv","edge","filename","BOM","frameSaveAs","contentWindow","write","t1","now","execCommand","t2","encodeURIComponent","saveAsElement","$resource","encQuery","LoginCtrl","$httpParamSerializer","SigningIn","loginParams","login","redirectLocation","$$search","initValues","locationPath","ElasticInputCtrl","showEditor","renameSrv","normalizeFolderId","redirectToHome","TYPE_WARNING","notePath","openRenameModal","oldName","newFolderId","has","store","del","RenameCtrl","defaultValidator","rename","validate","visualizations","eval"],"mappings":"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","file":"app.997e38abb8f8bc084cb1.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(1);\n\t\n\t__webpack_require__(2);\n\t\n\t__webpack_require__(3);\n\t\n\t__webpack_require__(4);\n\t\n\t__webpack_require__(5);\n\t\n\t__webpack_require__(6);\n\t\n\t__webpack_require__(7);\n\t\n\t__webpack_require__(8);\n\t\n\t__webpack_require__(9);\n\t\n\t__webpack_require__(10);\n\t\n\t__webpack_require__(11);\n\t\n\t__webpack_require__(12);\n\t\n\t__webpack_require__(13);\n\t\n\t__webpack_require__(14);\n\t\n\t__webpack_require__(15);\n\t\n\t__webpack_require__(16);\n\t\n\t__webpack_require__(17);\n\t\n\t__webpack_require__(18);\n\t\n\t__webpack_require__(19);\n\t\n\t__webpack_require__(20);\n\t\n\t__webpack_require__(21);\n\t\n\t__webpack_require__(22);\n\t\n\t__webpack_require__(23);\n\t\n\t__webpack_require__(24);\n\t\n\t__webpack_require__(25);\n\t\n\t__webpack_require__(26);\n\t\n\t__webpack_require__(27);\n\t\n\t__webpack_require__(28);\n\t\n\t__webpack_require__(29);\n\t\n\t__webpack_require__(30);\n\t\n\t__webpack_require__(31);\n\t\n\t__webpack_require__(32);\n\t\n\t__webpack_require__(33);\n\t\n\t__webpack_require__(34);\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(36);\n\t\n\t__webpack_require__(37);\n\t\n\t__webpack_require__(38);\n\t\n\t__webpack_require__(39);\n\t\n\t__webpack_require__(40);\n\t\n\t__webpack_require__(41);\n\t\n\t__webpack_require__(42);\n\t\n\t__webpack_require__(43);\n\t\n\t__webpack_require__(44);\n\t\n\t__webpack_require__(45);\n\t\n\t__webpack_require__(46);\n\t\n\t__webpack_require__(47);\n\t\n\t__webpack_require__(48);\n\t\n\t__webpack_require__(49);\n\t\n\t__webpack_require__(50);\n\t\n\t__webpack_require__(51);\n\t\n\t__webpack_require__(52);\n\t\n\t__webpack_require__(53);\n\t\n\t__webpack_require__(54);\n\t\n\t__webpack_require__(55);\n\t\n\t__webpack_require__(56);\n\t\n\t__webpack_require__(57);\n\t\n\t__webpack_require__(58);\n\t\n\t__webpack_require__(59);\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed to the Apache Software Foundation (ASF) under one or more\n\t * contributor license agreements.  See the NOTICE file distributed with\n\t * this work for additional information regarding copyright ownership.\n\t * The ASF licenses this file to You under the Apache License, Version 2.0\n\t * (the \"License\"); you may not use this file except in compliance with\n\t * the License.  You may obtain a copy of the License at\n\t *\n\t *    http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tvar zeppelinWebApp = angular.module('zeppelinWebApp', ['ngCookies', 'ngAnimate', 'ngRoute', 'ngSanitize', 'angular-websocket', 'ui.ace', 'ui.bootstrap', 'as.sortable', 'ngTouch', 'ngDragDrop', 'angular.filter', 'monospaced.elastic', 'puElasticInput', 'xeditable', 'ngToast', 'focus-if', 'ngResource', 'ngclipboard']).filter('breakFilter', function () {\n\t  return function (text) {\n\t    if (!!text) {\n\t      return text.replace(/\\n/g, '<br />');\n\t    }\n\t  };\n\t}).config([\"$httpProvider\", \"$routeProvider\", \"ngToastProvider\", function ($httpProvider, $routeProvider, ngToastProvider) {\n\t  // withCredentials when running locally via grunt\n\t  $httpProvider.defaults.withCredentials = true;\n\t\n\t  var visBundleLoad = {\n\t    load: ['heliumService', function (heliumService) {\n\t      return heliumService.load;\n\t    }]\n\t  };\n\t\n\t  $routeProvider.when('/', {\n\t    templateUrl: 'app/home/home.html'\n\t  }).when('/notebook/:noteId', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/notebook/:noteId/paragraph?=:paragraphId', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/notebook/:noteId/paragraph/:paragraphId?', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/notebook/:noteId/revision/:revisionId', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/jobmanager', {\n\t    templateUrl: 'app/jobmanager/jobmanager.html',\n\t    controller: 'JobmanagerCtrl'\n\t  }).when('/interpreter', {\n\t    templateUrl: 'app/interpreter/interpreter.html',\n\t    controller: 'InterpreterCtrl'\n\t  }).when('/notebookRepos', {\n\t    templateUrl: 'app/notebookRepos/notebookRepos.html',\n\t    controller: 'NotebookReposCtrl',\n\t    controllerAs: 'noterepo'\n\t  }).when('/credential', {\n\t    templateUrl: 'app/credential/credential.html',\n\t    controller: 'CredentialCtrl'\n\t  }).when('/helium', {\n\t    templateUrl: 'app/helium/helium.html',\n\t    controller: 'HeliumCtrl'\n\t  }).when('/configuration', {\n\t    templateUrl: 'app/configuration/configuration.html',\n\t    controller: 'ConfigurationCtrl'\n\t  }).when('/search/:searchTerm', {\n\t    templateUrl: 'app/search/result-list.html',\n\t    controller: 'SearchResultCtrl'\n\t  }).otherwise({\n\t    redirectTo: '/'\n\t  });\n\t\n\t  ngToastProvider.configure({\n\t    dismissButton: true,\n\t    dismissOnClick: false,\n\t    combineDuplications: true,\n\t    timeout: 6000\n\t  });\n\t}])\n\t\n\t//handel logout on API failure\n\t.config([\"$httpProvider\", \"$provide\", function ($httpProvider, $provide) {\n\t  $provide.factory('httpInterceptor', [\"$q\", \"$rootScope\", function ($q, $rootScope) {\n\t    return {\n\t      'responseError': function responseError(rejection) {\n\t        if (rejection.status === 405) {\n\t          var data = {};\n\t          data.info = '';\n\t          $rootScope.$broadcast('session_logout', data);\n\t        }\n\t        $rootScope.$broadcast('httpResponseError', rejection);\n\t        return $q.reject(rejection);\n\t      }\n\t    };\n\t  }]);\n\t  $httpProvider.interceptors.push('httpInterceptor');\n\t}]).constant('TRASH_FOLDER_ID', '~Trash');\n\t\n\tfunction auth() {\n\t  var $http = angular.injector(['ng']).get('$http');\n\t  var baseUrlSrv = angular.injector(['zeppelinWebApp']).get('baseUrlSrv');\n\t  // withCredentials when running locally via grunt\n\t  $http.defaults.withCredentials = true;\n\t  jQuery.ajaxSetup({\n\t    dataType: 'json',\n\t    xhrFields: {\n\t      withCredentials: true\n\t    },\n\t    crossDomain: true\n\t  });\n\t  return $http.get(baseUrlSrv.getRestApiBase() + '/security/ticket').then(function (response) {\n\t    zeppelinWebApp.run([\"$rootScope\", function ($rootScope) {\n\t      $rootScope.ticket = angular.fromJson(response.data).body;\n\t    }]);\n\t  }, function (errorResponse) {\n\t    // Handle error case\n\t  });\n\t}\n\t\n\tfunction bootstrapApplication() {\n\t  zeppelinWebApp.run([\"$rootScope\", \"$location\", function ($rootScope, $location) {\n\t    $rootScope.$on('$routeChangeStart', function (event, next, current) {\n\t      if (!$rootScope.ticket && next.$$route && !next.$$route.publicAccess) {\n\t        $location.path('/');\n\t      }\n\t    });\n\t  }]);\n\t  angular.bootstrap(document, ['zeppelinWebApp']);\n\t}\n\t\n\tangular.element(document).ready(function () {\n\t  auth().then(bootstrapApplication);\n\t});\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('MainCtrl', MainCtrl);\n\t\n\tMainCtrl.$inject = ['$scope', '$rootScope', '$window', 'arrayOrderingSrv'];\n\t\n\tfunction MainCtrl($scope, $rootScope, $window, arrayOrderingSrv) {\n\t  $scope.looknfeel = 'default';\n\t\n\t  var init = function init() {\n\t    $scope.asIframe = $window.location.href.indexOf('asIframe') > -1 ? true : false;\n\t  };\n\t\n\t  init();\n\t\n\t  $rootScope.$on('setIframe', function (event, data) {\n\t    if (!event.defaultPrevented) {\n\t      $scope.asIframe = data;\n\t      event.preventDefault();\n\t    }\n\t  });\n\t\n\t  $rootScope.$on('setLookAndFeel', function (event, data) {\n\t    if (!event.defaultPrevented && data && data !== '' && data !== $scope.looknfeel) {\n\t      $scope.looknfeel = data;\n\t      event.preventDefault();\n\t    }\n\t  });\n\t\n\t  // Set The lookAndFeel to default on every page\n\t  $rootScope.$on('$routeChangeStart', function (event, next, current) {\n\t    $rootScope.$broadcast('setLookAndFeel', 'default');\n\t  });\n\t\n\t  $rootScope.noteName = function (note) {\n\t    if (!_.isEmpty(note)) {\n\t      return arrayOrderingSrv.getNoteName(note);\n\t    }\n\t  };\n\t\n\t  BootstrapDialog.defaultOptions.onshown = function () {\n\t    angular.element('#' + this.id).find('.btn:last').focus();\n\t  };\n\t\n\t  // Remove BootstrapDialog animation\n\t  BootstrapDialog.configDefaultOptions({ animate: false });\n\t}\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('HomeCtrl', HomeCtrl);\n\t\n\tHomeCtrl.$inject = ['$scope', 'noteListDataFactory', 'websocketMsgSrv', '$rootScope', 'arrayOrderingSrv', 'ngToast', 'noteActionSrv', 'TRASH_FOLDER_ID'];\n\t\n\tfunction HomeCtrl($scope, noteListDataFactory, websocketMsgSrv, $rootScope, arrayOrderingSrv, ngToast, noteActionSrv, TRASH_FOLDER_ID) {\n\t  ngToast.dismiss();\n\t  var vm = this;\n\t  vm.notes = noteListDataFactory;\n\t  vm.websocketMsgSrv = websocketMsgSrv;\n\t  vm.arrayOrderingSrv = arrayOrderingSrv;\n\t\n\t  vm.notebookHome = false;\n\t  vm.noteCustomHome = true;\n\t  if ($rootScope.ticket !== undefined) {\n\t    vm.staticHome = false;\n\t  } else {\n\t    vm.staticHome = true;\n\t  }\n\t\n\t  $scope.isReloading = false;\n\t  $scope.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n\t  $scope.query = { q: '' };\n\t\n\t  $scope.initHome = function () {\n\t    websocketMsgSrv.getHomeNote();\n\t    vm.noteCustomHome = false;\n\t  };\n\t\n\t  $scope.reloadNoteList = function () {\n\t    websocketMsgSrv.reloadAllNotesFromRepo();\n\t    $scope.isReloadingNotes = true;\n\t  };\n\t\n\t  $scope.toggleFolderNode = function (node) {\n\t    node.hidden = !node.hidden;\n\t  };\n\t\n\t  angular.element('#loginModal').on('hidden.bs.modal', function (e) {\n\t    $rootScope.$broadcast('initLoginValues');\n\t  });\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteMenu', function (event, notes) {\n\t    $scope.isReloadingNotes = false;\n\t  });\n\t\n\t  $scope.$on('setNoteContent', function (event, note) {\n\t    if (vm.noteCustomHome) {\n\t      return;\n\t    }\n\t\n\t    if (note) {\n\t      vm.note = note;\n\t\n\t      // initialize look And Feel\n\t      $rootScope.$broadcast('setLookAndFeel', 'home');\n\t\n\t      // make it read only\n\t      vm.viewOnly = true;\n\t\n\t      vm.notebookHome = true;\n\t      vm.staticHome = false;\n\t    } else {\n\t      vm.staticHome = true;\n\t      vm.notebookHome = false;\n\t    }\n\t  });\n\t\n\t  $scope.renameNote = function (nodeId, nodePath) {\n\t    noteActionSrv.renameNote(nodeId, nodePath);\n\t  };\n\t\n\t  $scope.moveNoteToTrash = function (noteId) {\n\t    noteActionSrv.moveNoteToTrash(noteId, false);\n\t  };\n\t\n\t  $scope.moveFolderToTrash = function (folderId) {\n\t    noteActionSrv.moveFolderToTrash(folderId);\n\t  };\n\t\n\t  $scope.restoreNote = function (noteId) {\n\t    websocketMsgSrv.restoreNote(noteId);\n\t  };\n\t\n\t  $scope.restoreFolder = function (folderId) {\n\t    websocketMsgSrv.restoreFolder(folderId);\n\t  };\n\t\n\t  $scope.restoreAll = function () {\n\t    noteActionSrv.restoreAll();\n\t  };\n\t\n\t  $scope.renameFolder = function (node) {\n\t    noteActionSrv.renameFolder(node.id);\n\t  };\n\t\n\t  $scope.removeNote = function (noteId) {\n\t    noteActionSrv.removeNote(noteId, false);\n\t  };\n\t\n\t  $scope.removeFolder = function (folderId) {\n\t    noteActionSrv.removeFolder(folderId);\n\t  };\n\t\n\t  $scope.emptyTrash = function () {\n\t    noteActionSrv.emptyTrash();\n\t  };\n\t\n\t  $scope.clearAllParagraphOutput = function (noteId) {\n\t    noteActionSrv.clearAllParagraphOutput(noteId);\n\t  };\n\t\n\t  $scope.isFilterNote = function (note) {\n\t    if (!$scope.query.q) {\n\t      return true;\n\t    }\n\t\n\t    var noteName = note.name;\n\t    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n\t      return true;\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.getNoteName = function (note) {\n\t    return arrayOrderingSrv.getNoteName(note);\n\t  };\n\t}\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * HandsonHelper class\n\t */\n\tvar HandsonHelper = function () {\n\t  function HandsonHelper(columns, rows, comment) {\n\t    _classCallCheck(this, HandsonHelper);\n\t\n\t    this.columns = columns || [];\n\t    this.rows = rows || [];\n\t    this.comment = comment || '';\n\t    this._numericValidator = this._numericValidator.bind(this);\n\t  }\n\t\n\t  _createClass(HandsonHelper, [{\n\t    key: 'getHandsonTableConfig',\n\t    value: function getHandsonTableConfig(columns, columnNames, resultRows) {\n\t      var self = this;\n\t      return {\n\t        colHeaders: columnNames,\n\t        data: resultRows,\n\t        rowHeaders: false,\n\t        stretchH: 'all',\n\t        sortIndicator: true,\n\t        columns: columns,\n\t        columnSorting: true,\n\t        contextMenu: false,\n\t        manualColumnResize: true,\n\t        manualRowResize: true,\n\t        readOnly: true,\n\t        readOnlyCellClassName: '',\n\t        fillHandle: false,\n\t        fragmentSelection: true,\n\t        disableVisualSelection: true,\n\t        cells: function cells(ro, co, pro) {\n\t          var cellProperties = {};\n\t          var colType = columns[co].type;\n\t          cellProperties.renderer = function (instance, td, row, col, prop, value, cellProperties) {\n\t            self._cellRenderer(instance, td, row, col, prop, value, cellProperties, colType);\n\t          };\n\t          return cellProperties;\n\t        },\n\t        afterGetColHeader: function afterGetColHeader(col, TH) {\n\t          var instance = this;\n\t          var menu = self._buildDropDownMenu(columns[col].type);\n\t          var button = self._buildTypeSwitchButton();\n\t\n\t          self._addButtonMenuEvent(button, menu);\n\t\n\t          Handsontable.Dom.addEvent(menu, 'click', function (event) {\n\t            if (event.target.nodeName === 'LI') {\n\t              self._setColumnType(columns, event.target.data.colType, instance, col);\n\t            }\n\t          });\n\t          if (TH.firstChild.lastChild.nodeName === 'BUTTON') {\n\t            TH.firstChild.removeChild(TH.firstChild.lastChild);\n\t          }\n\t          TH.firstChild.appendChild(button);\n\t          TH.style['white-space'] = 'normal';\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: '_addButtonMenuEvent',\n\t\n\t\n\t    /*\n\t    ** Private Service Functions\n\t    */\n\t\n\t    value: function _addButtonMenuEvent(button, menu) {\n\t      Handsontable.Dom.addEvent(button, 'click', function (event) {\n\t        var changeTypeMenu;\n\t        var position;\n\t        var removeMenu;\n\t\n\t        document.body.appendChild(menu);\n\t\n\t        event.preventDefault();\n\t        event.stopImmediatePropagation();\n\t\n\t        changeTypeMenu = document.querySelectorAll('.changeTypeMenu');\n\t\n\t        for (var i = 0, len = changeTypeMenu.length; i < len; i++) {\n\t          changeTypeMenu[i].style.display = 'none';\n\t        }\n\t        menu.style.display = 'block';\n\t        position = button.getBoundingClientRect();\n\t\n\t        menu.style.top = position.top + (window.scrollY || window.pageYOffset) + 2 + 'px';\n\t        menu.style.left = position.left + 'px';\n\t\n\t        removeMenu = function removeMenu(event) {\n\t          if (menu.parentNode) {\n\t            menu.parentNode.removeChild(menu);\n\t          }\n\t        };\n\t        Handsontable.Dom.removeEvent(document, 'click', removeMenu);\n\t        Handsontable.Dom.addEvent(document, 'click', removeMenu);\n\t      });\n\t    }\n\t  }, {\n\t    key: '_buildDropDownMenu',\n\t    value: function _buildDropDownMenu(activeCellType) {\n\t      var menu = document.createElement('UL');\n\t      var types = ['text', 'numeric', 'date'];\n\t      var item;\n\t\n\t      menu.className = 'changeTypeMenu';\n\t\n\t      for (var i = 0, len = types.length; i < len; i++) {\n\t        item = document.createElement('LI');\n\t        if ('innerText' in item) {\n\t          item.innerText = types[i];\n\t        } else {\n\t          item.textContent = types[i];\n\t        }\n\t\n\t        item.data = { 'colType': types[i] };\n\t\n\t        if (activeCellType === types[i]) {\n\t          item.className = 'active';\n\t        }\n\t        menu.appendChild(item);\n\t      }\n\t\n\t      return menu;\n\t    }\n\t  }, {\n\t    key: '_buildTypeSwitchButton',\n\t    value: function _buildTypeSwitchButton() {\n\t      var button = document.createElement('BUTTON');\n\t\n\t      button.innerHTML = '\\u25BC';\n\t      button.className = 'changeType';\n\t\n\t      return button;\n\t    }\n\t  }, {\n\t    key: '_isNumeric',\n\t    value: function _isNumeric(value) {\n\t      if (!isNaN(value)) {\n\t        if (value.length !== 0) {\n\t          if (Number(value) <= Number.MAX_SAFE_INTEGER && Number(value) >= Number.MIN_SAFE_INTEGER) {\n\t            return true;\n\t          }\n\t        }\n\t      }\n\t      return false;\n\t    }\n\t  }, {\n\t    key: '_cellRenderer',\n\t    value: function _cellRenderer(instance, td, row, col, prop, value, cellProperties, colType) {\n\t      if (colType === 'numeric' && this._isNumeric(value)) {\n\t        cellProperties.format = '0,0.[00000]';\n\t        td.style.textAlign = 'left';\n\t        Handsontable.renderers.NumericRenderer.apply(this, arguments);\n\t      } else if (value.length > '%html'.length && '%html ' === value.substring(0, '%html '.length)) {\n\t        td.innerHTML = value.substring('%html'.length);\n\t      } else {\n\t        Handsontable.renderers.TextRenderer.apply(this, arguments);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_dateValidator',\n\t    value: function _dateValidator(value, callback) {\n\t      var d = moment(value);\n\t      return callback(d.isValid());\n\t    }\n\t  }, {\n\t    key: '_numericValidator',\n\t    value: function _numericValidator(value, callback) {\n\t      return callback(this._isNumeric(value));\n\t    }\n\t  }, {\n\t    key: '_setColumnType',\n\t    value: function _setColumnType(columns, type, instance, col) {\n\t      columns[col].type = type;\n\t      this._setColumnValidator(columns, col);\n\t      instance.updateSettings({ columns: columns });\n\t      instance.validateCells(null);\n\t      if (this._isColumnSorted(instance, col)) {\n\t        instance.sort(col, instance.sortOrder);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_isColumnSorted',\n\t    value: function _isColumnSorted(instance, col) {\n\t      return instance.sortingEnabled && instance.sortColumn === col;\n\t    }\n\t  }, {\n\t    key: '_setColumnValidator',\n\t    value: function _setColumnValidator(columns, col) {\n\t      if (columns[col].type === 'numeric') {\n\t        columns[col].validator = this._numericValidator;\n\t      } else if (columns[col].type === 'date') {\n\t        columns[col].validator = this._dateValidator;\n\t      } else {\n\t        columns[col].validator = null;\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return HandsonHelper;\n\t}();\n\t\n\texports.default = HandsonHelper;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NotebookCtrl', NotebookCtrl);\n\t\n\tNotebookCtrl.$inject = ['$scope', '$route', '$routeParams', '$location', '$rootScope', '$http', 'websocketMsgSrv', 'baseUrlSrv', '$timeout', 'saveAsService', 'ngToast', 'noteActionSrv', 'noteVarShareService', 'TRASH_FOLDER_ID'];\n\t\n\tfunction NotebookCtrl($scope, $route, $routeParams, $location, $rootScope, $http, websocketMsgSrv, baseUrlSrv, $timeout, saveAsService, ngToast, noteActionSrv, noteVarShareService, TRASH_FOLDER_ID) {\n\t\n\t  ngToast.dismiss();\n\t\n\t  $scope.note = null;\n\t  $scope.moment = moment;\n\t  $scope.editorToggled = false;\n\t  $scope.tableToggled = false;\n\t  $scope.viewOnly = false;\n\t  $scope.showSetting = false;\n\t  $scope.looknfeelOption = ['default', 'simple', 'report'];\n\t  $scope.cronOption = [{ name: 'None', value: undefined }, { name: '1m', value: '0 0/1 * * * ?' }, { name: '5m', value: '0 0/5 * * * ?' }, { name: '1h', value: '0 0 0/1 * * ?' }, { name: '3h', value: '0 0 0/3 * * ?' }, { name: '6h', value: '0 0 0/6 * * ?' }, { name: '12h', value: '0 0 0/12 * * ?' }, { name: '1d', value: '0 0 0 * * ?' }];\n\t\n\t  $scope.interpreterSettings = [];\n\t  $scope.interpreterBindings = [];\n\t  $scope.isNoteDirty = null;\n\t  $scope.saveTimer = null;\n\t\n\t  var connectedOnce = false;\n\t  var isRevisionPath = function isRevisionPath(path) {\n\t    var pattern = new RegExp('^.*\\/notebook\\/[a-zA-Z0-9_]*\\/revision\\/[a-zA-Z0-9_]*');\n\t    return pattern.test(path);\n\t  };\n\t\n\t  $scope.noteRevisions = [];\n\t  $scope.currentRevision = 'Head';\n\t  $scope.revisionView = isRevisionPath($location.path());\n\t\n\t  $scope.$on('setConnectedStatus', function (event, param) {\n\t    if (connectedOnce && param) {\n\t      initNotebook();\n\t    }\n\t    connectedOnce = true;\n\t  });\n\t\n\t  $scope.getCronOptionNameFromValue = function (value) {\n\t    if (!value) {\n\t      return '';\n\t    }\n\t\n\t    for (var o in $scope.cronOption) {\n\t      if ($scope.cronOption[o].value === value) {\n\t        return $scope.cronOption[o].name;\n\t      }\n\t    }\n\t    return value;\n\t  };\n\t\n\t  $scope.blockAnonUsers = function () {\n\t    var zeppelinVersion = $rootScope.zeppelinVersion;\n\t    var url = 'https://zeppelin.apache.org/docs/' + zeppelinVersion + '/security/notebook_authorization.html';\n\t    var content = 'Only authenticated user can set the permission.' + '<a data-toggle=\"tooltip\" data-placement=\"top\" title=\"Learn more\" target=\"_blank\" href=' + url + '>' + '<i class=\"icon-question\" />' + '</a>';\n\t    BootstrapDialog.show({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: 'No permission',\n\t      message: content,\n\t      buttons: [{\n\t        label: 'Close',\n\t        action: function action(dialog) {\n\t          dialog.close();\n\t        }\n\t      }]\n\t    });\n\t  };\n\t\n\t  /** Init the new controller */\n\t  var initNotebook = function initNotebook() {\n\t    noteVarShareService.clear();\n\t    if ($routeParams.revisionId) {\n\t      websocketMsgSrv.getNoteByRevision($routeParams.noteId, $routeParams.revisionId);\n\t    } else {\n\t      websocketMsgSrv.getNote($routeParams.noteId);\n\t    }\n\t    websocketMsgSrv.listRevisionHistory($routeParams.noteId);\n\t    var currentRoute = $route.current;\n\t    if (currentRoute) {\n\t      setTimeout(function () {\n\t        var routeParams = currentRoute.params;\n\t        var $id = angular.element('#' + routeParams.paragraph + '_container');\n\t\n\t        if ($id.length > 0) {\n\t          // adjust for navbar\n\t          var top = $id.offset().top - 103;\n\t          angular.element('html, body').scrollTo({ top: top, left: 0 });\n\t        }\n\t      }, 1000);\n\t    }\n\t  };\n\t\n\t  initNotebook();\n\t\n\t  // force notebook reload on user change\n\t  $scope.$on('setNoteMenu', function (event, note) {\n\t    initNotebook();\n\t  });\n\t\n\t  $scope.focusParagraphOnClick = function (clickEvent) {\n\t    if (!$scope.note) {\n\t      return;\n\t    }\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      var paragraphId = $scope.note.paragraphs[i].id;\n\t      if (jQuery.contains(angular.element('#' + paragraphId + '_container')[0], clickEvent.target)) {\n\t        $scope.$broadcast('focusParagraph', paragraphId, 0, true);\n\t        break;\n\t      }\n\t    }\n\t  };\n\t\n\t  // register mouseevent handler for focus paragraph\n\t  document.addEventListener('click', $scope.focusParagraphOnClick);\n\t\n\t  $scope.keyboardShortcut = function (keyEvent) {\n\t    // handle keyevent\n\t    if (!$scope.viewOnly && !$scope.revisionView) {\n\t      $scope.$broadcast('keyEvent', keyEvent);\n\t    }\n\t  };\n\t\n\t  // register mouseevent handler for focus paragraph\n\t  document.addEventListener('keydown', $scope.keyboardShortcut);\n\t\n\t  $scope.paragraphOnDoubleClick = function (paragraphId) {\n\t    $scope.$broadcast('doubleClickParagraph', paragraphId);\n\t  };\n\t\n\t  // Move the note to trash and go back to the main page\n\t  $scope.moveNoteToTrash = function (noteId) {\n\t    noteActionSrv.moveNoteToTrash(noteId, true);\n\t  };\n\t\n\t  // Remove the note permanently if it's in the trash\n\t  $scope.removeNote = function (noteId) {\n\t    noteActionSrv.removeNote(noteId, true);\n\t  };\n\t\n\t  $scope.isTrash = function (note) {\n\t    return note ? note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n\t  };\n\t\n\t  //Export notebook\n\t  $scope.exportNote = function () {\n\t    var jsonContent = JSON.stringify($scope.note);\n\t    saveAsService.saveAs(jsonContent, $scope.note.name, 'json');\n\t  };\n\t\n\t  //Clone note\n\t  $scope.cloneNote = function (noteId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to clone this note?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.cloneNote(noteId);\n\t          $location.path('/');\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  // checkpoint/commit notebook\n\t  $scope.checkpointNote = function (commitMessage) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Commit note to current repository?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.checkpointNote($routeParams.noteId, commitMessage);\n\t        }\n\t      }\n\t    });\n\t    document.getElementById('note.checkpoint.message').value = '';\n\t  };\n\t\n\t  // set notebook head to given revision\n\t  $scope.setNoteRevision = function () {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Set notebook head to current revision?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.setNoteRevision($routeParams.noteId, $routeParams.revisionId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.$on('listRevisionHistory', function (event, data) {\n\t    console.log('received list of revisions %o', data);\n\t    $scope.noteRevisions = data.revisionList;\n\t    $scope.noteRevisions.splice(0, 0, {\n\t      id: 'Head',\n\t      message: 'Head'\n\t    });\n\t    if ($routeParams.revisionId) {\n\t      var index = _.findIndex($scope.noteRevisions, { 'id': $routeParams.revisionId });\n\t      if (index > -1) {\n\t        $scope.currentRevision = $scope.noteRevisions[index].message;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('noteRevision', function (event, data) {\n\t    console.log('received note revision %o', data);\n\t    if (data.note) {\n\t      $scope.note = data.note;\n\t      initializeLookAndFeel();\n\t    } else {\n\t      $location.path('/');\n\t    }\n\t  });\n\t\n\t  $scope.$on('setNoteRevisionResult', function (event, data) {\n\t    console.log('received set note revision result %o', data);\n\t    if (data.status) {\n\t      $location.path('/notebook/' + $routeParams.noteId);\n\t    }\n\t  });\n\t\n\t  $scope.visitRevision = function (revision) {\n\t    if (revision.id) {\n\t      if (revision.id === 'Head') {\n\t        $location.path('/notebook/' + $routeParams.noteId);\n\t      } else {\n\t        $location.path('/notebook/' + $routeParams.noteId + '/revision/' + revision.id);\n\t      }\n\t    } else {\n\t      ngToast.danger({ content: 'There is a problem with this Revision',\n\t        verticalPosition: 'top', dismissOnTimeout: false });\n\t    }\n\t  };\n\t\n\t  $scope.runAllParagraphs = function (noteId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Run all paragraphs?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          var paragraphs = $scope.note.paragraphs.map(function (p) {\n\t            return {\n\t              id: p.id,\n\t              title: p.title,\n\t              paragraph: p.text,\n\t              config: p.config,\n\t              params: p.settings.params\n\t            };\n\t          });\n\t          websocketMsgSrv.runAllParagraphs(noteId, paragraphs);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.saveNote = function () {\n\t    if ($scope.note && $scope.note.paragraphs) {\n\t      _.forEach($scope.note.paragraphs, function (par) {\n\t        angular.element('#' + par.id + '_paragraphColumn_main').scope().saveParagraph(par);\n\t      });\n\t      $scope.isNoteDirty = null;\n\t    }\n\t  };\n\t\n\t  $scope.clearAllParagraphOutput = function (noteId) {\n\t    noteActionSrv.clearAllParagraphOutput(noteId);\n\t  };\n\t\n\t  $scope.toggleAllEditor = function () {\n\t    if ($scope.editorToggled) {\n\t      $scope.$broadcast('openEditor');\n\t    } else {\n\t      $scope.$broadcast('closeEditor');\n\t    }\n\t    $scope.editorToggled = !$scope.editorToggled;\n\t  };\n\t\n\t  $scope.showAllEditor = function () {\n\t    $scope.$broadcast('openEditor');\n\t  };\n\t\n\t  $scope.hideAllEditor = function () {\n\t    $scope.$broadcast('closeEditor');\n\t  };\n\t\n\t  $scope.toggleAllTable = function () {\n\t    if ($scope.tableToggled) {\n\t      $scope.$broadcast('openTable');\n\t    } else {\n\t      $scope.$broadcast('closeTable');\n\t    }\n\t    $scope.tableToggled = !$scope.tableToggled;\n\t  };\n\t\n\t  $scope.showAllTable = function () {\n\t    $scope.$broadcast('openTable');\n\t  };\n\t\n\t  $scope.hideAllTable = function () {\n\t    $scope.$broadcast('closeTable');\n\t  };\n\t\n\t  $scope.isNoteRunning = function () {\n\t    if (!$scope.note) {\n\t      return false;\n\t    }\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      var status = $scope.note.paragraphs[i].status;\n\t      if (status === 'PENDING' || status === 'RUNNING') {\n\t        return true;\n\t      }\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.killSaveTimer = function () {\n\t    if ($scope.saveTimer) {\n\t      $timeout.cancel($scope.saveTimer);\n\t      $scope.saveTimer = null;\n\t    }\n\t  };\n\t\n\t  $scope.startSaveTimer = function () {\n\t    $scope.killSaveTimer();\n\t    $scope.isNoteDirty = true;\n\t    //console.log('startSaveTimer called ' + $scope.note.id);\n\t    $scope.saveTimer = $timeout(function () {\n\t      $scope.saveNote();\n\t    }, 10000);\n\t  };\n\t\n\t  angular.element(window).on('beforeunload', function (e) {\n\t    $scope.killSaveTimer();\n\t    $scope.saveNote();\n\t  });\n\t\n\t  $scope.setLookAndFeel = function (looknfeel) {\n\t    $scope.note.config.looknfeel = looknfeel;\n\t    if ($scope.revisionView === true) {\n\t      $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n\t    } else {\n\t      $scope.setConfig();\n\t    }\n\t  };\n\t\n\t  /** Set cron expression for this note **/\n\t  $scope.setCronScheduler = function (cronExpr) {\n\t    if (cronExpr) {\n\t      if (!$scope.note.config.cronExecutingUser) {\n\t        $scope.note.config.cronExecutingUser = $rootScope.ticket.principal;\n\t      }\n\t    } else {\n\t      $scope.note.config.cronExecutingUser = '';\n\t    }\n\t    $scope.note.config.cron = cronExpr;\n\t    $scope.setConfig();\n\t  };\n\t\n\t  /** Set the username of the user to be used to execute all notes in notebook **/\n\t  $scope.setCronExecutingUser = function (cronExecutingUser) {\n\t    $scope.note.config.cronExecutingUser = cronExecutingUser;\n\t    $scope.setConfig();\n\t  };\n\t\n\t  /** Set release resource for this note **/\n\t  $scope.setReleaseResource = function (value) {\n\t    $scope.note.config.releaseresource = value;\n\t    $scope.setConfig();\n\t  };\n\t\n\t  /** Update note config **/\n\t  $scope.setConfig = function (config) {\n\t    if (config) {\n\t      $scope.note.config = config;\n\t    }\n\t    websocketMsgSrv.updateNote($scope.note.id, $scope.note.name, $scope.note.config);\n\t  };\n\t\n\t  /** Update the note name */\n\t  $scope.updateNoteName = function (newName) {\n\t    var trimmedNewName = newName.trim();\n\t    if (trimmedNewName.length > 0 && $scope.note.name !== trimmedNewName) {\n\t      $scope.note.name = trimmedNewName;\n\t      websocketMsgSrv.renameNote($scope.note.id, $scope.note.name);\n\t    }\n\t  };\n\t\n\t  var initializeLookAndFeel = function initializeLookAndFeel() {\n\t    if (!$scope.note.config.looknfeel) {\n\t      $scope.note.config.looknfeel = 'default';\n\t    } else {\n\t      $scope.viewOnly = $scope.note.config.looknfeel === 'report' ? true : false;\n\t    }\n\t\n\t    if ($scope.note.paragraphs && $scope.note.paragraphs[0]) {\n\t      $scope.note.paragraphs[0].focus = true;\n\t    }\n\t    $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n\t  };\n\t\n\t  var cleanParagraphExcept = function cleanParagraphExcept(paragraphId, note) {\n\t    var noteCopy = {};\n\t    noteCopy.id = note.id;\n\t    noteCopy.name = note.name;\n\t    noteCopy.config = note.config;\n\t    noteCopy.info = note.info;\n\t    noteCopy.paragraphs = [];\n\t    for (var i = 0; i < note.paragraphs.length; i++) {\n\t      if (note.paragraphs[i].id === paragraphId) {\n\t        noteCopy.paragraphs[0] = note.paragraphs[i];\n\t        if (!noteCopy.paragraphs[0].config) {\n\t          noteCopy.paragraphs[0].config = {};\n\t        }\n\t        noteCopy.paragraphs[0].config.editorHide = true;\n\t        noteCopy.paragraphs[0].config.tableHide = false;\n\t        break;\n\t      }\n\t    }\n\t    return noteCopy;\n\t  };\n\t\n\t  var addPara = function addPara(paragraph, index) {\n\t    $scope.note.paragraphs.splice(index, 0, paragraph);\n\t    _.each($scope.note.paragraphs, function (para) {\n\t      if (para.id === paragraph.id) {\n\t        para.focus = true;\n\t        $scope.$broadcast('focusParagraph', para.id, 0, false);\n\t      }\n\t    });\n\t  };\n\t\n\t  var removePara = function removePara(paragraphId) {\n\t    var removeIdx;\n\t    _.each($scope.note.paragraphs, function (para, idx) {\n\t      if (para.id === paragraphId) {\n\t        removeIdx = idx;\n\t      }\n\t    });\n\t    return $scope.note.paragraphs.splice(removeIdx, 1);\n\t  };\n\t\n\t  $scope.$on('addParagraph', function (event, paragraph, index) {\n\t    if ($scope.paragraphUrl) {\n\t      return;\n\t    }\n\t    addPara(paragraph, index);\n\t  });\n\t\n\t  $scope.$on('removeParagraph', function (event, paragraphId) {\n\t    if ($scope.paragraphUrl) {\n\t      return;\n\t    }\n\t    removePara(paragraphId);\n\t  });\n\t\n\t  $scope.$on('moveParagraph', function (event, paragraphId, newIdx) {\n\t    var removedPara = removePara(paragraphId);\n\t    if (removedPara && removedPara.length === 1) {\n\t      addPara(removedPara[0], newIdx);\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateNote', function (event, name, config, info) {\n\t    /** update Note name */\n\t    if (name !== $scope.note.name) {\n\t      console.log('change note name to : %o', $scope.note.name);\n\t      $scope.note.name = name;\n\t    }\n\t    $scope.note.config = config;\n\t    $scope.note.info = info;\n\t    initializeLookAndFeel();\n\t  });\n\t\n\t  var getInterpreterBindings = function getInterpreterBindings() {\n\t    websocketMsgSrv.getInterpreterBindings($scope.note.id);\n\t  };\n\t\n\t  $scope.$on('interpreterBindings', function (event, data) {\n\t    $scope.interpreterBindings = data.interpreterBindings;\n\t    $scope.interpreterBindingsOrig = angular.copy($scope.interpreterBindings); // to check dirty\n\t\n\t    var selected = false;\n\t    var key;\n\t    var setting;\n\t\n\t    for (key in $scope.interpreterBindings) {\n\t      setting = $scope.interpreterBindings[key];\n\t      if (setting.selected) {\n\t        selected = true;\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (!selected) {\n\t      // make default selection\n\t      var selectedIntp = {};\n\t      for (key in $scope.interpreterBindings) {\n\t        setting = $scope.interpreterBindings[key];\n\t        if (!selectedIntp[setting.name]) {\n\t          setting.selected = true;\n\t          selectedIntp[setting.name] = true;\n\t        }\n\t      }\n\t      $scope.showSetting = true;\n\t    }\n\t  });\n\t\n\t  $scope.interpreterSelectionListeners = {\n\t    accept: function accept(sourceItemHandleScope, destSortableScope) {\n\t      return true;\n\t    },\n\t    itemMoved: function itemMoved(event) {},\n\t    orderChanged: function orderChanged(event) {}\n\t  };\n\t\n\t  $scope.openSetting = function () {\n\t    $scope.showSetting = true;\n\t    getInterpreterBindings();\n\t  };\n\t\n\t  $scope.closeSetting = function () {\n\t    if (isSettingDirty()) {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: '',\n\t        message: 'Interpreter setting changes will be discarded.',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            $scope.$apply(function () {\n\t              $scope.showSetting = false;\n\t            });\n\t          }\n\t        }\n\t      });\n\t    } else {\n\t      $scope.showSetting = false;\n\t    }\n\t  };\n\t\n\t  $scope.saveSetting = function () {\n\t    var selectedSettingIds = [];\n\t    for (var no in $scope.interpreterBindings) {\n\t      var setting = $scope.interpreterBindings[no];\n\t      if (setting.selected) {\n\t        selectedSettingIds.push(setting.id);\n\t      }\n\t    }\n\t    websocketMsgSrv.saveInterpreterBindings($scope.note.id, selectedSettingIds);\n\t    console.log('Interpreter bindings %o saved', selectedSettingIds);\n\t\n\t    _.forEach($scope.note.paragraphs, function (n, key) {\n\t      var regExp = /^\\s*%/g;\n\t      if (n.text && !regExp.exec(n.text)) {\n\t        $scope.$broadcast('saveInterpreterBindings', n.id);\n\t      }\n\t    });\n\t\n\t    $scope.showSetting = false;\n\t  };\n\t\n\t  $scope.toggleSetting = function () {\n\t    if ($scope.showSetting) {\n\t      $scope.closeSetting();\n\t    } else {\n\t      $scope.openSetting();\n\t      $scope.closePermissions();\n\t    }\n\t  };\n\t\n\t  var getPermissions = function getPermissions(callback) {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions').success(function (data, status, headers, config) {\n\t      $scope.permissions = data.body;\n\t      $scope.permissionsOrig = angular.copy($scope.permissions); // to check dirty\n\t\n\t      var selectJson = {\n\t        tokenSeparators: [',', ' '],\n\t        ajax: {\n\t          url: function url(params) {\n\t            if (!params.term) {\n\t              return false;\n\t            }\n\t            return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n\t          },\n\t          delay: 250,\n\t          processResults: function processResults(data, params) {\n\t            var results = [];\n\t\n\t            if (data.body.users.length !== 0) {\n\t              var users = [];\n\t              for (var len = 0; len < data.body.users.length; len++) {\n\t                users.push({\n\t                  'id': data.body.users[len],\n\t                  'text': data.body.users[len]\n\t                });\n\t              }\n\t              results.push({\n\t                'text': 'Users :',\n\t                'children': users\n\t              });\n\t            }\n\t            if (data.body.roles.length !== 0) {\n\t              var roles = [];\n\t              for (var len = 0; len < data.body.roles.length; len++) {\n\t                roles.push({\n\t                  'id': data.body.roles[len],\n\t                  'text': data.body.roles[len]\n\t                });\n\t              }\n\t              results.push({\n\t                'text': 'Roles :',\n\t                'children': roles\n\t              });\n\t            }\n\t            return {\n\t              results: results,\n\t              pagination: {\n\t                more: false\n\t              }\n\t            };\n\t          },\n\t          cache: false\n\t        },\n\t        width: ' ',\n\t        tags: true,\n\t        minimumInputLength: 3\n\t      };\n\t\n\t      $scope.setIamOwner();\n\t      angular.element('#selectOwners').select2(selectJson);\n\t      angular.element('#selectReaders').select2(selectJson);\n\t      angular.element('#selectWriters').select2(selectJson);\n\t      if (callback) {\n\t        callback();\n\t      }\n\t    }).error(function (data, status, headers, config) {\n\t      if (status !== 0) {\n\t        console.log('Error %o %o', status, data.message);\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.openPermissions = function () {\n\t    $scope.showPermissions = true;\n\t    getPermissions();\n\t  };\n\t\n\t  $scope.closePermissions = function () {\n\t    if (isPermissionsDirty()) {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: '',\n\t        message: 'Changes will be discarded.',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            $scope.$apply(function () {\n\t              $scope.showPermissions = false;\n\t            });\n\t          }\n\t        }\n\t      });\n\t    } else {\n\t      $scope.showPermissions = false;\n\t    }\n\t  };\n\t\n\t  function convertPermissionsToArray() {\n\t    $scope.permissions.owners = angular.element('#selectOwners').val();\n\t    $scope.permissions.readers = angular.element('#selectReaders').val();\n\t    $scope.permissions.writers = angular.element('#selectWriters').val();\n\t  }\n\t\n\t  $scope.restartInterpreter = function (interpeter) {\n\t    var thisConfirm = BootstrapDialog.confirm({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: '',\n\t      message: 'Do you want to restart ' + interpeter.name + ' interpreter?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          var payload = {\n\t            'noteId': $scope.note.id\n\t          };\n\t\n\t          thisConfirm.$modalFooter.find('button').addClass('disabled');\n\t          thisConfirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\t\n\t          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + interpeter.id, payload).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.interpreterSettings, { 'id': interpeter.id });\n\t            $scope.interpreterSettings[index] = data.body;\n\t            thisConfirm.close();\n\t          }).error(function (data, status, headers, config) {\n\t            thisConfirm.close();\n\t            console.log('Error %o %o', status, data.message);\n\t            BootstrapDialog.show({\n\t              title: 'Error restart interpreter.',\n\t              message: data.message\n\t            });\n\t          });\n\t          return false;\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.savePermissions = function () {\n\t    convertPermissionsToArray();\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions', $scope.permissions, { withCredentials: true }).success(function (data, status, headers, config) {\n\t      getPermissions(function () {\n\t        console.log('Note permissions %o saved', $scope.permissions);\n\t        BootstrapDialog.alert({\n\t          closable: true,\n\t          title: 'Permissions Saved Successfully!!!',\n\t          message: 'Owners : ' + $scope.permissions.owners + '\\n\\n' + 'Readers : ' + $scope.permissions.readers + '\\n\\n' + 'Writers  : ' + $scope.permissions.writers\n\t        });\n\t        $scope.showPermissions = false;\n\t      });\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t      BootstrapDialog.show({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: 'Insufficient privileges',\n\t        message: data.message,\n\t        buttons: [{\n\t          label: 'Login',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            angular.element('#loginModal').modal({\n\t              show: 'true'\n\t            });\n\t          }\n\t        }, {\n\t          label: 'Cancel',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            $location.path('/');\n\t          }\n\t        }]\n\t      });\n\t    });\n\t  };\n\t\n\t  $scope.togglePermissions = function () {\n\t    var principal = $rootScope.ticket.principal;\n\t    $scope.isAnonymous = principal === 'anonymous' ? true : false;\n\t    if (!!principal && $scope.isAnonymous) {\n\t      $scope.blockAnonUsers();\n\t    } else {\n\t      if ($scope.showPermissions) {\n\t        $scope.closePermissions();\n\t        angular.element('#selectOwners').select2({});\n\t        angular.element('#selectReaders').select2({});\n\t        angular.element('#selectWriters').select2({});\n\t      } else {\n\t        $scope.openPermissions();\n\t        $scope.closeSetting();\n\t      }\n\t    }\n\t  };\n\t\n\t  $scope.setIamOwner = function () {\n\t    if ($scope.permissions.owners.length > 0 && _.indexOf($scope.permissions.owners, $rootScope.ticket.principal) < 0) {\n\t      $scope.isOwner = false;\n\t      return false;\n\t    }\n\t    $scope.isOwner = true;\n\t    return true;\n\t  };\n\t\n\t  $scope.toggleNotePersonalizedMode = function () {\n\t    var personalizedMode = $scope.note.config.personalizedMode;\n\t    if ($scope.isOwner) {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: 'Setting the result display',\n\t        message: function message(dialog) {\n\t          var modeText = $scope.note.config.personalizedMode === 'true' ? 'collaborate' : 'personalize';\n\t          return 'Do you want to <span class=\"text-info\">' + modeText + '</span> your analysis?';\n\t        },\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            if ($scope.note.config.personalizedMode === undefined) {\n\t              $scope.note.config.personalizedMode = 'false';\n\t            }\n\t            $scope.note.config.personalizedMode = personalizedMode === 'true' ? 'false' : 'true';\n\t            websocketMsgSrv.updatePersonalizedMode($scope.note.id, $scope.note.config.personalizedMode);\n\t          }\n\t        }\n\t      });\n\t    }\n\t  };\n\t\n\t  var isSettingDirty = function isSettingDirty() {\n\t    if (angular.equals($scope.interpreterBindings, $scope.interpreterBindingsOrig)) {\n\t      return false;\n\t    } else {\n\t      return true;\n\t    }\n\t  };\n\t\n\t  var isPermissionsDirty = function isPermissionsDirty() {\n\t    if (angular.equals($scope.permissions, $scope.permissionsOrig)) {\n\t      return false;\n\t    } else {\n\t      return true;\n\t    }\n\t  };\n\t\n\t  angular.element(document).click(function () {\n\t    angular.element('.ace_autocomplete').hide();\n\t  });\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setConnectedStatus', function (event, param) {\n\t    if (connectedOnce && param) {\n\t      initNotebook();\n\t    }\n\t    connectedOnce = true;\n\t  });\n\t\n\t  $scope.$on('moveParagraphUp', function (event, paragraph) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === paragraph.id) {\n\t        newIndex = i - 1;\n\t        break;\n\t      }\n\t    }\n\t    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t    // save dirtyText of moving paragraphs.\n\t    var prevParagraph = $scope.note.paragraphs[newIndex];\n\t    angular.element('#' + paragraph.id + '_paragraphColumn_main').scope().saveParagraph(paragraph);\n\t    angular.element('#' + prevParagraph.id + '_paragraphColumn_main').scope().saveParagraph(prevParagraph);\n\t    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n\t  });\n\t\n\t  $scope.$on('moveParagraphDown', function (event, paragraph) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === paragraph.id) {\n\t        newIndex = i + 1;\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t    // save dirtyText of moving paragraphs.\n\t    var nextParagraph = $scope.note.paragraphs[newIndex];\n\t    angular.element('#' + paragraph.id + '_paragraphColumn_main').scope().saveParagraph(paragraph);\n\t    angular.element('#' + nextParagraph.id + '_paragraphColumn_main').scope().saveParagraph(nextParagraph);\n\t    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n\t  });\n\t\n\t  $scope.$on('moveFocusToPreviousParagraph', function (event, currentParagraphId) {\n\t    var focus = false;\n\t    for (var i = $scope.note.paragraphs.length - 1; i >= 0; i--) {\n\t      if (focus === false) {\n\t        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n\t          focus = true;\n\t          continue;\n\t        }\n\t      } else {\n\t        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, -1);\n\t        break;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('moveFocusToNextParagraph', function (event, currentParagraphId) {\n\t    var focus = false;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if (focus === false) {\n\t        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n\t          focus = true;\n\t          continue;\n\t        }\n\t      } else {\n\t        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, 0);\n\t        break;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('insertParagraph', function (event, paragraphId, position) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === paragraphId) {\n\t        //determine position of where to add new paragraph; default is below\n\t        if (position === 'above') {\n\t          newIndex = i;\n\t        } else {\n\t          newIndex = i + 1;\n\t        }\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t    websocketMsgSrv.insertParagraph(newIndex);\n\t  });\n\t\n\t  $scope.$on('setNoteContent', function (event, note) {\n\t    if (note === undefined) {\n\t      $location.path('/');\n\t    }\n\t\n\t    $scope.note = note;\n\t\n\t    $scope.paragraphUrl = $routeParams.paragraphId;\n\t    $scope.asIframe = $routeParams.asIframe;\n\t    if ($scope.paragraphUrl) {\n\t      $scope.note = cleanParagraphExcept($scope.paragraphUrl, note);\n\t      $scope.$broadcast('$unBindKeyEvent', $scope.$unBindKeyEvent);\n\t      $rootScope.$broadcast('setIframe', $scope.asIframe);\n\t    }\n\t\n\t    initializeLookAndFeel();\n\t    //open interpreter binding setting when there're none selected\n\t    getInterpreterBindings();\n\t    getPermissions();\n\t    var isPersonalized = $scope.note.config.personalizedMode;\n\t    isPersonalized = isPersonalized === undefined ? 'false' : isPersonalized;\n\t    $scope.note.config.personalizedMode = isPersonalized;\n\t  });\n\t\n\t  $scope.$on('$destroy', function () {\n\t    angular.element(window).off('beforeunload');\n\t    $scope.killSaveTimer();\n\t    $scope.saveNote();\n\t\n\t    document.removeEventListener('click', $scope.focusParagraphOnClick);\n\t    document.removeEventListener('keydown', $scope.keyboardShortcut);\n\t  });\n\t\n\t  $scope.$on('$unBindKeyEvent', function () {\n\t    document.removeEventListener('click', $scope.focusParagraphOnClick);\n\t    document.removeEventListener('keydown', $scope.keyboardShortcut);\n\t  });\n\t\n\t  angular.element(window).bind('resize', function () {\n\t    var actionbarHeight = document.getElementById('actionbar').lastElementChild.clientHeight;\n\t    angular.element(document.getElementById('content')).css('padding-top', actionbarHeight - 20);\n\t  });\n\t}\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * Create table data object from paragraph table type result\n\t */\n\tvar TableData = function () {\n\t  function TableData(columns, rows, comment) {\n\t    _classCallCheck(this, TableData);\n\t\n\t    this.columns = columns || [];\n\t    this.rows = rows || [];\n\t    this.comment = comment || '';\n\t  }\n\t\n\t  _createClass(TableData, [{\n\t    key: 'loadParagraphResult',\n\t    value: function loadParagraphResult(paragraphResult) {\n\t      if (!paragraphResult || paragraphResult.type !== 'TABLE') {\n\t        console.log('Can not load paragraph result');\n\t        return;\n\t      }\n\t\n\t      var columnNames = [];\n\t      var rows = [];\n\t      var array = [];\n\t      var textRows = paragraphResult.msg.split('\\n');\n\t      var comment = '';\n\t      var commentRow = false;\n\t\n\t      for (var i = 0; i < textRows.length; i++) {\n\t        var textRow = textRows[i];\n\t\n\t        if (commentRow) {\n\t          comment += textRow;\n\t          continue;\n\t        }\n\t\n\t        if (textRow === '' || textRow === '<!--TABLE_COMMENT-->') {\n\t          if (rows.length > 0) {\n\t            commentRow = true;\n\t          }\n\t          continue;\n\t        }\n\t        var textCols = textRow.split('\\t');\n\t        var cols = [];\n\t        var cols2 = [];\n\t        for (var j = 0; j < textCols.length; j++) {\n\t          var col = textCols[j];\n\t          if (i === 0) {\n\t            columnNames.push({ name: col, index: j, aggr: 'sum' });\n\t          } else {\n\t            cols.push(col);\n\t            cols2.push({ key: columnNames[i] ? columnNames[i].name : undefined, value: col });\n\t          }\n\t        }\n\t        if (i !== 0) {\n\t          rows.push(cols);\n\t          array.push(cols2);\n\t        }\n\t      }\n\t      this.comment = comment;\n\t      this.columns = columnNames;\n\t      this.rows = rows;\n\t    }\n\t  }]);\n\t\n\t  return TableData;\n\t}();\n\t\n\texports.default = TableData;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * Base class for visualization\n\t */\n\tvar Transformation = function () {\n\t  function Transformation(config) {\n\t    _classCallCheck(this, Transformation);\n\t\n\t    this.config = config;\n\t    this._emitter;\n\t  }\n\t\n\t  _createClass(Transformation, [{\n\t    key: 'getSetting',\n\t\n\t\n\t    /**\n\t     * return {\n\t     *   template : angular template string or url (url should end with .html),\n\t     *   scope : an object to bind to template scope\n\t     * }\n\t     */\n\t    value: function getSetting() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'renderSetting',\n\t\n\t\n\t    /**\n\t     * render setting\n\t     */\n\t    value: function renderSetting(targetEl) {\n\t      var setting = this.getSetting();\n\t      if (!setting) {\n\t        return;\n\t      }\n\t\n\t      // already readered\n\t      if (this._scope) {\n\t        var self = this;\n\t        this._scope.$apply(function () {\n\t          for (var k in setting.scope) {\n\t            self._scope[k] = setting.scope[k];\n\t          }\n\t\n\t          for (var k in self._prevSettingScope) {\n\t            if (!setting.scope[k]) {\n\t              self._scope[k] = setting.scope[k];\n\t            }\n\t          }\n\t        });\n\t        return;\n\t      } else {\n\t        this._prevSettingScope = setting.scope;\n\t      }\n\t\n\t      var scope = this._createNewScope();\n\t      for (var k in setting.scope) {\n\t        scope[k] = setting.scope[k];\n\t      }\n\t      var template = setting.template;\n\t\n\t      if (template.split('\\n').length === 1 && template.endsWith('.html')) {\n\t        // template is url\n\t        var self = this;\n\t        this._templateRequest(template).then(function (t) {\n\t          self._render(targetEl, t, scope);\n\t        });\n\t      } else {\n\t        this._render(targetEl, template, scope);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_render',\n\t    value: function _render(targetEl, template, scope) {\n\t      this._targetEl = targetEl;\n\t      targetEl.html(template);\n\t      this._compile(targetEl.contents())(scope);\n\t      this._scope = scope;\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t    value: function setConfig(config) {\n\t      this.config = config;\n\t    }\n\t  }, {\n\t    key: 'emitConfig',\n\t\n\t\n\t    /**\n\t     * Emit config. config will sent to server and saved.\n\t     */\n\t    value: function emitConfig(config) {\n\t      this._emitter(config);\n\t    }\n\t  }]);\n\t\n\t  return Transformation;\n\t}();\n\t\n\texports.default = Transformation;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _transformation = __webpack_require__(7);\n\t\n\tvar _transformation2 = _interopRequireDefault(_transformation);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * pivot table data and return d3 chart data\n\t */\n\tvar PivotTransformation = function (_Transformation) {\n\t  _inherits(PivotTransformation, _Transformation);\n\t\n\t  function PivotTransformation(config) {\n\t    _classCallCheck(this, PivotTransformation);\n\t\n\t    return _possibleConstructorReturn(this, (PivotTransformation.__proto__ || Object.getPrototypeOf(PivotTransformation)).call(this, config));\n\t  }\n\t\n\t  _createClass(PivotTransformation, [{\n\t    key: 'getSetting',\n\t    value: function getSetting() {\n\t      var self = this;\n\t\n\t      var configObj = self.config;\n\t      console.log('getSetting', configObj);\n\t      return {\n\t        template: 'app/tabledata/pivot_settings.html',\n\t        scope: {\n\t          config: configObj.common.pivot,\n\t          tableDataColumns: self.tableDataColumns,\n\t          save: function save() {\n\t            self.emitConfig(configObj);\n\t          },\n\t          removeKey: function removeKey(idx) {\n\t            configObj.common.pivot.keys.splice(idx, 1);\n\t            self.emitConfig(configObj);\n\t          },\n\t          removeGroup: function removeGroup(idx) {\n\t            configObj.common.pivot.groups.splice(idx, 1);\n\t            self.emitConfig(configObj);\n\t          },\n\t          removeValue: function removeValue(idx) {\n\t            configObj.common.pivot.values.splice(idx, 1);\n\t            self.emitConfig(configObj);\n\t          },\n\t          setValueAggr: function setValueAggr(idx, aggr) {\n\t            configObj.common.pivot.values[idx].aggr = aggr;\n\t            self.emitConfig(configObj);\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      this.tableDataColumns = tableData.columns;\n\t      this.config.common = this.config.common || {};\n\t      this.config.common.pivot = this.config.common.pivot || {};\n\t      var config = this.config.common.pivot;\n\t      var firstTime = !config.keys && !config.groups && !config.values;\n\t\n\t      config.keys = config.keys || [];\n\t      config.groups = config.groups || [];\n\t      config.values = config.values || [];\n\t\n\t      this.removeUnknown();\n\t      if (firstTime) {\n\t        this.selectDefault();\n\t      }\n\t      return this.pivot(tableData, config.keys, config.groups, config.values);\n\t    }\n\t  }, {\n\t    key: 'removeUnknown',\n\t    value: function removeUnknown() {\n\t      var config = this.config.common.pivot;\n\t      var tableDataColumns = this.tableDataColumns;\n\t      var unique = function unique(list) {\n\t        for (var i = 0; i < list.length; i++) {\n\t          for (var j = i + 1; j < list.length; j++) {\n\t            if (angular.equals(list[i], list[j])) {\n\t              list.splice(j, 1);\n\t            }\n\t          }\n\t        }\n\t      };\n\t\n\t      var removeUnknown = function removeUnknown(list) {\n\t        for (var i = 0; i < list.length; i++) {\n\t          // remove non existing column\n\t          var found = false;\n\t          for (var j = 0; j < tableDataColumns.length; j++) {\n\t            var a = list[i];\n\t            var b = tableDataColumns[j];\n\t            if (a.index === b.index && a.name === b.name) {\n\t              found = true;\n\t              break;\n\t            }\n\t          }\n\t          if (!found) {\n\t            list.splice(i, 1);\n\t          }\n\t        }\n\t      };\n\t\n\t      unique(config.keys);\n\t      removeUnknown(config.keys);\n\t      unique(config.groups);\n\t      removeUnknown(config.groups);\n\t      removeUnknown(config.values);\n\t    }\n\t  }, {\n\t    key: 'selectDefault',\n\t    value: function selectDefault() {\n\t      var config = this.config.common.pivot;\n\t      if (config.keys.length === 0 && config.groups.length === 0 && config.values.length === 0) {\n\t        if (config.keys.length === 0 && this.tableDataColumns.length > 0) {\n\t          config.keys.push(this.tableDataColumns[0]);\n\t        }\n\t\n\t        if (config.values.length === 0 && this.tableDataColumns.length > 1) {\n\t          config.values.push(this.tableDataColumns[1]);\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'pivot',\n\t    value: function pivot(data, keys, groups, values) {\n\t      var aggrFunc = {\n\t        sum: function sum(a, b) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return varA + varB;\n\t        },\n\t        count: function count(a, b) {\n\t          var varA = a !== undefined ? parseInt(a) : 0;\n\t          var varB = b !== undefined ? 1 : 0;\n\t          return varA + varB;\n\t        },\n\t        min: function min(a, b) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return Math.min(varA, varB);\n\t        },\n\t        max: function max(a, b) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return Math.max(varA, varB);\n\t        },\n\t        avg: function avg(a, b, c) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return varA + varB;\n\t        }\n\t      };\n\t\n\t      var aggrFuncDiv = {\n\t        sum: false,\n\t        count: false,\n\t        min: false,\n\t        max: false,\n\t        avg: true\n\t      };\n\t\n\t      var schema = {};\n\t      var rows = {};\n\t\n\t      for (var i = 0; i < data.rows.length; i++) {\n\t        var row = data.rows[i];\n\t        var s = schema;\n\t        var p = rows;\n\t\n\t        for (var k = 0; k < keys.length; k++) {\n\t          var key = keys[k];\n\t\n\t          // add key to schema\n\t          if (!s[key.name]) {\n\t            s[key.name] = {\n\t              order: k,\n\t              index: key.index,\n\t              type: 'key',\n\t              children: {}\n\t            };\n\t          }\n\t          s = s[key.name].children;\n\t\n\t          // add key to row\n\t          var keyKey = row[key.index];\n\t          if (!p[keyKey]) {\n\t            p[keyKey] = {};\n\t          }\n\t          p = p[keyKey];\n\t        }\n\t\n\t        for (var g = 0; g < groups.length; g++) {\n\t          var group = groups[g];\n\t          var groupKey = row[group.index];\n\t\n\t          // add group to schema\n\t          if (!s[groupKey]) {\n\t            s[groupKey] = {\n\t              order: g,\n\t              index: group.index,\n\t              type: 'group',\n\t              children: {}\n\t            };\n\t          }\n\t          s = s[groupKey].children;\n\t\n\t          // add key to row\n\t          if (!p[groupKey]) {\n\t            p[groupKey] = {};\n\t          }\n\t          p = p[groupKey];\n\t        }\n\t\n\t        for (var v = 0; v < values.length; v++) {\n\t          var value = values[v];\n\t          var valueKey = value.name + '(' + value.aggr + ')';\n\t\n\t          // add value to schema\n\t          if (!s[valueKey]) {\n\t            s[valueKey] = {\n\t              type: 'value',\n\t              order: v,\n\t              index: value.index\n\t            };\n\t          }\n\t\n\t          // add value to row\n\t          if (!p[valueKey]) {\n\t            p[valueKey] = {\n\t              value: value.aggr !== 'count' ? row[value.index] : 1,\n\t              count: 1\n\t            };\n\t          } else {\n\t            p[valueKey] = {\n\t              value: aggrFunc[value.aggr](p[valueKey].value, row[value.index], p[valueKey].count + 1),\n\t              count: aggrFuncDiv[value.aggr] ? p[valueKey].count + 1 : p[valueKey].count\n\t            };\n\t          }\n\t        }\n\t      }\n\t\n\t      //console.log('schema=%o, rows=%o', schema, rows);\n\t      return {\n\t        keys: keys,\n\t        groups: groups,\n\t        values: values,\n\t        schema: schema,\n\t        rows: rows\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return PivotTransformation;\n\t}(_transformation2.default);\n\t\n\texports.default = PivotTransformation;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _transformation = __webpack_require__(7);\n\t\n\tvar _transformation2 = _interopRequireDefault(_transformation);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * passthough the data\n\t */\n\tvar PassthroughTransformation = function (_Transformation) {\n\t  _inherits(PassthroughTransformation, _Transformation);\n\t\n\t  function PassthroughTransformation(config) {\n\t    _classCallCheck(this, PassthroughTransformation);\n\t\n\t    return _possibleConstructorReturn(this, (PassthroughTransformation.__proto__ || Object.getPrototypeOf(PassthroughTransformation)).call(this, config));\n\t  }\n\t\n\t  _createClass(PassthroughTransformation, [{\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      return tableData;\n\t    }\n\t  }]);\n\t\n\t  return PassthroughTransformation;\n\t}(_transformation2.default);\n\t\n\texports.default = PassthroughTransformation;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _transformation = __webpack_require__(7);\n\t\n\tvar _transformation2 = _interopRequireDefault(_transformation);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * select columns\n\t * - columnSelectorProp\n\t *   [\n\t *     {\n\t *       \"name\":\n\t *       \"tooltip\":\n\t *     },\n\t *     ...\n\t *   ]\n\t */\n\tvar ColumnselectorTransformation = function (_Transformation) {\n\t  _inherits(ColumnselectorTransformation, _Transformation);\n\t\n\t  function ColumnselectorTransformation(config, columnSelectorProp) {\n\t    _classCallCheck(this, ColumnselectorTransformation);\n\t\n\t    var _this = _possibleConstructorReturn(this, (ColumnselectorTransformation.__proto__ || Object.getPrototypeOf(ColumnselectorTransformation)).call(this, config));\n\t\n\t    _this.props = columnSelectorProp;\n\t    return _this;\n\t  }\n\t\n\t  _createClass(ColumnselectorTransformation, [{\n\t    key: 'getSetting',\n\t    value: function getSetting() {\n\t      var self = this;\n\t      var configObj = self.config;\n\t      return {\n\t        template: 'app/tabledata/columnselector_settings.html',\n\t        scope: {\n\t          config: self.config,\n\t          props: self.props,\n\t          tableDataColumns: self.tableDataColumns,\n\t          save: function save() {\n\t            self.emitConfig(configObj);\n\t          },\n\t          remove: function remove(selectorName) {\n\t            configObj[selectorName] = null;\n\t            self.emitConfig(configObj);\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      this.tableDataColumns = tableData.columns;\n\t      this.removeUnknown();\n\t      return tableData;\n\t    }\n\t  }, {\n\t    key: 'removeUnknown',\n\t    value: function removeUnknown() {\n\t      var fields = this.config;\n\t      for (var f in fields) {\n\t        if (fields[f]) {\n\t          var found = false;\n\t          for (var i = 0; i < this.tableDataColumns.length; i++) {\n\t            var a = fields[f];\n\t            var b = this.tableDataColumns[i];\n\t            if (a.index === b.index && a.name === b.name) {\n\t              found = true;\n\t              break;\n\t            }\n\t          }\n\t          if (!found && fields[f] instanceof Object && !(fields[f] instanceof Array)) {\n\t            fields[f] = null;\n\t          }\n\t        }\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return ColumnselectorTransformation;\n\t}(_transformation2.default);\n\t\n\texports.default = ColumnselectorTransformation;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * Base class for visualization\n\t */\n\tvar Visualization = function () {\n\t  function Visualization(targetEl, config) {\n\t    _classCallCheck(this, Visualization);\n\t\n\t    this.targetEl = targetEl;\n\t    this.config = config;\n\t    this._dirty = false;\n\t    this._active = false;\n\t    this._emitter;\n\t  }\n\t\n\t  _createClass(Visualization, [{\n\t    key: 'getTransformation',\n\t\n\t\n\t    /**\n\t     * get transformation\n\t     */\n\t    value: function getTransformation() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'render',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when data or configuration changed\n\t     */\n\t    value: function render(tableData) {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'refresh',\n\t\n\t\n\t    /**\n\t     * Refresh visualization.\n\t     */\n\t    value: function refresh() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t\n\t\n\t    /**\n\t     * method will be invoked when visualization need to be destroyed.\n\t     * Don't need to destroy this.targetEl.\n\t     */\n\t    value: function destroy() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'getSetting',\n\t\n\t\n\t    /**\n\t     * return {\n\t     *   template : angular template string or url (url should end with .html),\n\t     *   scope : an object to bind to template scope\n\t     * }\n\t     */\n\t    value: function getSetting() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'activate',\n\t\n\t\n\t    /**\n\t     * Activate. invoked when visualization is selected\n\t     */\n\t    value: function activate() {\n\t      if (!this._active || this._dirty) {\n\t        this.refresh();\n\t        this._dirty = false;\n\t      }\n\t      this._active = true;\n\t    }\n\t  }, {\n\t    key: 'deactivate',\n\t\n\t\n\t    /**\n\t     * Activate. invoked when visualization is de selected\n\t     */\n\t    value: function deactivate() {\n\t      this._active = false;\n\t    }\n\t  }, {\n\t    key: 'isActive',\n\t\n\t\n\t    /**\n\t     * Is active\n\t     */\n\t    value: function isActive() {\n\t      return this._active;\n\t    }\n\t  }, {\n\t    key: 'resize',\n\t\n\t\n\t    /**\n\t     * When window or paragraph is resized\n\t     */\n\t    value: function resize() {\n\t      if (this.isActive()) {\n\t        this.refresh();\n\t      } else {\n\t        this._dirty = true;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      this.config = config;\n\t      if (this.isActive()) {\n\t        this.refresh();\n\t      } else {\n\t        this._dirty = true;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'emitConfig',\n\t\n\t\n\t    /**\n\t     * Emit config. config will sent to server and saved.\n\t     */\n\t    value: function emitConfig(config) {\n\t      this._emitter(config);\n\t    }\n\t  }, {\n\t    key: 'renderSetting',\n\t\n\t\n\t    /**\n\t     * render setting\n\t     */\n\t    value: function renderSetting(targetEl) {\n\t      var _this = this;\n\t\n\t      var setting = this.getSetting();\n\t      if (!setting) {\n\t        return;\n\t      }\n\t\n\t      // already readered\n\t      if (this._scope) {\n\t        var self = this;\n\t        this._scope.$apply(function () {\n\t          for (var k in setting.scope) {\n\t            self._scope[k] = setting.scope[k];\n\t          }\n\t\n\t          for (var k in self._prevSettingScope) {\n\t            if (!setting.scope[k]) {\n\t              self._scope[k] = setting.scope[k];\n\t            }\n\t          }\n\t        });\n\t        return;\n\t      } else {\n\t        this._prevSettingScope = setting.scope;\n\t      }\n\t\n\t      var scope = this._createNewScope();\n\t      for (var k in setting.scope) {\n\t        scope[k] = setting.scope[k];\n\t      }\n\t      var template = setting.template;\n\t\n\t      if (template.split('\\n').length === 1 && template.endsWith('.html')) {\n\t        // template is url\n\t        this._templateRequest(template).then(function (t) {\n\t          return _renderSetting(_this, targetEl, t, scope);\n\t        });\n\t      } else {\n\t        _renderSetting(this, targetEl, template, scope);\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Visualization;\n\t}();\n\t\n\texports.default = Visualization;\n\t\n\t\n\tfunction _renderSetting(instance, targetEl, template, scope) {\n\t  instance._targetEl = targetEl;\n\t  targetEl.html(template);\n\t  instance._compile(targetEl.contents())(scope);\n\t  instance._scope = scope;\n\t};\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _visualization = __webpack_require__(11);\n\t\n\tvar _visualization2 = _interopRequireDefault(_visualization);\n\t\n\tvar _passthrough = __webpack_require__(9);\n\t\n\tvar _passthrough2 = _interopRequireDefault(_passthrough);\n\t\n\tvar _handsonHelper = __webpack_require__(4);\n\t\n\tvar _handsonHelper2 = _interopRequireDefault(_handsonHelper);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in table format\n\t */\n\tvar TableVisualization = function (_Visualization) {\n\t  _inherits(TableVisualization, _Visualization);\n\t\n\t  function TableVisualization(targetEl, config) {\n\t    _classCallCheck(this, TableVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (TableVisualization.__proto__ || Object.getPrototypeOf(TableVisualization)).call(this, targetEl, config));\n\t\n\t    console.log('Init table viz');\n\t    targetEl.addClass('table');\n\t    _this.passthrough = new _passthrough2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(TableVisualization, [{\n\t    key: 'refresh',\n\t    value: function refresh() {\n\t      this.hot.render();\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(tableData) {\n\t      var height = this.targetEl.height();\n\t      var container = this.targetEl.css('height', height).get(0);\n\t      var resultRows = tableData.rows;\n\t      var columnNames = _.pluck(tableData.columns, 'name');\n\t      var columns = Array.apply(null, Array(tableData.columns.length)).map(function () {\n\t        return { type: 'text' };\n\t      });\n\t\n\t      if (this.hot) {\n\t        this.hot.destroy();\n\t      }\n\t\n\t      var handsonHelper = new _handsonHelper2.default();\n\t      this.hot = new Handsontable(container, handsonHelper.getHandsonTableConfig(columns, columnNames, resultRows));\n\t      this.hot.validateCells(null);\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this.hot) {\n\t        this.hot.destroy();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.passthrough;\n\t    }\n\t  }]);\n\t\n\t  return TableVisualization;\n\t}(_visualization2.default);\n\t\n\texports.default = TableVisualization;\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _visualization = __webpack_require__(11);\n\t\n\tvar _visualization2 = _interopRequireDefault(_visualization);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in table format\n\t */\n\tvar Nvd3ChartVisualization = function (_Visualization) {\n\t  _inherits(Nvd3ChartVisualization, _Visualization);\n\t\n\t  function Nvd3ChartVisualization(targetEl, config) {\n\t    _classCallCheck(this, Nvd3ChartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (Nvd3ChartVisualization.__proto__ || Object.getPrototypeOf(Nvd3ChartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.targetEl.append('<svg></svg>');\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Nvd3ChartVisualization, [{\n\t    key: 'refresh',\n\t    value: function refresh() {\n\t      if (this.chart) {\n\t        this.chart.update();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(data) {\n\t      var type = this.type();\n\t      var d3g = data.d3g;\n\t\n\t      if (!this.chart) {\n\t        this.chart = nv.models[type]();\n\t      }\n\t\n\t      this.configureChart(this.chart);\n\t\n\t      var animationDuration = 300;\n\t      var numberOfDataThreshold = 150;\n\t      var height = this.targetEl.height();\n\t\n\t      // turn off animation when dataset is too large. (for performance issue)\n\t      // still, since dataset is large, the chart content sequentially appears like animated.\n\t      try {\n\t        if (d3g[0].values.length > numberOfDataThreshold) {\n\t          animationDuration = 0;\n\t        }\n\t      } catch (ignoreErr) {}\n\t\n\t      d3.select('#' + this.targetEl[0].id + ' svg').attr('height', height).datum(d3g).transition().duration(animationDuration).call(this.chart);\n\t      d3.select('#' + this.targetEl[0].id + ' svg').style.height = height + 'px';\n\t    }\n\t  }, {\n\t    key: 'type',\n\t    value: function type() {\n\t      // override this and return chart type\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      // override this to configure chart\n\t    }\n\t  }, {\n\t    key: 'groupedThousandsWith3DigitsFormatter',\n\t    value: function groupedThousandsWith3DigitsFormatter(x) {\n\t      return d3.format(',')(d3.round(x, 3));\n\t    }\n\t  }, {\n\t    key: 'customAbbrevFormatter',\n\t    value: function customAbbrevFormatter(x) {\n\t      var s = d3.format('.3s')(x);\n\t      switch (s[s.length - 1]) {\n\t        case 'G':\n\t          return s.slice(0, -1) + 'B';\n\t      }\n\t      return s;\n\t    }\n\t  }, {\n\t    key: 'xAxisTickFormat',\n\t    value: function xAxisTickFormat(d, xLabels) {\n\t      if (xLabels[d] && (isNaN(parseFloat(xLabels[d])) || !isFinite(xLabels[d]))) {\n\t        // to handle string type xlabel\n\t        return xLabels[d];\n\t      } else {\n\t        return d;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'yAxisTickFormat',\n\t    value: function yAxisTickFormat(d) {\n\t      if (Math.abs(d) >= Math.pow(10, 6)) {\n\t        return this.customAbbrevFormatter(d);\n\t      }\n\t      return this.groupedThousandsWith3DigitsFormatter(d);\n\t    }\n\t  }, {\n\t    key: 'd3DataFromPivot',\n\t    value: function d3DataFromPivot(schema, rows, keys, groups, values, allowTextXAxis, fillMissingValues, multiBarChart) {\n\t      // construct table data\n\t      var d3g = [];\n\t\n\t      var concat = function concat(o, n) {\n\t        if (!o) {\n\t          return n;\n\t        } else {\n\t          return o + '.' + n;\n\t        }\n\t      };\n\t\n\t      var getSchemaUnderKey = function getSchemaUnderKey(key, s) {\n\t        for (var c in key.children) {\n\t          s[c] = {};\n\t          getSchemaUnderKey(key.children[c], s[c]);\n\t        }\n\t      };\n\t\n\t      var traverse = function traverse(sKey, s, rKey, r, func, rowName, rowValue, colName) {\n\t        //console.log(\"TRAVERSE sKey=%o, s=%o, rKey=%o, r=%o, rowName=%o, rowValue=%o, colName=%o\", sKey, s, rKey, r, rowName, rowValue, colName);\n\t\n\t        if (s.type === 'key') {\n\t          rowName = concat(rowName, sKey);\n\t          rowValue = concat(rowValue, rKey);\n\t        } else if (s.type === 'group') {\n\t          colName = concat(colName, rKey);\n\t        } else if (s.type === 'value' && sKey === rKey || valueOnly) {\n\t          colName = concat(colName, rKey);\n\t          func(rowName, rowValue, colName, r);\n\t        }\n\t\n\t        for (var c in s.children) {\n\t          if (fillMissingValues && s.children[c].type === 'group' && r[c] === undefined) {\n\t            var cs = {};\n\t            getSchemaUnderKey(s.children[c], cs);\n\t            traverse(c, s.children[c], c, cs, func, rowName, rowValue, colName);\n\t            continue;\n\t          }\n\t\n\t          for (var j in r) {\n\t            if (s.children[c].type === 'key' || c === j) {\n\t              traverse(c, s.children[c], j, r[j], func, rowName, rowValue, colName);\n\t            }\n\t          }\n\t        }\n\t      };\n\t\n\t      var valueOnly = keys.length === 0 && groups.length === 0 && values.length > 0;\n\t      var noKey = keys.length === 0;\n\t      var isMultiBarChart = multiBarChart;\n\t\n\t      var sKey = Object.keys(schema)[0];\n\t\n\t      var rowNameIndex = {};\n\t      var rowIdx = 0;\n\t      var colNameIndex = {};\n\t      var colIdx = 0;\n\t      var rowIndexValue = {};\n\t\n\t      for (var k in rows) {\n\t        traverse(sKey, schema[sKey], k, rows[k], function (rowName, rowValue, colName, value) {\n\t          //console.log(\"RowName=%o, row=%o, col=%o, value=%o\", rowName, rowValue, colName, value);\n\t          if (rowNameIndex[rowValue] === undefined) {\n\t            rowIndexValue[rowIdx] = rowValue;\n\t            rowNameIndex[rowValue] = rowIdx++;\n\t          }\n\t\n\t          if (colNameIndex[colName] === undefined) {\n\t            colNameIndex[colName] = colIdx++;\n\t          }\n\t          var i = colNameIndex[colName];\n\t          if (noKey && isMultiBarChart) {\n\t            i = 0;\n\t          }\n\t\n\t          if (!d3g[i]) {\n\t            d3g[i] = {\n\t              values: [],\n\t              key: noKey && isMultiBarChart ? 'values' : colName\n\t            };\n\t          }\n\t\n\t          var xVar = isNaN(rowValue) ? allowTextXAxis ? rowValue : rowNameIndex[rowValue] : parseFloat(rowValue);\n\t          var yVar = 0;\n\t          if (xVar === undefined) {\n\t            xVar = colName;\n\t          }\n\t          if (value !== undefined) {\n\t            yVar = isNaN(value.value) ? 0 : parseFloat(value.value) / parseFloat(value.count);\n\t          }\n\t          d3g[i].values.push({\n\t            x: xVar,\n\t            y: yVar\n\t          });\n\t        });\n\t      }\n\t\n\t      // clear aggregation name, if possible\n\t      var namesWithoutAggr = {};\n\t      var colName;\n\t      var withoutAggr;\n\t      // TODO - This part could use som refactoring - Weird if/else with similar actions and variable names\n\t      for (colName in colNameIndex) {\n\t        withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n\t        if (!namesWithoutAggr[withoutAggr]) {\n\t          namesWithoutAggr[withoutAggr] = 1;\n\t        } else {\n\t          namesWithoutAggr[withoutAggr]++;\n\t        }\n\t      }\n\t\n\t      if (valueOnly) {\n\t        for (var valueIndex = 0; valueIndex < d3g[0].values.length; valueIndex++) {\n\t          colName = d3g[0].values[valueIndex].x;\n\t          if (!colName) {\n\t            continue;\n\t          }\n\t\n\t          withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n\t          if (namesWithoutAggr[withoutAggr] <= 1) {\n\t            d3g[0].values[valueIndex].x = withoutAggr;\n\t          }\n\t        }\n\t      } else {\n\t        for (var d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n\t          colName = d3g[d3gIndex].key;\n\t          withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n\t          if (namesWithoutAggr[withoutAggr] <= 1) {\n\t            d3g[d3gIndex].key = withoutAggr;\n\t          }\n\t        }\n\t\n\t        // use group name instead of group.value as a column name, if there're only one group and one value selected.\n\t        if (groups.length === 1 && values.length === 1) {\n\t          for (d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n\t            colName = d3g[d3gIndex].key;\n\t            colName = colName.split('.').slice(0, -1).join('.');\n\t            d3g[d3gIndex].key = colName;\n\t          }\n\t        }\n\t      }\n\t\n\t      return {\n\t        xLabels: rowIndexValue,\n\t        d3g: d3g\n\t      };\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t\n\t\n\t    /**\n\t     * method will be invoked when visualization need to be destroyed.\n\t     * Don't need to destroy this.targetEl.\n\t     */\n\t    value: function destroy() {\n\t      if (this.chart) {\n\t        d3.selectAll('#' + this.targetEl[0].id + ' svg > *').remove();\n\t        this.chart = undefined;\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Nvd3ChartVisualization;\n\t}(_visualization2.default);\n\t\n\texports.default = Nvd3ChartVisualization;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in bar char\n\t */\n\tvar BarchartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(BarchartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function BarchartVisualization(targetEl, config) {\n\t    _classCallCheck(this, BarchartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (BarchartVisualization.__proto__ || Object.getPrototypeOf(BarchartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(BarchartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'multiBarChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, true, true, true);\n\t\n\t      _get(BarchartVisualization.prototype.__proto__ || Object.getPrototypeOf(BarchartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(BarchartVisualization.prototype.__proto__ || Object.getPrototypeOf(BarchartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t      chart.yAxis.axisLabelDistance(50);\n\t      chart.yAxis.tickFormat(function (d) {\n\t        return self.yAxisTickFormat(d);\n\t      });\n\t\n\t      this.chart.stacked(this.config.stacked);\n\t\n\t      var self = this;\n\t      this.chart.dispatch.on('stateChange', function (s) {\n\t        self.config.stacked = s.stacked;\n\t\n\t        // give some time to animation finish\n\t        setTimeout(function () {\n\t          self.emitConfig(self.config);\n\t        }, 500);\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return BarchartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = BarchartVisualization;\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in pie chart\n\t */\n\tvar PiechartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(PiechartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function PiechartVisualization(targetEl, config) {\n\t    _classCallCheck(this, PiechartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (PiechartVisualization.__proto__ || Object.getPrototypeOf(PiechartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(PiechartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'pieChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      // [ZEPPELIN-2253] New chart function will be created each time inside super.render()\n\t      this.chart = null;\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, true, false, false);\n\t      var d = d3Data.d3g;\n\t\n\t      var generateLabel = void 0;\n\t      // data is grouped\n\t      if (pivot.groups && pivot.groups.length > 0) {\n\t        generateLabel = function generateLabel(suffix, prefix) {\n\t          return prefix + '.' + suffix;\n\t        };\n\t      } else {\n\t        // data isn't grouped\n\t        generateLabel = function generateLabel(suffix) {\n\t          return suffix;\n\t        };\n\t      }\n\t\n\t      var d3g = d.map(function (group) {\n\t        return group.values.map(function (row) {\n\t          return {\n\t            label: generateLabel(row.x, group.key),\n\t            value: row.y\n\t          };\n\t        });\n\t      });\n\t      // the map function returns d3g as a nested array\n\t      // [].concat flattens it, http://stackoverflow.com/a/10865042/5154397\n\t      d3g = [].concat.apply([], d3g);\n\t      _get(PiechartVisualization.prototype.__proto__ || Object.getPrototypeOf(PiechartVisualization.prototype), 'render', this).call(this, { d3g: d3g });\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(PiechartVisualization.prototype.__proto__ || Object.getPrototypeOf(PiechartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      chart.x(function (d) {\n\t        return d.label;\n\t      }).y(function (d) {\n\t        return d.value;\n\t      }).showLabels(false).showTooltipPercent(true);\n\t    }\n\t  }]);\n\t\n\t  return PiechartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = PiechartVisualization;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in area chart\n\t */\n\tvar AreachartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(AreachartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function AreachartVisualization(targetEl, config) {\n\t    _classCallCheck(this, AreachartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (AreachartVisualization.__proto__ || Object.getPrototypeOf(AreachartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    _this.xLables = [];\n\t    return _this;\n\t  }\n\t\n\t  _createClass(AreachartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'stackedAreaChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, false, true, false);\n\t\n\t      this.xLabels = d3Data.xLabels;\n\t      _get(AreachartVisualization.prototype.__proto__ || Object.getPrototypeOf(AreachartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(AreachartVisualization.prototype.__proto__ || Object.getPrototypeOf(AreachartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t      chart.xAxis.tickFormat(function (d) {\n\t        return self.xAxisTickFormat(d, self.xLabels);\n\t      });\n\t      chart.yAxis.tickFormat(function (d) {\n\t        return self.yAxisTickFormat(d);\n\t      });\n\t      chart.yAxis.axisLabelDistance(50);\n\t      chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n\t\n\t      this.chart.style(this.config.style || 'stack');\n\t\n\t      var self = this;\n\t      this.chart.dispatch.on('stateChange', function (s) {\n\t        self.config.style = s.style;\n\t\n\t        // give some time to animation finish\n\t        setTimeout(function () {\n\t          self.emitConfig(self.config);\n\t        }, 500);\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return AreachartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = AreachartVisualization;\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in line chart\n\t */\n\tvar LinechartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(LinechartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function LinechartVisualization(targetEl, config) {\n\t    _classCallCheck(this, LinechartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (LinechartVisualization.__proto__ || Object.getPrototypeOf(LinechartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    _this.xLables = [];\n\t    return _this;\n\t  }\n\t\n\t  _createClass(LinechartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      if (this.config.lineWithFocus) {\n\t        return 'lineWithFocusChart';\n\t      } else {\n\t        return 'lineChart';\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, false, true, false);\n\t\n\t      this.xLabels = d3Data.xLabels;\n\t      _get(LinechartVisualization.prototype.__proto__ || Object.getPrototypeOf(LinechartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(LinechartVisualization.prototype.__proto__ || Object.getPrototypeOf(LinechartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t\n\t      // change mode\n\t      if (this.currentMode !== config.lineWithFocus) {\n\t        _get(LinechartVisualization.prototype.__proto__ || Object.getPrototypeOf(LinechartVisualization.prototype), 'destroy', this).call(this);\n\t        this.currentMode = config.lineWithFocus;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t      chart.xAxis.tickFormat(function (d) {\n\t        return self.xAxisTickFormat(d, self.xLabels);\n\t      });\n\t      chart.yAxis.tickFormat(function (d) {\n\t        return self.yAxisTickFormat(d, self.xLabels);\n\t      });\n\t      chart.yAxis.axisLabelDistance(50);\n\t      if (chart.useInteractiveGuideline) {\n\t        // lineWithFocusChart hasn't got useInteractiveGuideline\n\t        chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n\t      }\n\t      if (this.config.forceY) {\n\t        chart.forceY([0]); // force y-axis minimum to 0 for line chart.\n\t      } else {\n\t        chart.forceY([]);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getSetting',\n\t    value: function getSetting(chart) {\n\t      var self = this;\n\t      var configObj = self.config;\n\t\n\t      return {\n\t        template: '<div>\\n        <label>\\n          <input type=\"checkbox\"\\n               ng-model=\"config.forceY\"\\n               ng-click=\"save()\" />\\n          force Y to 0\\n        </label>\\n        <br/>\\n\\n        <label>\\n          <input type=\"checkbox\"\\n               ng-model=\"config.lineWithFocus\"\\n               ng-click=\"save()\" />\\n          show line chart with focus\\n        </label>\\n      </div>',\n\t        scope: {\n\t          config: configObj,\n\t          save: function save() {\n\t            self.emitConfig(configObj);\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return LinechartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = LinechartVisualization;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _columnselector = __webpack_require__(10);\n\t\n\tvar _columnselector2 = _interopRequireDefault(_columnselector);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in scatter char\n\t */\n\tvar ScatterchartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(ScatterchartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function ScatterchartVisualization(targetEl, config) {\n\t    _classCallCheck(this, ScatterchartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (ScatterchartVisualization.__proto__ || Object.getPrototypeOf(ScatterchartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.columnselectorProps = [{\n\t      name: 'xAxis'\n\t    }, {\n\t      name: 'yAxis'\n\t    }, {\n\t      name: 'group'\n\t    }, {\n\t      name: 'size',\n\t      tooltip: '<li>Size option is valid only when you drop numeric field here.</li>\\n                  <li>When data in each axis are discrete,\\n                  \\'number of values in corresponding coordinate\\' will be used as size.</li>\\n                  <li>Zeppelin consider values as discrete when the values contain string value\\n                  or the number of distinct values are bigger than 5% of total number of values.</li>\\n                  <li>Size field button turns to grey when the option you chose is not valid.</li>'\n\t    }];\n\t    _this.columnselector = new _columnselector2.default(config, _this.columnselectorProps);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(ScatterchartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'scatterChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.columnselector;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(tableData) {\n\t      this.tableData = tableData;\n\t      this.selectDefault();\n\t      var d3Data = this.setScatterChart(tableData, true);\n\t      this.xLabels = d3Data.xLabels;\n\t      this.yLabels = d3Data.yLabels;\n\t\n\t      _get(ScatterchartVisualization.prototype.__proto__ || Object.getPrototypeOf(ScatterchartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t\n\t      chart.xAxis.tickFormat(function (d) {\n\t        // TODO remove round after bump to nvd3 > 1.8.5\n\t        return self.xAxisTickFormat(Math.round(d * 1e3) / 1e3, self.xLabels);\n\t      });\n\t\n\t      chart.yAxis.tickFormat(function (d) {\n\t        // TODO remove round after bump to nvd3 > 1.8.5\n\t        return self.yAxisTickFormat(Math.round(d * 1e3) / 1e3, self.yLabels);\n\t      });\n\t\n\t      chart.showDistX(true).showDistY(true);\n\t      //handle the problem of tooltip not showing when muliple points have same value.\n\t    }\n\t  }, {\n\t    key: 'yAxisTickFormat',\n\t    value: function yAxisTickFormat(d, yLabels) {\n\t      if (yLabels[d] && (isNaN(parseFloat(yLabels[d])) || !isFinite(yLabels[d]))) {\n\t        // to handle string type xlabel\n\t        return yLabels[d];\n\t      } else {\n\t        return _get(ScatterchartVisualization.prototype.__proto__ || Object.getPrototypeOf(ScatterchartVisualization.prototype), 'yAxisTickFormat', this).call(this, d);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'selectDefault',\n\t    value: function selectDefault() {\n\t      if (!this.config.xAxis && !this.config.yAxis) {\n\t        if (this.tableData.columns.length > 1) {\n\t          this.config.xAxis = this.tableData.columns[0];\n\t          this.config.yAxis = this.tableData.columns[1];\n\t        } else if (this.tableData.columns.length === 1) {\n\t          this.config.xAxis = this.tableData.columns[0];\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setScatterChart',\n\t    value: function setScatterChart(data, refresh) {\n\t      var xAxis = this.config.xAxis;\n\t      var yAxis = this.config.yAxis;\n\t      var group = this.config.group;\n\t      var size = this.config.size;\n\t\n\t      var xValues = [];\n\t      var yValues = [];\n\t      var rows = {};\n\t      var d3g = [];\n\t\n\t      var rowNameIndex = {};\n\t      var colNameIndex = {};\n\t      var grpNameIndex = {};\n\t      var rowIndexValue = {};\n\t      var colIndexValue = {};\n\t      var grpIndexValue = {};\n\t      var rowIdx = 0;\n\t      var colIdx = 0;\n\t      var grpIdx = 0;\n\t      var grpName = '';\n\t\n\t      var xValue;\n\t      var yValue;\n\t      var row;\n\t\n\t      if (!xAxis && !yAxis) {\n\t        return {\n\t          d3g: []\n\t        };\n\t      }\n\t\n\t      for (var i = 0; i < data.rows.length; i++) {\n\t        row = data.rows[i];\n\t        if (xAxis) {\n\t          xValue = row[xAxis.index];\n\t          xValues[i] = xValue;\n\t        }\n\t        if (yAxis) {\n\t          yValue = row[yAxis.index];\n\t          yValues[i] = yValue;\n\t        }\n\t      }\n\t\n\t      var isAllDiscrete = xAxis && yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues) || !xAxis && this.isDiscrete(yValues) || !yAxis && this.isDiscrete(xValues);\n\t\n\t      if (isAllDiscrete) {\n\t        rows = this.setDiscreteScatterData(data);\n\t      } else {\n\t        rows = data.rows;\n\t      }\n\t\n\t      if (!group && isAllDiscrete) {\n\t        grpName = 'count';\n\t      } else if (!group && !size) {\n\t        if (xAxis && yAxis) {\n\t          grpName = '(' + xAxis.name + ', ' + yAxis.name + ')';\n\t        } else if (xAxis && !yAxis) {\n\t          grpName = xAxis.name;\n\t        } else if (!xAxis && yAxis) {\n\t          grpName = yAxis.name;\n\t        }\n\t      } else if (!group && size) {\n\t        grpName = size.name;\n\t      }\n\t\n\t      var epsilon = 1e-4; // TODO remove after bump to nvd3 > 1.8.5\n\t\n\t      for (i = 0; i < rows.length; i++) {\n\t        row = rows[i];\n\t        if (xAxis) {\n\t          xValue = row[xAxis.index];\n\t        }\n\t        if (yAxis) {\n\t          yValue = row[yAxis.index];\n\t        }\n\t        if (group) {\n\t          grpName = row[group.index];\n\t        }\n\t        var sz = isAllDiscrete ? row[row.length - 1] : size ? row[size.index] : 1;\n\t\n\t        if (grpNameIndex[grpName] === undefined) {\n\t          grpIndexValue[grpIdx] = grpName;\n\t          grpNameIndex[grpName] = grpIdx++;\n\t        }\n\t\n\t        if (xAxis && rowNameIndex[xValue] === undefined) {\n\t          rowIndexValue[rowIdx] = xValue;\n\t          rowNameIndex[xValue] = rowIdx++;\n\t        }\n\t\n\t        if (yAxis && colNameIndex[yValue] === undefined) {\n\t          colIndexValue[colIdx] = yValue;\n\t          colNameIndex[yValue] = colIdx++;\n\t        }\n\t\n\t        if (!d3g[grpNameIndex[grpName]]) {\n\t          d3g[grpNameIndex[grpName]] = {\n\t            key: grpName,\n\t            values: []\n\t          };\n\t        }\n\t\n\t        // TODO remove epsilon jitter after bump to nvd3 > 1.8.5\n\t        var xval,\n\t            yval = 0;\n\t        if (xAxis) {\n\t          xval = (isNaN(xValue) ? rowNameIndex[xValue] : parseFloat(xValue)) + Math.random() * epsilon;\n\t        }\n\t        if (yAxis) {\n\t          yval = (isNaN(yValue) ? colNameIndex[yValue] : parseFloat(yValue)) + Math.random() * epsilon;\n\t        }\n\t\n\t        d3g[grpNameIndex[grpName]].values.push({\n\t          x: xval,\n\t          y: yval,\n\t          size: isNaN(parseFloat(sz)) ? 1 : parseFloat(sz)\n\t        });\n\t      }\n\t\n\t      // TODO remove sort and dedup after bump to nvd3 > 1.8.5\n\t      var d3gvalues = d3g[grpNameIndex[grpName]].values;\n\t      d3gvalues.sort(function (a, b) {\n\t        return a['x'] - b['x'] || a['y'] - b['y'];\n\t      });\n\t\n\t      for (var i = 0; i < d3gvalues.length - 1;) {\n\t        if (Math.abs(d3gvalues[i]['x'] - d3gvalues[i + 1]['x']) < epsilon && Math.abs(d3gvalues[i]['y'] - d3gvalues[i + 1]['y']) < epsilon) {\n\t          d3gvalues.splice(i + 1, 1);\n\t        } else {\n\t          i++;\n\t        }\n\t      }\n\t\n\t      return {\n\t        xLabels: rowIndexValue,\n\t        yLabels: colIndexValue,\n\t        d3g: d3g\n\t      };\n\t    }\n\t  }, {\n\t    key: 'setDiscreteScatterData',\n\t    value: function setDiscreteScatterData(data) {\n\t      var xAxis = this.config.xAxis;\n\t      var yAxis = this.config.yAxis;\n\t      var group = this.config.group;\n\t\n\t      var xValue;\n\t      var yValue;\n\t      var grp;\n\t\n\t      var rows = {};\n\t\n\t      for (var i = 0; i < data.rows.length; i++) {\n\t        var row = data.rows[i];\n\t        if (xAxis) {\n\t          xValue = row[xAxis.index];\n\t        }\n\t        if (yAxis) {\n\t          yValue = row[yAxis.index];\n\t        }\n\t        if (group) {\n\t          grp = row[group.index];\n\t        }\n\t\n\t        var key = xValue + ',' + yValue + ',' + grp;\n\t\n\t        if (!rows[key]) {\n\t          rows[key] = {\n\t            x: xValue,\n\t            y: yValue,\n\t            group: grp,\n\t            size: 1\n\t          };\n\t        } else {\n\t          rows[key].size++;\n\t        }\n\t      }\n\t\n\t      // change object into array\n\t      var newRows = [];\n\t      for (var r in rows) {\n\t        var newRow = [];\n\t        if (xAxis) {\n\t          newRow[xAxis.index] = rows[r].x;\n\t        }\n\t        if (yAxis) {\n\t          newRow[yAxis.index] = rows[r].y;\n\t        }\n\t        if (group) {\n\t          newRow[group.index] = rows[r].group;\n\t        }\n\t        newRow[data.rows[0].length] = rows[r].size;\n\t        newRows.push(newRow);\n\t      }\n\t      return newRows;\n\t    }\n\t  }, {\n\t    key: 'isDiscrete',\n\t    value: function isDiscrete(field) {\n\t      var getUnique = function getUnique(f) {\n\t        var uniqObj = {};\n\t        var uniqArr = [];\n\t        var j = 0;\n\t        for (var i = 0; i < f.length; i++) {\n\t          var item = f[i];\n\t          if (uniqObj[item] !== 1) {\n\t            uniqObj[item] = 1;\n\t            uniqArr[j++] = item;\n\t          }\n\t        }\n\t        return uniqArr;\n\t      };\n\t\n\t      for (var i = 0; i < field.length; i++) {\n\t        if (isNaN(parseFloat(field[i])) && (typeof field[i] === 'string' || field[i] instanceof String)) {\n\t          return true;\n\t        }\n\t      }\n\t\n\t      var threshold = 0.05;\n\t      var unique = getUnique(field);\n\t      if (unique.length / field.length < threshold) {\n\t        return true;\n\t      } else {\n\t        return false;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'isValidSizeOption',\n\t    value: function isValidSizeOption(options) {\n\t      var xValues = [];\n\t      var yValues = [];\n\t      var rows = this.tableData.rows;\n\t\n\t      for (var i = 0; i < rows.length; i++) {\n\t        var row = rows[i];\n\t        var size = row[options.size.index];\n\t\n\t        //check if the field is numeric\n\t        if (isNaN(parseFloat(size)) || !isFinite(size)) {\n\t          return false;\n\t        }\n\t\n\t        if (options.xAxis) {\n\t          var x = row[options.xAxis.index];\n\t          xValues[i] = x;\n\t        }\n\t        if (options.yAxis) {\n\t          var y = row[options.yAxis.index];\n\t          yValues[i] = y;\n\t        }\n\t      }\n\t\n\t      //check if all existing fields are discrete\n\t      var isAllDiscrete = options.xAxis && options.yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues) || !options.xAxis && this.isDiscrete(yValues) || !options.yAxis && this.isDiscrete(xValues);\n\t\n\t      if (isAllDiscrete) {\n\t        return false;\n\t      }\n\t\n\t      return true;\n\t    }\n\t  }]);\n\t\n\t  return ScatterchartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = ScatterchartVisualization;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('JobmanagerCtrl', JobmanagerCtrl);\n\t\n\tJobmanagerCtrl.$inject = ['$scope', 'websocketMsgSrv', '$interval', 'ngToast', '$q', '$timeout', 'jobManagerFilter'];\n\t\n\tfunction JobmanagerCtrl($scope, websocketMsgSrv, $interval, ngToast, $q, $timeout, jobManagerFilter) {\n\t  ngToast.dismiss();\n\t  var asyncNotebookJobFilter = function asyncNotebookJobFilter(jobInfomations, filterConfig) {\n\t    return $q(function (resolve, reject) {\n\t      $scope.JobInfomationsByFilter = $scope.jobTypeFilter(jobInfomations, filterConfig);\n\t      resolve($scope.JobInfomationsByFilter);\n\t    });\n\t  };\n\t\n\t  $scope.doFiltering = function (jobInfomations, filterConfig) {\n\t    asyncNotebookJobFilter(jobInfomations, filterConfig).then(function () {\n\t      // success\n\t      $scope.isLoadingFilter = false;\n\t    }, function () {\n\t      // failed\n\t    });\n\t  };\n\t\n\t  $scope.filterValueToName = function (filterValue, maxStringLength) {\n\t    if ($scope.activeInterpreters === undefined) {\n\t      return;\n\t    }\n\t    var index = _.findIndex($scope.activeInterpreters, { value: filterValue });\n\t    if ($scope.activeInterpreters[index].name !== undefined) {\n\t      if (maxStringLength !== undefined && maxStringLength > $scope.activeInterpreters[index].name) {\n\t        return $scope.activeInterpreters[index].name.substr(0, maxStringLength - 3) + '...';\n\t      }\n\t      return $scope.activeInterpreters[index].name;\n\t    } else {\n\t      return 'Interpreter is not set';\n\t    }\n\t  };\n\t\n\t  $scope.setFilterValue = function (filterValue) {\n\t    $scope.filterConfig.filterValueInterpreter = filterValue;\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  };\n\t\n\t  $scope.onChangeRunJobToAlwaysTopToggle = function () {\n\t    $scope.filterConfig.isRunningAlwaysTop = !$scope.filterConfig.isRunningAlwaysTop;\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  };\n\t\n\t  $scope.onChangeSortAsc = function () {\n\t    $scope.filterConfig.isSortByAsc = !$scope.filterConfig.isSortByAsc;\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  };\n\t\n\t  $scope.doFilterInputTyping = function (keyEvent, jobInfomations, filterConfig) {\n\t    var RETURN_KEY_CODE = 13;\n\t    $timeout.cancel($scope.dofilterTimeoutObject);\n\t    $scope.isActiveSearchTimer = true;\n\t    $scope.dofilterTimeoutObject = $timeout(function () {\n\t      $scope.doFiltering(jobInfomations, filterConfig);\n\t      $scope.isActiveSearchTimer = false;\n\t    }, 10000);\n\t    if (keyEvent.which === RETURN_KEY_CODE) {\n\t      $timeout.cancel($scope.dofilterTimeoutObject);\n\t      $scope.doFiltering(jobInfomations, filterConfig);\n\t      $scope.isActiveSearchTimer = false;\n\t    }\n\t  };\n\t\n\t  $scope.doForceFilterInputTyping = function (keyEvent, jobInfomations, filterConfig) {\n\t    $timeout.cancel($scope.dofilterTimeoutObject);\n\t    $scope.doFiltering(jobInfomations, filterConfig);\n\t    $scope.isActiveSearchTimer = false;\n\t  };\n\t\n\t  $scope.init = function () {\n\t    $scope.isLoadingFilter = true;\n\t    $scope.jobInfomations = [];\n\t    $scope.JobInfomationsByFilter = $scope.jobInfomations;\n\t    $scope.filterConfig = {\n\t      isRunningAlwaysTop: true,\n\t      filterValueNotebookName: '',\n\t      filterValueInterpreter: '*',\n\t      isSortByAsc: true\n\t    };\n\t    $scope.sortTooltipMsg = 'Switch to sort by desc';\n\t    $scope.jobTypeFilter = jobManagerFilter;\n\t\n\t    websocketMsgSrv.getNoteJobsList();\n\t\n\t    $scope.$watch('filterConfig.isSortByAsc', function (value) {\n\t      if (value) {\n\t        $scope.sortTooltipMsg = 'Switch to sort by desc';\n\t      } else {\n\t        $scope.sortTooltipMsg = 'Switch to sort by asc';\n\t      }\n\t    });\n\t\n\t    $scope.$on('$destroy', function () {\n\t      websocketMsgSrv.unsubscribeJobManager();\n\t    });\n\t  };\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteJobs', function (event, responseData) {\n\t    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n\t    $scope.jobInfomations = responseData.jobs;\n\t    $scope.jobInfomationsIndexs = $scope.jobInfomations ? _.indexBy($scope.jobInfomations, 'noteId') : {};\n\t    $scope.jobTypeFilter($scope.jobInfomations, $scope.filterConfig);\n\t    $scope.activeInterpreters = [{\n\t      name: 'ALL',\n\t      value: '*'\n\t    }];\n\t    var interpreterLists = _.uniq(_.pluck($scope.jobInfomations, 'interpreter'), false);\n\t    for (var index = 0, length = interpreterLists.length; index < length; index++) {\n\t      $scope.activeInterpreters.push({\n\t        name: interpreterLists[index],\n\t        value: interpreterLists[index]\n\t      });\n\t    }\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  });\n\t\n\t  $scope.$on('setUpdateNoteJobs', function (event, responseData) {\n\t    var jobInfomations = $scope.jobInfomations;\n\t    var indexStore = $scope.jobInfomationsIndexs;\n\t    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n\t    var notes = responseData.jobs;\n\t    notes.map(function (changedItem) {\n\t      if (indexStore[changedItem.noteId] === undefined) {\n\t        var newItem = angular.copy(changedItem);\n\t        jobInfomations.push(newItem);\n\t        indexStore[changedItem.noteId] = newItem;\n\t      } else {\n\t        var changeOriginTarget = indexStore[changedItem.noteId];\n\t\n\t        if (changedItem.isRemoved !== undefined && changedItem.isRemoved === true) {\n\t\n\t          // remove Item.\n\t          var removeIndex = _.findIndex(indexStore, changedItem.noteId);\n\t          if (removeIndex > -1) {\n\t            indexStore.splice(removeIndex, 1);\n\t          }\n\t\n\t          removeIndex = _.findIndex(jobInfomations, { 'noteId': changedItem.noteId });\n\t          if (removeIndex) {\n\t            jobInfomations.splice(removeIndex, 1);\n\t          }\n\t        } else {\n\t          // change value for item.\n\t          changeOriginTarget.isRunningJob = changedItem.isRunningJob;\n\t          changeOriginTarget.noteName = changedItem.noteName;\n\t          changeOriginTarget.noteType = changedItem.noteType;\n\t          changeOriginTarget.interpreter = changedItem.interpreter;\n\t          changeOriginTarget.unixTimeLastRun = changedItem.unixTimeLastRun;\n\t          changeOriginTarget.paragraphs = changedItem.paragraphs;\n\t        }\n\t      }\n\t    });\n\t    $scope.doFiltering(jobInfomations, $scope.filterConfig);\n\t  });\n\t}\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('JobCtrl', JobCtrl);\n\t\n\tJobCtrl.$inject = ['$scope', '$http', 'baseUrlSrv'];\n\t\n\tfunction JobCtrl($scope, $http, baseUrlSrv) {\n\t  $scope.init = function (jobInformation) {\n\t    $scope.progressValue = 0;\n\t  };\n\t\n\t  $scope.getProgress = function () {\n\t    var statusList = _.pluck($scope.notebookJob.paragraphs, 'status');\n\t    var runningJob = _.countBy(statusList, function (status) {\n\t      if (status === 'FINISHED' || status === 'RUNNING') {\n\t        return 'matchCount';\n\t      } else {\n\t        return 'none';\n\t      }\n\t    });\n\t    var totalCount = statusList.length;\n\t    var runningJobCount = runningJob.matchCount;\n\t    var result = Math.ceil(runningJobCount / totalCount * 100);\n\t    return isNaN(result) ? 0 : result;\n\t  };\n\t\n\t  $scope.runNotebookJob = function (notebookId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Run all paragraphs?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http({\n\t            method: 'POST',\n\t            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n\t            headers: {\n\t              'Content-Type': 'application/x-www-form-urlencoded'\n\t            }\n\t          }).then(function successCallback(response) {\n\t            // success\n\t          }, function errorCallback(errorResponse) {\n\t            var errorText = 'SERVER ERROR';\n\t            if (!!errorResponse.data.message) {\n\t              errorText = errorResponse.data.message;\n\t            }\n\t            BootstrapDialog.alert({\n\t              closable: true,\n\t              title: 'Execution Failure',\n\t              message: errorText\n\t            });\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.stopNotebookJob = function (notebookId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Stop all paragraphs?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http({\n\t            method: 'DELETE',\n\t            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n\t            headers: {\n\t              'Content-Type': 'application/x-www-form-urlencoded'\n\t            }\n\t          }).then(function successCallback(response) {\n\t            // success\n\t          }, function errorCallback(errorResponse) {\n\t            var errorText = 'SERVER ERROR';\n\t            if (!!errorResponse.data.message) {\n\t\n\t              errorText = errorResponse.data.message;\n\t            }\n\t            BootstrapDialog.alert({\n\t              closable: true,\n\t              title: 'Stop Failure',\n\t              message: errorText\n\t            });\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.lastExecuteTime = function (unixtime) {\n\t    return moment.unix(unixtime / 1000).fromNow();\n\t  };\n\t}\n\n/***/ },\n/* 21 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').filter('jobManager', jobManagerFilter);\n\t\n\tfunction jobManagerFilter() {\n\t  function filterContext(jobItems, filterConfig) {\n\t    var filterValueInterpreter = filterConfig.filterValueInterpreter;\n\t    var filterValueNotebookName = filterConfig.filterValueNotebookName;\n\t    var isSortByAsc = filterConfig.isSortByAsc;\n\t    var filterItems = jobItems;\n\t\n\t    if (filterValueInterpreter === undefined) {\n\t      filterItems = _.filter(filterItems, function (jobItem) {\n\t        return jobItem.interpreter === undefined ? true : false;\n\t      });\n\t    } else if (filterValueInterpreter !== '*') {\n\t      filterItems = _.where(filterItems, { interpreter: filterValueInterpreter });\n\t    }\n\t\n\t    if (filterValueNotebookName !== '') {\n\t      filterItems = _.filter(filterItems, function (jobItem) {\n\t        var lowerFilterValue = filterValueNotebookName.toLocaleLowerCase();\n\t        var lowerNotebookName = jobItem.noteName.toLocaleLowerCase();\n\t        return lowerNotebookName.match(new RegExp('.*' + lowerFilterValue + '.*'));\n\t      });\n\t    }\n\t\n\t    filterItems = _.sortBy(filterItems, function (sortItem) {\n\t      return sortItem.noteName.toLowerCase();\n\t    });\n\t\n\t    return isSortByAsc ? filterItems : filterItems.reverse();\n\t  }\n\t  return filterContext;\n\t}\n\n/***/ },\n/* 22 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('InterpreterCtrl', InterpreterCtrl);\n\t\n\tInterpreterCtrl.$inject = ['$rootScope', '$scope', '$http', 'baseUrlSrv', 'ngToast', '$timeout', '$route'];\n\t\n\tfunction InterpreterCtrl($rootScope, $scope, $http, baseUrlSrv, ngToast, $timeout, $route) {\n\t  var interpreterSettingsTmp = [];\n\t  $scope.interpreterSettings = [];\n\t  $scope.availableInterpreters = {};\n\t  $scope.showAddNewSetting = false;\n\t  $scope.showRepositoryInfo = false;\n\t  $scope.searchInterpreter = '';\n\t  $scope._ = _;\n\t  ngToast.dismiss();\n\t\n\t  $scope.openPermissions = function () {\n\t    $scope.showInterpreterAuth = true;\n\t  };\n\t\n\t  $scope.closePermissions = function () {\n\t    $scope.showInterpreterAuth = false;\n\t  };\n\t\n\t  var getSelectJson = function getSelectJson() {\n\t    var selectJson = {\n\t      tags: false,\n\t      multiple: true,\n\t      tokenSeparators: [',', ' '],\n\t      minimumInputLength: 2,\n\t      ajax: {\n\t        url: function url(params) {\n\t          if (!params.term) {\n\t            return false;\n\t          }\n\t          return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n\t        },\n\t        delay: 250,\n\t        processResults: function processResults(data, params) {\n\t          var users = [];\n\t          if (data.body.users.length !== 0) {\n\t            for (var i = 0; i < data.body.users.length; i++) {\n\t              users.push({\n\t                'id': data.body.users[i],\n\t                'text': data.body.users[i]\n\t              });\n\t            }\n\t          }\n\t          return {\n\t            results: users,\n\t            pagination: {\n\t              more: false\n\t            }\n\t          };\n\t        },\n\t        cache: false\n\t      }\n\t    };\n\t    return selectJson;\n\t  };\n\t\n\t  $scope.togglePermissions = function (intpName) {\n\t    angular.element('#' + intpName + 'Users').select2(getSelectJson());\n\t    if ($scope.showInterpreterAuth) {\n\t      $scope.closePermissions();\n\t    } else {\n\t      $scope.openPermissions();\n\t    }\n\t  };\n\t\n\t  $scope.$on('ngRenderFinished', function (event, data) {\n\t    for (var setting = 0; setting < $scope.interpreterSettings.length; setting++) {\n\t      angular.element('#' + $scope.interpreterSettings[setting].name + 'Users').select2(getSelectJson());\n\t    }\n\t  });\n\t\n\t  var getInterpreterSettings = function getInterpreterSettings() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting').success(function (data, status, headers, config) {\n\t      $scope.interpreterSettings = data.body;\n\t      checkDownloadingDependencies();\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var checkDownloadingDependencies = function checkDownloadingDependencies() {\n\t    var isDownloading = false;\n\t    for (var index = 0; index < $scope.interpreterSettings.length; index++) {\n\t      var setting = $scope.interpreterSettings[index];\n\t      if (setting.status === 'DOWNLOADING_DEPENDENCIES') {\n\t        isDownloading = true;\n\t      }\n\t\n\t      if (setting.status === 'ERROR' || setting.errorReason) {\n\t        ngToast.danger({ content: 'Error setting properties for interpreter \\'' + setting.group + '.' + setting.name + '\\': ' + setting.errorReason,\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    }\n\t\n\t    if (isDownloading) {\n\t      $timeout(function () {\n\t        if ($route.current.$$route.originalPath === '/interpreter') {\n\t          getInterpreterSettings();\n\t        }\n\t      }, 2000);\n\t    }\n\t  };\n\t\n\t  var getAvailableInterpreters = function getAvailableInterpreters() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter').success(function (data, status, headers, config) {\n\t      $scope.availableInterpreters = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var emptyNewProperty = function emptyNewProperty(object) {\n\t    angular.extend(object, { propertyValue: '', propertyKey: '' });\n\t  };\n\t\n\t  var emptyNewDependency = function emptyNewDependency(object) {\n\t    angular.extend(object, { depArtifact: '', depExclude: '' });\n\t  };\n\t\n\t  var removeTMPSettings = function removeTMPSettings(index) {\n\t    interpreterSettingsTmp.splice(index, 1);\n\t  };\n\t\n\t  $scope.copyOriginInterpreterSettingProperties = function (settingId) {\n\t    var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t    interpreterSettingsTmp[index] = angular.copy($scope.interpreterSettings[index]);\n\t  };\n\t\n\t  $scope.setPerNoteOption = function (settingId, sessionOption) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (sessionOption === 'isolated') {\n\t      option.perNote = sessionOption;\n\t      option.session = false;\n\t      option.process = true;\n\t    } else if (sessionOption === 'scoped') {\n\t      option.perNote = sessionOption;\n\t      option.session = true;\n\t      option.process = false;\n\t    } else {\n\t      option.perNote = 'shared';\n\t      option.session = false;\n\t      option.process = false;\n\t    }\n\t  };\n\t\n\t  $scope.setPerUserOption = function (settingId, sessionOption) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (sessionOption === 'isolated') {\n\t      option.perUser = sessionOption;\n\t      option.session = false;\n\t      option.process = true;\n\t    } else if (sessionOption === 'scoped') {\n\t      option.perUser = sessionOption;\n\t      option.session = true;\n\t      option.process = false;\n\t    } else {\n\t      option.perUser = 'shared';\n\t      option.session = false;\n\t      option.process = false;\n\t    }\n\t  };\n\t\n\t  $scope.getPerNoteOption = function (settingId) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (option.perNote === 'scoped') {\n\t      return 'scoped';\n\t    } else if (option.perNote === 'isolated') {\n\t      return 'isolated';\n\t    } else {\n\t      return 'shared';\n\t    }\n\t  };\n\t\n\t  $scope.getPerUserOption = function (settingId) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (option.perUser === 'scoped') {\n\t      return 'scoped';\n\t    } else if (option.perUser === 'isolated') {\n\t      return 'isolated';\n\t    } else {\n\t      return 'shared';\n\t    }\n\t  };\n\t\n\t  $scope.getInterpreterRunningOption = function (settingId) {\n\t    var sharedModeName = 'shared';\n\t\n\t    var globallyModeName = 'Globally';\n\t    var perNoteModeName = 'Per Note';\n\t    var perUserModeName = 'Per User';\n\t\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    var perNote = option.perNote;\n\t    var perUser = option.perUser;\n\t\n\t    // Globally == shared_perNote + shared_perUser\n\t    if (perNote === sharedModeName && perUser === sharedModeName) {\n\t      return globallyModeName;\n\t    }\n\t\n\t    if ($rootScope.ticket.ticket === 'anonymous' && $rootScope.ticket.roles === '[]') {\n\t      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n\t        return perNoteModeName;\n\t      }\n\t    } else if ($rootScope.ticket.ticket !== 'anonymous') {\n\t      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n\t        if (perUser !== undefined && typeof perUser === 'string' && perUser !== '') {\n\t          return perUserModeName;\n\t        }\n\t        return perNoteModeName;\n\t      }\n\t    }\n\t\n\t    option.perNote = sharedModeName;\n\t    option.perUser = sharedModeName;\n\t    return globallyModeName;\n\t  };\n\t\n\t  $scope.setInterpreterRunningOption = function (settingId, isPerNoteMode, isPerUserMode) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t    option.perNote = isPerNoteMode;\n\t    option.perUser = isPerUserMode;\n\t  };\n\t\n\t  $scope.updateInterpreterSetting = function (form, settingId) {\n\t    var thisConfirm = BootstrapDialog.confirm({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: '',\n\t      message: 'Do you want to update this interpreter and restart with new settings?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t          var setting = $scope.interpreterSettings[index];\n\t          if (setting.propertyKey !== '' || setting.propertyKey) {\n\t            $scope.addNewInterpreterProperty(settingId);\n\t          }\n\t          if (setting.depArtifact !== '' || setting.depArtifact) {\n\t            $scope.addNewInterpreterDependency(settingId);\n\t          }\n\t          // add missing field of option\n\t          if (!setting.option) {\n\t            setting.option = {};\n\t          }\n\t          if (setting.option.isExistingProcess === undefined) {\n\t            setting.option.isExistingProcess = false;\n\t          }\n\t          if (setting.option.setPermission === undefined) {\n\t            setting.option.setPermission = false;\n\t          }\n\t          if (setting.option.isUserImpersonate === undefined) {\n\t            setting.option.isUserImpersonate = false;\n\t          }\n\t          if (!($scope.getInterpreterRunningOption(settingId) === 'Per User' && $scope.getPerUserOption(settingId) === 'isolated')) {\n\t            setting.option.isUserImpersonate = false;\n\t          }\n\t          if (setting.option.remote === undefined) {\n\t            // remote always true for now\n\t            setting.option.remote = true;\n\t          }\n\t          setting.option.users = angular.element('#' + setting.name + 'Users').val();\n\t\n\t          var request = {\n\t            option: angular.copy(setting.option),\n\t            properties: angular.copy(setting.properties),\n\t            dependencies: angular.copy(setting.dependencies)\n\t          };\n\t\n\t          thisConfirm.$modalFooter.find('button').addClass('disabled');\n\t          thisConfirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\t\n\t          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId, request).success(function (data, status, headers, config) {\n\t            $scope.interpreterSettings[index] = data.body;\n\t            removeTMPSettings(index);\n\t            checkDownloadingDependencies();\n\t            thisConfirm.close();\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t            ngToast.danger({ content: data.message, verticalPosition: 'bottom' });\n\t            form.$show();\n\t            thisConfirm.close();\n\t          });\n\t          return false;\n\t        } else {\n\t          form.$show();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.resetInterpreterSetting = function (settingId) {\n\t    var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t\n\t    // Set the old settings back\n\t    $scope.interpreterSettings[index] = angular.copy(interpreterSettingsTmp[index]);\n\t    removeTMPSettings(index);\n\t  };\n\t\n\t  $scope.removeInterpreterSetting = function (settingId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to delete this interpreter setting?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId).success(function (data, status, headers, config) {\n\t\n\t            var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t            $scope.interpreterSettings.splice(index, 1);\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.newInterpreterGroupChange = function () {\n\t    var el = _.pluck(_.filter($scope.availableInterpreters, { 'name': $scope.newInterpreterSetting.group }), 'properties');\n\t    var properties = {};\n\t    for (var i = 0; i < el.length; i++) {\n\t      var intpInfo = el[i];\n\t      for (var key in intpInfo) {\n\t        properties[key] = {\n\t          value: intpInfo[key].defaultValue,\n\t          description: intpInfo[key].description\n\t        };\n\t      }\n\t    }\n\t    $scope.newInterpreterSetting.properties = properties;\n\t  };\n\t\n\t  $scope.restartInterpreterSetting = function (settingId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to restart this interpreter?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + settingId).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t            $scope.interpreterSettings[index] = data.body;\n\t            ngToast.info('Interpreter stopped. Will be lazily started on next run.');\n\t          }).error(function (data, status, headers, config) {\n\t            var errorMsg = data !== null ? data.message : 'Could not connect to server.';\n\t            console.log('Error %o %o', status, errorMsg);\n\t            ngToast.danger(errorMsg);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.addNewInterpreterSetting = function () {\n\t    //user input validation on interpreter creation\n\t    if (!$scope.newInterpreterSetting.name || !$scope.newInterpreterSetting.name.trim() || !$scope.newInterpreterSetting.group) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        title: 'Add interpreter',\n\t        message: 'Please fill in interpreter name and choose a group'\n\t      });\n\t      return;\n\t    }\n\t\n\t    if ($scope.newInterpreterSetting.name.indexOf('.') >= 0) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        title: 'Add interpreter',\n\t        message: '\\'.\\' is invalid for interpreter name'\n\t      });\n\t      return;\n\t    }\n\t\n\t    if (_.findIndex($scope.interpreterSettings, { 'name': $scope.newInterpreterSetting.name }) >= 0) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        title: 'Add interpreter',\n\t        message: 'Name ' + $scope.newInterpreterSetting.name + ' already exists'\n\t      });\n\t      return;\n\t    }\n\t\n\t    var newSetting = $scope.newInterpreterSetting;\n\t    if (newSetting.propertyKey !== '' || newSetting.propertyKey) {\n\t      $scope.addNewInterpreterProperty();\n\t    }\n\t    if (newSetting.depArtifact !== '' || newSetting.depArtifact) {\n\t      $scope.addNewInterpreterDependency();\n\t    }\n\t    if (newSetting.option.setPermission === undefined) {\n\t      newSetting.option.setPermission = false;\n\t    }\n\t    newSetting.option.users = angular.element('#newInterpreterUsers').val();\n\t\n\t    var request = angular.copy($scope.newInterpreterSetting);\n\t\n\t    // Change properties to proper request format\n\t    var newProperties = {};\n\t    for (var p in newSetting.properties) {\n\t      newProperties[p] = newSetting.properties[p].value;\n\t    }\n\t    request.properties = newProperties;\n\t\n\t    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/setting', request).success(function (data, status, headers, config) {\n\t      $scope.resetNewInterpreterSetting();\n\t      getInterpreterSettings();\n\t      $scope.showAddNewSetting = false;\n\t      checkDownloadingDependencies();\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t      ngToast.danger({ content: data.message, verticalPosition: 'bottom' });\n\t    });\n\t  };\n\t\n\t  $scope.cancelInterpreterSetting = function () {\n\t    $scope.showAddNewSetting = false;\n\t    $scope.resetNewInterpreterSetting();\n\t  };\n\t\n\t  $scope.resetNewInterpreterSetting = function () {\n\t    $scope.newInterpreterSetting = {\n\t      name: undefined,\n\t      group: undefined,\n\t      properties: {},\n\t      dependencies: [],\n\t      option: {\n\t        remote: true,\n\t        isExistingProcess: false,\n\t        setPermission: false,\n\t        session: false,\n\t        process: false\n\t\n\t      }\n\t    };\n\t    emptyNewProperty($scope.newInterpreterSetting);\n\t  };\n\t\n\t  $scope.removeInterpreterProperty = function (key, settingId) {\n\t    if (settingId === undefined) {\n\t      delete $scope.newInterpreterSetting.properties[key];\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      delete $scope.interpreterSettings[index].properties[key];\n\t    }\n\t  };\n\t\n\t  $scope.removeInterpreterDependency = function (artifact, settingId) {\n\t    if (settingId === undefined) {\n\t      $scope.newInterpreterSetting.dependencies = _.reject($scope.newInterpreterSetting.dependencies, function (el) {\n\t        return el.groupArtifactVersion === artifact;\n\t      });\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      $scope.interpreterSettings[index].dependencies = _.reject($scope.interpreterSettings[index].dependencies, function (el) {\n\t        return el.groupArtifactVersion === artifact;\n\t      });\n\t    }\n\t  };\n\t\n\t  $scope.addNewInterpreterProperty = function (settingId) {\n\t    if (settingId === undefined) {\n\t      // Add new property from create form\n\t      if (!$scope.newInterpreterSetting.propertyKey || $scope.newInterpreterSetting.propertyKey === '') {\n\t        return;\n\t      }\n\t\n\t      $scope.newInterpreterSetting.properties[$scope.newInterpreterSetting.propertyKey] = {\n\t        value: $scope.newInterpreterSetting.propertyValue\n\t      };\n\t      emptyNewProperty($scope.newInterpreterSetting);\n\t    } else {\n\t      // Add new property from edit form\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t\n\t      if (!setting.propertyKey || setting.propertyKey === '') {\n\t        return;\n\t      }\n\t      setting.properties[setting.propertyKey] = setting.propertyValue;\n\t      emptyNewProperty(setting);\n\t    }\n\t  };\n\t\n\t  $scope.addNewInterpreterDependency = function (settingId) {\n\t    if (settingId === undefined) {\n\t      // Add new dependency from create form\n\t      if (!$scope.newInterpreterSetting.depArtifact || $scope.newInterpreterSetting.depArtifact === '') {\n\t        return;\n\t      }\n\t\n\t      // overwrite if artifact already exists\n\t      var newSetting = $scope.newInterpreterSetting;\n\t      for (var d in newSetting.dependencies) {\n\t        if (newSetting.dependencies[d].groupArtifactVersion === newSetting.depArtifact) {\n\t          newSetting.dependencies[d] = {\n\t            'groupArtifactVersion': newSetting.depArtifact,\n\t            'exclusions': newSetting.depExclude\n\t          };\n\t          newSetting.dependencies.splice(d, 1);\n\t        }\n\t      }\n\t\n\t      newSetting.dependencies.push({\n\t        'groupArtifactVersion': newSetting.depArtifact,\n\t        'exclusions': newSetting.depExclude === '' ? [] : newSetting.depExclude\n\t      });\n\t      emptyNewDependency(newSetting);\n\t    } else {\n\t      // Add new dependency from edit form\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      if (!setting.depArtifact || setting.depArtifact === '') {\n\t        return;\n\t      }\n\t\n\t      // overwrite if artifact already exists\n\t      for (var dep in setting.dependencies) {\n\t        if (setting.dependencies[dep].groupArtifactVersion === setting.depArtifact) {\n\t          setting.dependencies[dep] = {\n\t            'groupArtifactVersion': setting.depArtifact,\n\t            'exclusions': setting.depExclude\n\t          };\n\t          setting.dependencies.splice(dep, 1);\n\t        }\n\t      }\n\t\n\t      setting.dependencies.push({\n\t        'groupArtifactVersion': setting.depArtifact,\n\t        'exclusions': setting.depExclude === '' ? [] : setting.depExclude\n\t      });\n\t      emptyNewDependency(setting);\n\t    }\n\t  };\n\t\n\t  $scope.resetNewRepositorySetting = function () {\n\t    $scope.newRepoSetting = {\n\t      id: '',\n\t      url: '',\n\t      snapshot: false,\n\t      username: '',\n\t      password: '',\n\t      proxyProtocol: 'HTTP',\n\t      proxyHost: '',\n\t      proxyPort: null,\n\t      proxyLogin: '',\n\t      proxyPassword: ''\n\t    };\n\t  };\n\t\n\t  var getRepositories = function getRepositories() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/repository').success(function (data, status, headers, config) {\n\t      $scope.repositories = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  $scope.addNewRepository = function () {\n\t    var request = angular.copy($scope.newRepoSetting);\n\t\n\t    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/repository', request).success(function (data, status, headers, config) {\n\t      getRepositories();\n\t      $scope.resetNewRepositorySetting();\n\t      angular.element('#repoModal').modal('hide');\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', headers, config);\n\t    });\n\t  };\n\t\n\t  $scope.removeRepository = function (repoId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to delete this repository?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/repository/' + repoId).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.repositories, { 'id': repoId });\n\t            $scope.repositories.splice(index, 1);\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.isDefaultRepository = function (repoId) {\n\t    if (repoId === 'central' || repoId === 'local') {\n\t      return true;\n\t    } else {\n\t      return false;\n\t    }\n\t  };\n\t\n\t  $scope.showErrorMessage = function (setting) {\n\t    BootstrapDialog.show({\n\t      title: 'Error downloading dependencies',\n\t      message: setting.errorReason\n\t    });\n\t  };\n\t\n\t  var init = function init() {\n\t    $scope.resetNewInterpreterSetting();\n\t    $scope.resetNewRepositorySetting();\n\t\n\t    getInterpreterSettings();\n\t    getAvailableInterpreters();\n\t    getRepositories();\n\t  };\n\t\n\t  $scope.showSparkUI = function (settingId) {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/getmetainfos/' + settingId + '?propName=url').success(function (data, status, headers, config) {\n\t      var url = data.body.url;\n\t      if (!url) {\n\t        BootstrapDialog.alert({\n\t          message: 'No spark application running'\n\t        });\n\t        return;\n\t      }\n\t      window.open(url, '_blank');\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  init();\n\t}\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').filter('sortByKey', sortByKey);\n\t\n\tfunction sortByKey() {\n\t  return function (properties) {\n\t    var sortedKeys = properties ? Object.keys(properties) : [];\n\t    return sortedKeys.sort();\n\t  };\n\t}\n\n/***/ },\n/* 24 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('CredentialCtrl', CredentialCtrl);\n\t\n\tCredentialCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\t\n\tfunction CredentialCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n\t  $scope._ = _;\n\t  ngToast.dismiss();\n\t\n\t  $scope.credentialInfo = [];\n\t  $scope.showAddNewCredentialInfo = false;\n\t  $scope.availableInterpreters = [];\n\t\n\t  var getCredentialInfo = function getCredentialInfo() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/credential').success(function (data, status, headers, config) {\n\t      $scope.credentialInfo = _.map(data.body.userCredentials, function (value, prop) {\n\t        return { entity: prop, password: value.password, username: value.username };\n\t      });\n\t      console.log('Success %o %o', status, $scope.credentialInfo);\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  $scope.addNewCredentialInfo = function () {\n\t    if ($scope.entity && _.isEmpty($scope.entity.trim()) && $scope.username && _.isEmpty($scope.username.trim())) {\n\t      ngToast.danger({\n\t        content: 'Username \\\\ Entity can not be empty.',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      return;\n\t    }\n\t\n\t    var newCredential = {\n\t      'entity': $scope.entity,\n\t      'username': $scope.username,\n\t      'password': $scope.password\n\t    };\n\t\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/credential', newCredential).success(function (data, status, headers, config) {\n\t      ngToast.success({\n\t        content: 'Successfully saved credentials.',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      $scope.credentialInfo.push(newCredential);\n\t      resetCredentialInfo();\n\t      $scope.showAddNewCredentialInfo = false;\n\t      console.log('Success %o %o', status, data.message);\n\t    }).error(function (data, status, headers, config) {\n\t      ngToast.danger({\n\t        content: 'Error saving credentials',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var getAvailableInterpreters = function getAvailableInterpreters() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting').success(function (data, status, headers, config) {\n\t      for (var setting = 0; setting < data.body.length; setting++) {\n\t        $scope.availableInterpreters.push(data.body[setting].group + '.' + data.body[setting].name);\n\t      }\n\t      angular.element('#entityname').autocomplete({\n\t        source: $scope.availableInterpreters,\n\t        select: function select(event, selected) {\n\t          $scope.entity = selected.item.value;\n\t          return false;\n\t        }\n\t      });\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  $scope.toggleAddNewCredentialInfo = function () {\n\t    if ($scope.showAddNewCredentialInfo) {\n\t      $scope.showAddNewCredentialInfo = false;\n\t    } else {\n\t      $scope.showAddNewCredentialInfo = true;\n\t    }\n\t  };\n\t\n\t  $scope.cancelCredentialInfo = function () {\n\t    $scope.showAddNewCredentialInfo = false;\n\t    resetCredentialInfo();\n\t  };\n\t\n\t  var resetCredentialInfo = function resetCredentialInfo() {\n\t    $scope.entity = '';\n\t    $scope.username = '';\n\t    $scope.password = '';\n\t  };\n\t\n\t  $scope.copyOriginCredentialsInfo = function () {\n\t    ngToast.info({\n\t      content: 'Since entity is a unique key, you can edit only username & password',\n\t      verticalPosition: 'bottom',\n\t      timeout: '3000'\n\t    });\n\t  };\n\t\n\t  $scope.updateCredentialInfo = function (form, data, entity) {\n\t    var request = {\n\t      entity: entity,\n\t      username: data.username,\n\t      password: data.password\n\t    };\n\t\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/credential/', request).success(function (data, status, headers, config) {\n\t      var index = _.findIndex($scope.credentialInfo, { 'entity': entity });\n\t      $scope.credentialInfo[index] = request;\n\t      return true;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t      ngToast.danger({\n\t        content: 'We couldn\\'t save the credential',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      form.$show();\n\t    });\n\t    return false;\n\t  };\n\t\n\t  $scope.removeCredentialInfo = function (entity) {\n\t    BootstrapDialog.confirm({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: '',\n\t      message: 'Do you want to delete this credential information?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.delete(baseUrlSrv.getRestApiBase() + '/credential/' + entity).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.credentialInfo, { 'entity': entity });\n\t            $scope.credentialInfo.splice(index, 1);\n\t            console.log('Success %o %o', status, data.message);\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  var init = function init() {\n\t    getAvailableInterpreters();\n\t    getCredentialInfo();\n\t  };\n\t\n\t  init();\n\t}\n\n/***/ },\n/* 25 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('ConfigurationCtrl', ConfigurationCtrl);\n\t\n\tConfigurationCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\t\n\tfunction ConfigurationCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n\t  $scope.configrations = [];\n\t  $scope._ = _;\n\t  ngToast.dismiss();\n\t\n\t  var getConfigurations = function getConfigurations() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/configurations/all').success(function (data, status, headers, config) {\n\t      $scope.configurations = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var init = function init() {\n\t    getConfigurations();\n\t  };\n\t\n\t  init();\n\t}\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('ParagraphCtrl', ParagraphCtrl);\n\t\n\tParagraphCtrl.$inject = ['$scope', '$rootScope', '$route', '$window', '$routeParams', '$location', '$timeout', '$compile', '$http', '$q', 'websocketMsgSrv', 'baseUrlSrv', 'ngToast', 'saveAsService', 'noteVarShareService'];\n\t\n\tfunction ParagraphCtrl($scope, $rootScope, $route, $window, $routeParams, $location, $timeout, $compile, $http, $q, websocketMsgSrv, baseUrlSrv, ngToast, saveAsService, noteVarShareService) {\n\t  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n\t  $rootScope.keys = Object.keys;\n\t  $scope.parentNote = null;\n\t  $scope.paragraph = null;\n\t  $scope.originalText = '';\n\t  $scope.editor = null;\n\t\n\t  var editorSetting = {};\n\t  // flag that is used to set editor setting on paste percent sign\n\t  var pastePercentSign = false;\n\t  // flag that is used to set editor setting on save interpreter bindings\n\t  var setInterpreterBindings = false;\n\t  var paragraphScope = $rootScope.$new(true, $rootScope);\n\t\n\t  // to keep backward compatibility\n\t  $scope.compiledScope = paragraphScope;\n\t\n\t  paragraphScope.z = {\n\t    // z.runParagraph('20150213-231621_168813393')\n\t    runParagraph: function runParagraph(paragraphId) {\n\t      if (paragraphId) {\n\t        var filtered = $scope.parentNote.paragraphs.filter(function (x) {\n\t          return x.id === paragraphId;\n\t        });\n\t        if (filtered.length === 1) {\n\t          var paragraph = filtered[0];\n\t          websocketMsgSrv.runParagraph(paragraph.id, paragraph.title, paragraph.text, paragraph.config, paragraph.settings.params);\n\t        } else {\n\t          ngToast.danger({ content: 'Cannot find a paragraph with id \\'' + paragraphId + '\\'',\n\t            verticalPosition: 'top', dismissOnTimeout: false });\n\t        }\n\t      } else {\n\t        ngToast.danger({\n\t          content: 'Please provide a \\'paragraphId\\' when calling z.runParagraph(paragraphId)',\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    },\n\t\n\t    // Example: z.angularBind('my_var', 'Test Value', '20150213-231621_168813393')\n\t    angularBind: function angularBind(varName, value, paragraphId) {\n\t      // Only push to server if there paragraphId is defined\n\t      if (paragraphId) {\n\t        websocketMsgSrv.clientBindAngularObject($routeParams.noteId, varName, value, paragraphId);\n\t      } else {\n\t        ngToast.danger({\n\t          content: 'Please provide a \\'paragraphId\\' when calling ' + 'z.angularBind(varName, value, \\'PUT_HERE_PARAGRAPH_ID\\')',\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    },\n\t\n\t    // Example: z.angularUnBind('my_var', '20150213-231621_168813393')\n\t    angularUnbind: function angularUnbind(varName, paragraphId) {\n\t      // Only push to server if paragraphId is defined\n\t      if (paragraphId) {\n\t        websocketMsgSrv.clientUnbindAngularObject($routeParams.noteId, varName, paragraphId);\n\t      } else {\n\t        ngToast.danger({\n\t          content: 'Please provide a \\'paragraphId\\' when calling ' + 'z.angularUnbind(varName, \\'PUT_HERE_PARAGRAPH_ID\\')',\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    }\n\t  };\n\t\n\t  var angularObjectRegistry = {};\n\t\n\t  // Controller init\n\t  $scope.init = function (newParagraph, note) {\n\t    $scope.paragraph = newParagraph;\n\t    $scope.parentNote = note;\n\t    $scope.originalText = angular.copy(newParagraph.text);\n\t    $scope.chart = {};\n\t    $scope.baseMapOption = ['Streets', 'Satellite', 'Hybrid', 'Topo', 'Gray', 'Oceans', 'Terrain'];\n\t    $scope.colWidthOption = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n\t    $scope.paragraphFocused = false;\n\t    if (newParagraph.focus) {\n\t      $scope.paragraphFocused = true;\n\t    }\n\t    if (!$scope.paragraph.config) {\n\t      $scope.paragraph.config = {};\n\t    }\n\t\n\t    noteVarShareService.put($scope.paragraph.id + '_paragraphScope', paragraphScope);\n\t\n\t    initializeDefault($scope.paragraph.config);\n\t  };\n\t\n\t  var initializeDefault = function initializeDefault(config) {\n\t    var forms = $scope.paragraph.settings.forms;\n\t\n\t    if (!config.colWidth) {\n\t      config.colWidth = 12;\n\t    }\n\t\n\t    if (config.enabled === undefined) {\n\t      config.enabled = true;\n\t    }\n\t\n\t    for (var idx in forms) {\n\t      if (forms[idx]) {\n\t        if (forms[idx].options) {\n\t          if (config.runOnSelectionChange === undefined) {\n\t            config.runOnSelectionChange = true;\n\t          }\n\t        }\n\t      }\n\t    }\n\t\n\t    if (!config.results) {\n\t      config.results = {};\n\t    }\n\t\n\t    if (!config.editorSetting) {\n\t      config.editorSetting = {};\n\t    } else if (config.editorSetting.editOnDblClick) {\n\t      editorSetting.isOutputHidden = config.editorSetting.editOnDblClick;\n\t    }\n\t  };\n\t\n\t  $scope.$on('updateParagraphOutput', function (event, data) {\n\t    if ($scope.paragraph.id === data.paragraphId) {\n\t      if (!$scope.paragraph.results) {\n\t        $scope.paragraph.results = {};\n\t      }\n\t      if (!$scope.paragraph.results.msg) {\n\t        $scope.paragraph.results.msg = [];\n\t      }\n\t\n\t      var update = $scope.paragraph.results.msg[data.index] ? true : false;\n\t\n\t      $scope.paragraph.results.msg[data.index] = {\n\t        data: data.data,\n\t        type: data.type\n\t      };\n\t\n\t      if (update) {\n\t        $rootScope.$broadcast('updateResult', $scope.paragraph.results.msg[data.index], $scope.paragraph.config.results[data.index], $scope.paragraph, data.index);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.getIframeDimensions = function () {\n\t    if ($scope.asIframe) {\n\t      var paragraphid = '#' + $routeParams.paragraphId + '_container';\n\t      var height = angular.element(paragraphid).height();\n\t      return height;\n\t    }\n\t    return 0;\n\t  };\n\t\n\t  $scope.$watch($scope.getIframeDimensions, function (newValue, oldValue) {\n\t    if ($scope.asIframe && newValue) {\n\t      var message = {};\n\t      message.height = newValue;\n\t      message.url = $location.$$absUrl;\n\t      $window.parent.postMessage(angular.toJson(message), '*');\n\t    }\n\t  });\n\t\n\t  $scope.getEditor = function () {\n\t    return $scope.editor;\n\t  };\n\t\n\t  $scope.$watch($scope.getEditor, function (newValue, oldValue) {\n\t    if (!$scope.editor) {\n\t      return;\n\t    }\n\t    if (newValue === null || newValue === undefined) {\n\t      console.log('editor isnt loaded yet, returning');\n\t      return;\n\t    }\n\t    if ($scope.revisionView === true) {\n\t      $scope.editor.setReadOnly(true);\n\t    } else {\n\t      $scope.editor.setReadOnly(false);\n\t    }\n\t  });\n\t\n\t  var isEmpty = function isEmpty(object) {\n\t    return !object;\n\t  };\n\t\n\t  $scope.isRunning = function (paragraph) {\n\t    return paragraph.status === 'RUNNING' || paragraph.status === 'PENDING';\n\t  };\n\t\n\t  $scope.cancelParagraph = function (paragraph) {\n\t    console.log('Cancel %o', paragraph.id);\n\t    websocketMsgSrv.cancelParagraphRun(paragraph.id);\n\t  };\n\t\n\t  $scope.runParagraph = function (data) {\n\t    websocketMsgSrv.runParagraph($scope.paragraph.id, $scope.paragraph.title, data, $scope.paragraph.config, $scope.paragraph.settings.params);\n\t    $scope.originalText = angular.copy(data);\n\t    $scope.dirtyText = undefined;\n\t\n\t    if ($scope.paragraph.config.editorSetting.editOnDblClick) {\n\t      closeEditorAndOpenTable($scope.paragraph);\n\t    } else if (editorSetting.isOutputHidden && !$scope.paragraph.config.editorSetting.editOnDblClick) {\n\t      // %md/%angular repl make output to be hidden by default after running\n\t      // so should open output if repl changed from %md/%angular to another\n\t      openEditorAndOpenTable($scope.paragraph);\n\t    }\n\t    editorSetting.isOutputHidden = $scope.paragraph.config.editorSetting.editOnDblClick;\n\t  };\n\t\n\t  $scope.saveParagraph = function (paragraph) {\n\t    var dirtyText = paragraph.text;\n\t    if (dirtyText === undefined || dirtyText === $scope.originalText) {\n\t      return;\n\t    }\n\t    commitParagraph(paragraph);\n\t    $scope.originalText = dirtyText;\n\t    $scope.dirtyText = undefined;\n\t  };\n\t\n\t  $scope.toggleEnableDisable = function (paragraph) {\n\t    paragraph.config.enabled = !paragraph.config.enabled;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.run = function (paragraph, editorValue) {\n\t    if (editorValue && !$scope.isRunning(paragraph)) {\n\t      $scope.runParagraph(editorValue);\n\t    }\n\t  };\n\t\n\t  $scope.turnOnAutoRun = function (paragraph) {\n\t    paragraph.config.runOnSelectionChange = !paragraph.config.runOnSelectionChange;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.moveUp = function (paragraph) {\n\t    $scope.$emit('moveParagraphUp', paragraph);\n\t  };\n\t\n\t  $scope.moveDown = function (paragraph) {\n\t    $scope.$emit('moveParagraphDown', paragraph);\n\t  };\n\t\n\t  $scope.insertNew = function (position) {\n\t    $scope.$emit('insertParagraph', $scope.paragraph.id, position);\n\t  };\n\t\n\t  $scope.copyPara = function (position) {\n\t    var editorValue = $scope.getEditorValue();\n\t    if (editorValue) {\n\t      $scope.copyParagraph(editorValue, position);\n\t    }\n\t  };\n\t\n\t  $scope.copyParagraph = function (data, position) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === $scope.paragraph.id) {\n\t        //determine position of where to add new paragraph; default is below\n\t        if (position === 'above') {\n\t          newIndex = i;\n\t        } else {\n\t          newIndex = i + 1;\n\t        }\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t\n\t    var config = angular.copy($scope.paragraph.config);\n\t    config.editorHide = false;\n\t\n\t    websocketMsgSrv.copyParagraph(newIndex, $scope.paragraph.title, data, config, $scope.paragraph.settings.params);\n\t  };\n\t\n\t  $scope.removeParagraph = function (paragraph) {\n\t    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n\t    if (paragraphs[paragraphs.length - 1].id.indexOf(paragraph.id) === 0) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        message: 'The last paragraph can\\'t be deleted.',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            $scope.editor.focus();\n\t          }\n\t        }\n\t      });\n\t    } else {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: '',\n\t        message: 'Do you want to delete this paragraph?',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            console.log('Remove paragraph');\n\t            websocketMsgSrv.removeParagraph(paragraph.id);\n\t            $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n\t          }\n\t        }\n\t      });\n\t    }\n\t  };\n\t\n\t  $scope.clearParagraphOutput = function (paragraph) {\n\t    websocketMsgSrv.clearParagraphOutput(paragraph.id);\n\t  };\n\t\n\t  $scope.toggleEditor = function (paragraph) {\n\t    if (paragraph.config.editorHide) {\n\t      $scope.openEditor(paragraph);\n\t    } else {\n\t      $scope.closeEditor(paragraph);\n\t    }\n\t  };\n\t\n\t  $scope.closeEditor = function (paragraph) {\n\t    console.log('close the note');\n\t    paragraph.config.editorHide = true;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.openEditor = function (paragraph) {\n\t    console.log('open the note');\n\t    paragraph.config.editorHide = false;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.closeTable = function (paragraph) {\n\t    console.log('close the output');\n\t    paragraph.config.tableHide = true;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.openTable = function (paragraph) {\n\t    console.log('open the output');\n\t    paragraph.config.tableHide = false;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  var openEditorAndCloseTable = function openEditorAndCloseTable(paragraph) {\n\t    manageEditorAndTableState(paragraph, false, true);\n\t  };\n\t\n\t  var closeEditorAndOpenTable = function closeEditorAndOpenTable(paragraph) {\n\t    manageEditorAndTableState(paragraph, true, false);\n\t  };\n\t\n\t  var openEditorAndOpenTable = function openEditorAndOpenTable(paragraph) {\n\t    manageEditorAndTableState(paragraph, false, false);\n\t  };\n\t\n\t  var manageEditorAndTableState = function manageEditorAndTableState(paragraph, hideEditor, hideTable) {\n\t    paragraph.config.editorHide = hideEditor;\n\t    paragraph.config.tableHide = hideTable;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.showTitle = function (paragraph) {\n\t    paragraph.config.title = true;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.hideTitle = function (paragraph) {\n\t    paragraph.config.title = false;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.setTitle = function (paragraph) {\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.showLineNumbers = function (paragraph) {\n\t    if ($scope.editor) {\n\t      paragraph.config.lineNumbers = true;\n\t      $scope.editor.renderer.setShowGutter(true);\n\t      commitParagraph(paragraph);\n\t    }\n\t  };\n\t\n\t  $scope.hideLineNumbers = function (paragraph) {\n\t    if ($scope.editor) {\n\t      paragraph.config.lineNumbers = false;\n\t      $scope.editor.renderer.setShowGutter(false);\n\t      commitParagraph(paragraph);\n\t    }\n\t  };\n\t\n\t  $scope.columnWidthClass = function (n) {\n\t    if ($scope.asIframe) {\n\t      return 'col-md-12';\n\t    } else {\n\t      return 'paragraph-col col-md-' + n;\n\t    }\n\t  };\n\t\n\t  $scope.changeColWidth = function (paragraph, width) {\n\t    angular.element('.navbar-right.open').removeClass('open');\n\t    paragraph.config.colWidth = width;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.toggleOutput = function (paragraph) {\n\t    paragraph.config.tableHide = !paragraph.config.tableHide;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.loadForm = function (formulaire, params) {\n\t    var value = formulaire.defaultValue;\n\t    if (params[formulaire.name]) {\n\t      value = params[formulaire.name];\n\t    }\n\t\n\t    $scope.paragraph.settings.params[formulaire.name] = value;\n\t  };\n\t\n\t  $scope.toggleCheckbox = function (formulaire, option) {\n\t    var idx = $scope.paragraph.settings.params[formulaire.name].indexOf(option.value);\n\t    if (idx > -1) {\n\t      $scope.paragraph.settings.params[formulaire.name].splice(idx, 1);\n\t    } else {\n\t      $scope.paragraph.settings.params[formulaire.name].push(option.value);\n\t    }\n\t  };\n\t\n\t  $scope.aceChanged = function (_, editor) {\n\t    var session = editor.getSession();\n\t    var dirtyText = session.getValue();\n\t    $scope.dirtyText = dirtyText;\n\t    $scope.$broadcast('startSaveTimer');\n\t    setParagraphMode(session, dirtyText, editor.getCursorPosition());\n\t  };\n\t\n\t  $scope.aceLoaded = function (_editor) {\n\t    var langTools = ace.require('ace/ext/language_tools');\n\t    var Range = ace.require('ace/range').Range;\n\t\n\t    _editor.$blockScrolling = Infinity;\n\t    $scope.editor = _editor;\n\t    $scope.editor.on('input', $scope.aceChanged);\n\t    if (_editor.container.id !== '{{paragraph.id}}_editor') {\n\t      $scope.editor.renderer.setShowGutter($scope.paragraph.config.lineNumbers);\n\t      $scope.editor.setShowFoldWidgets(false);\n\t      $scope.editor.setHighlightActiveLine(false);\n\t      $scope.editor.setHighlightGutterLine(false);\n\t      $scope.editor.getSession().setUseWrapMode(true);\n\t      $scope.editor.setTheme('ace/theme/chrome');\n\t      $scope.editor.setReadOnly($scope.isRunning($scope.paragraph));\n\t      if ($scope.paragraphFocused) {\n\t        $scope.editor.focus();\n\t        $scope.goToEnd($scope.editor);\n\t      }\n\t\n\t      autoAdjustEditorHeight(_editor);\n\t      angular.element(window).resize(function () {\n\t        autoAdjustEditorHeight(_editor);\n\t      });\n\t\n\t      if (navigator.appVersion.indexOf('Mac') !== -1) {\n\t        $scope.editor.setKeyboardHandler('ace/keyboard/emacs');\n\t        $rootScope.isMac = true;\n\t      } else if (navigator.appVersion.indexOf('Win') !== -1 || navigator.appVersion.indexOf('X11') !== -1 || navigator.appVersion.indexOf('Linux') !== -1) {\n\t        $rootScope.isMac = false;\n\t        // not applying emacs key binding while the binding override Ctrl-v. default behavior of paste text on windows.\n\t      }\n\t\n\t      var remoteCompleter = {\n\t        getCompletions: function getCompletions(editor, session, pos, prefix, callback) {\n\t          if (!editor.isFocused()) {\n\t            return;\n\t          }\n\t\n\t          pos = session.getTextRange(new Range(0, 0, pos.row, pos.column)).length;\n\t          var buf = session.getValue();\n\t\n\t          websocketMsgSrv.completion($scope.paragraph.id, buf, pos);\n\t\n\t          $scope.$on('completionList', function (event, data) {\n\t            if (data.completions) {\n\t              var completions = [];\n\t              for (var c in data.completions) {\n\t                var v = data.completions[c];\n\t                completions.push({\n\t                  name: v.name,\n\t                  value: v.value,\n\t                  score: 300\n\t                });\n\t              }\n\t              callback(null, completions);\n\t            }\n\t          });\n\t        }\n\t      };\n\t\n\t      langTools.setCompleters([remoteCompleter, langTools.keyWordCompleter, langTools.snippetCompleter, langTools.textCompleter]);\n\t\n\t      $scope.editor.setOptions({\n\t        enableBasicAutocompletion: true,\n\t        enableSnippets: false,\n\t        enableLiveAutocompletion: false\n\t      });\n\t\n\t      $scope.editor.on('focus', function () {\n\t        handleFocus(true);\n\t      });\n\t\n\t      $scope.editor.on('blur', function () {\n\t        handleFocus(false);\n\t      });\n\t\n\t      $scope.editor.on('paste', function (e) {\n\t        if (e.text.indexOf('%') === 0) {\n\t          pastePercentSign = true;\n\t        }\n\t      });\n\t\n\t      $scope.editor.getSession().on('change', function (e, editSession) {\n\t        autoAdjustEditorHeight(_editor);\n\t      });\n\t\n\t      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n\t\n\t      // autocomplete on '.'\n\t      /*\n\t       $scope.editor.commands.on(\"afterExec\", function(e, t) {\n\t       if (e.command.name == \"insertstring\" && e.args == \".\" ) {\n\t       var all = e.editor.completers;\n\t       //e.editor.completers = [remoteCompleter];\n\t       e.editor.execCommand(\"startAutocomplete\");\n\t       //e.editor.completers = all;\n\t       }\n\t       });\n\t       */\n\t\n\t      // remove binding\n\t      $scope.editor.commands.bindKey('ctrl-alt-n.', null);\n\t      $scope.editor.commands.removeCommand('showSettingsMenu');\n\t\n\t      $scope.editor.commands.bindKey('ctrl-alt-l', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-w', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-a', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-k', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-e', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-t', null);\n\t\n\t      // autocomplete on 'ctrl+.'\n\t      $scope.editor.commands.bindKey('ctrl-.', 'startAutocomplete');\n\t      $scope.editor.commands.bindKey('ctrl-space', null);\n\t\n\t      var keyBindingEditorFocusAction = function keyBindingEditorFocusAction(scrollValue) {\n\t        var numRows = $scope.editor.getSession().getLength();\n\t        var currentRow = $scope.editor.getCursorPosition().row;\n\t        if (currentRow === 0 && scrollValue <= 0) {\n\t          // move focus to previous paragraph\n\t          $scope.$emit('moveFocusToPreviousParagraph', $scope.paragraph.id);\n\t        } else if (currentRow === numRows - 1 && scrollValue >= 0) {\n\t          $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n\t        } else {\n\t          $scope.scrollToCursor($scope.paragraph.id, scrollValue);\n\t        }\n\t      };\n\t\n\t      // handle cursor moves\n\t      $scope.editor.keyBinding.origOnCommandKey = $scope.editor.keyBinding.onCommandKey;\n\t      $scope.editor.keyBinding.onCommandKey = function (e, hashId, keyCode) {\n\t        if ($scope.editor.completer && $scope.editor.completer.activated) {// if autocompleter is active\n\t        } else {\n\t          // fix ace editor focus issue in chrome (textarea element goes to top: -1000px after focused by cursor move)\n\t          if (parseInt(angular.element('#' + $scope.paragraph.id + '_editor > textarea').css('top').replace('px', '')) < 0) {\n\t            var position = $scope.editor.getCursorPosition();\n\t            var cursorPos = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n\t            angular.element('#' + $scope.paragraph.id + '_editor > textarea').css('top', cursorPos.top);\n\t          }\n\t\n\t          var ROW_UP = -1;\n\t          var ROW_DOWN = 1;\n\t\n\t          switch (keyCode) {\n\t            case 38:\n\t              keyBindingEditorFocusAction(ROW_UP);\n\t              break;\n\t            case 80:\n\t              if (e.ctrlKey && !e.altKey) {\n\t                keyBindingEditorFocusAction(ROW_UP);\n\t              }\n\t              break;\n\t            case 40:\n\t              keyBindingEditorFocusAction(ROW_DOWN);\n\t              break;\n\t            case 78:\n\t              if (e.ctrlKey && !e.altKey) {\n\t                keyBindingEditorFocusAction(ROW_DOWN);\n\t              }\n\t              break;\n\t          }\n\t        }\n\t        this.origOnCommandKey(e, hashId, keyCode);\n\t      };\n\t    }\n\t  };\n\t\n\t  var handleFocus = function handleFocus(value, isDigestPass) {\n\t    $scope.paragraphFocused = value;\n\t    if (isDigestPass === false || isDigestPass === undefined) {\n\t      // Protect against error in case digest is already running\n\t      $timeout(function () {\n\t        // Apply changes since they come from 3rd party library\n\t        $scope.$digest();\n\t      });\n\t    }\n\t  };\n\t\n\t  var getEditorSetting = function getEditorSetting(paragraph, interpreterName) {\n\t    var deferred = $q.defer();\n\t    websocketMsgSrv.getEditorSetting(paragraph.id, interpreterName);\n\t    $timeout($scope.$on('editorSetting', function (event, data) {\n\t      if (paragraph.id === data.paragraphId) {\n\t        deferred.resolve(data);\n\t      }\n\t    }), 1000);\n\t    return deferred.promise;\n\t  };\n\t\n\t  var setEditorLanguage = function setEditorLanguage(session, language) {\n\t    var mode = 'ace/mode/';\n\t    mode += language;\n\t    $scope.paragraph.config.editorMode = mode;\n\t    session.setMode(mode);\n\t  };\n\t\n\t  var setParagraphMode = function setParagraphMode(session, paragraphText, pos) {\n\t    // Evaluate the mode only if the the position is undefined\n\t    // or the first 30 characters of the paragraph have been modified\n\t    // or cursor position is at beginning of second line.(in case user hit enter after typing %magic)\n\t    if (typeof pos === 'undefined' || pos.row === 0 && pos.column < 30 || pos.row === 1 && pos.column === 0 || pastePercentSign) {\n\t      // If paragraph loading, use config value if exists\n\t      if (typeof pos === 'undefined' && $scope.paragraph.config.editorMode && !setInterpreterBindings) {\n\t        session.setMode($scope.paragraph.config.editorMode);\n\t      } else {\n\t        var magic = getInterpreterName(paragraphText);\n\t        if (editorSetting.magic !== magic) {\n\t          editorSetting.magic = magic;\n\t          getEditorSetting($scope.paragraph, magic).then(function (setting) {\n\t            setEditorLanguage(session, setting.editor.language);\n\t            _.merge($scope.paragraph.config.editorSetting, setting.editor);\n\t          });\n\t        }\n\t      }\n\t    }\n\t    pastePercentSign = false;\n\t    setInterpreterBindings = false;\n\t  };\n\t\n\t  var getInterpreterName = function getInterpreterName(paragraphText) {\n\t    var intpNameRegexp = /^\\s*%(.+?)\\s/g;\n\t    var match = intpNameRegexp.exec(paragraphText);\n\t    if (match) {\n\t      return match[1].trim();\n\t      // get default interpreter name if paragraph text doesn't start with '%'\n\t      // TODO(mina): dig into the cause what makes interpreterBindings to have no element\n\t    } else if ($scope.$parent.interpreterBindings && $scope.$parent.interpreterBindings.length !== 0) {\n\t      return $scope.$parent.interpreterBindings[0].name;\n\t    }\n\t    return '';\n\t  };\n\t\n\t  var autoAdjustEditorHeight = function autoAdjustEditorHeight(editor) {\n\t    var height = editor.getSession().getScreenLength() * editor.renderer.lineHeight + editor.renderer.scrollBar.getWidth();\n\t\n\t    angular.element('#' + editor.container.id).height(height.toString() + 'px');\n\t    editor.resize();\n\t  };\n\t\n\t  $rootScope.$on('scrollToCursor', function (event) {\n\t    // scroll on 'scrollToCursor' event only when cursor is in the last paragraph\n\t    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n\t    if (paragraphs[paragraphs.length - 1].id.indexOf($scope.paragraph.id) === 0) {\n\t      $scope.scrollToCursor($scope.paragraph.id, 0);\n\t    }\n\t  });\n\t\n\t  /** scrollToCursor if it is necessary\n\t   * when cursor touches scrollTriggerEdgeMargin from the top (or bottom) of the screen, it autoscroll to place cursor around 1/3 of screen height from the top (or bottom)\n\t   * paragraphId : paragraph that has active cursor\n\t   * lastCursorMove : 1(down), 0, -1(up) last cursor move event\n\t   **/\n\t  $scope.scrollToCursor = function (paragraphId, lastCursorMove) {\n\t    if (!$scope.editor || !$scope.editor.isFocused()) {\n\t      // only make sense when editor is focused\n\t      return;\n\t    }\n\t    var lineHeight = $scope.editor.renderer.lineHeight;\n\t    var headerHeight = 103; // menubar, notebook titlebar\n\t    var scrollTriggerEdgeMargin = 50;\n\t\n\t    var documentHeight = angular.element(document).height();\n\t    var windowHeight = angular.element(window).height(); // actual viewport height\n\t\n\t    var scrollPosition = angular.element(document).scrollTop();\n\t    var editorPosition = angular.element('#' + paragraphId + '_editor').offset();\n\t    var position = $scope.editor.getCursorPosition();\n\t    var lastCursorPosition = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n\t\n\t    var calculatedCursorPosition = editorPosition.top + lastCursorPosition.top + lineHeight * lastCursorMove;\n\t\n\t    var scrollTargetPos;\n\t    if (calculatedCursorPosition < scrollPosition + headerHeight + scrollTriggerEdgeMargin) {\n\t      scrollTargetPos = calculatedCursorPosition - headerHeight - (windowHeight - headerHeight) / 3;\n\t      if (scrollTargetPos < 0) {\n\t        scrollTargetPos = 0;\n\t      }\n\t    } else if (calculatedCursorPosition > scrollPosition + scrollTriggerEdgeMargin + windowHeight - headerHeight) {\n\t      scrollTargetPos = calculatedCursorPosition - headerHeight - (windowHeight - headerHeight) * 2 / 3;\n\t\n\t      if (scrollTargetPos > documentHeight) {\n\t        scrollTargetPos = documentHeight;\n\t      }\n\t    }\n\t\n\t    // cancel previous scroll animation\n\t    var bodyEl = angular.element('body');\n\t    bodyEl.stop();\n\t    bodyEl.finish();\n\t\n\t    // scroll to scrollTargetPos\n\t    bodyEl.scrollTo(scrollTargetPos, { axis: 'y', interrupt: true, duration: 100 });\n\t  };\n\t\n\t  $scope.getEditorValue = function () {\n\t    return !$scope.editor ? $scope.paragraph.text : $scope.editor.getValue();\n\t  };\n\t\n\t  $scope.getProgress = function () {\n\t    return $scope.currentProgress || 0;\n\t  };\n\t\n\t  $scope.getExecutionTime = function (pdata) {\n\t    var timeMs = Date.parse(pdata.dateFinished) - Date.parse(pdata.dateStarted);\n\t    if (isNaN(timeMs) || timeMs < 0) {\n\t      if ($scope.isResultOutdated(pdata)) {\n\t        return 'outdated';\n\t      }\n\t      return '';\n\t    }\n\t    var user = pdata.user === undefined || pdata.user === null ? 'anonymous' : pdata.user;\n\t    var desc = 'Took ' + moment.duration(timeMs / 1000, 'seconds').format('h [hrs] m [min] s [sec]') + '. Last updated by ' + user + ' at ' + moment(pdata.dateFinished).format('MMMM DD YYYY, h:mm:ss A') + '.';\n\t    if ($scope.isResultOutdated(pdata)) {\n\t      desc += ' (outdated)';\n\t    }\n\t    return desc;\n\t  };\n\t\n\t  $scope.getElapsedTime = function (paragraph) {\n\t    return 'Started ' + moment(paragraph.dateStarted).fromNow() + '.';\n\t  };\n\t\n\t  $scope.isResultOutdated = function (pdata) {\n\t    if (pdata.dateUpdated !== undefined && Date.parse(pdata.dateUpdated) > Date.parse(pdata.dateStarted)) {\n\t      return true;\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.goToEnd = function (editor) {\n\t    editor.navigateFileEnd();\n\t  };\n\t\n\t  $scope.getResultType = function (paragraph) {\n\t    var pdata = paragraph ? paragraph : $scope.paragraph;\n\t    if (pdata.results && pdata.results.type) {\n\t      return pdata.results.type;\n\t    } else {\n\t      return 'TEXT';\n\t    }\n\t  };\n\t\n\t  $scope.parseTableCell = function (cell) {\n\t    if (!isNaN(cell)) {\n\t      if (cell.length === 0 || Number(cell) > Number.MAX_SAFE_INTEGER || Number(cell) < Number.MIN_SAFE_INTEGER) {\n\t        return cell;\n\t      } else {\n\t        return Number(cell);\n\t      }\n\t    }\n\t    var d = moment(cell);\n\t    if (d.isValid()) {\n\t      return d;\n\t    }\n\t    return cell;\n\t  };\n\t\n\t  var commitParagraph = function commitParagraph(paragraph) {\n\t    var id = paragraph.id,\n\t        title = paragraph.title,\n\t        text = paragraph.text,\n\t        config = paragraph.config,\n\t        params = paragraph.settings.params;\n\t\n\t\n\t    websocketMsgSrv.commitParagraph(id, title, text, config, params);\n\t  };\n\t\n\t  /** Utility function */\n\t  $scope.goToSingleParagraph = function () {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    var redirectToUrl = location.protocol + '//' + location.host + location.pathname + '#/notebook/' + noteId + '/paragraph/' + $scope.paragraph.id + '?asIframe';\n\t    $window.open(redirectToUrl);\n\t  };\n\t\n\t  $scope.showScrollDownIcon = function (id) {\n\t    var doc = angular.element('#p' + id + '_text');\n\t    if (doc[0]) {\n\t      return doc[0].scrollHeight > doc.innerHeight();\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.scrollParagraphDown = function (id) {\n\t    var doc = angular.element('#p' + id + '_text');\n\t    doc.animate({ scrollTop: doc[0].scrollHeight }, 500);\n\t    $scope.keepScrollDown = true;\n\t  };\n\t\n\t  $scope.showScrollUpIcon = function (id) {\n\t    if (angular.element('#p' + id + '_text')[0]) {\n\t      return angular.element('#p' + id + '_text')[0].scrollTop !== 0;\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.scrollParagraphUp = function (id) {\n\t    var doc = angular.element('#p' + id + '_text');\n\t    doc.animate({ scrollTop: 0 }, 500);\n\t    $scope.keepScrollDown = false;\n\t  };\n\t\n\t  $scope.$on('angularObjectUpdate', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n\t        scope = paragraphScope;\n\t        registry = angularObjectRegistry;\n\t      } else {\n\t        return;\n\t      }\n\t      var varName = data.angularObject.name;\n\t\n\t      if (angular.equals(data.angularObject.object, scope[varName])) {\n\t        // return when update has no change\n\t        return;\n\t      }\n\t\n\t      if (!registry[varName]) {\n\t        registry[varName] = {\n\t          interpreterGroupId: data.interpreterGroupId,\n\t          noteId: data.noteId,\n\t          paragraphId: data.paragraphId\n\t        };\n\t      } else {\n\t        registry[varName].noteId = registry[varName].noteId || data.noteId;\n\t        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n\t      }\n\t\n\t      registry[varName].skipEmit = true;\n\t\n\t      if (!registry[varName].clearWatcher) {\n\t        registry[varName].clearWatcher = scope.$watch(varName, function (newValue, oldValue) {\n\t          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n\t          if (registry[varName].skipEmit) {\n\t            registry[varName].skipEmit = false;\n\t            return;\n\t          }\n\t          websocketMsgSrv.updateAngularObject(registry[varName].noteId, registry[varName].paragraphId, varName, newValue, registry[varName].interpreterGroupId);\n\t        });\n\t      }\n\t      console.log('angular object (paragraph) created %o', varName);\n\t      scope[varName] = data.angularObject.object;\n\t\n\t      // create proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = function () {\n\t          scope[varName] = arguments;\n\t          console.log('angular function (paragraph) invoked %o', arguments);\n\t        };\n\t\n\t        console.log('angular function (paragraph) created %o', scope[funcName]);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('angularObjectRemove', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n\t        scope = paragraphScope;\n\t        registry = angularObjectRegistry;\n\t      } else {\n\t        return;\n\t      }\n\t\n\t      var varName = data.name;\n\t\n\t      // clear watcher\n\t      if (registry[varName]) {\n\t        registry[varName].clearWatcher();\n\t        registry[varName] = undefined;\n\t      }\n\t\n\t      // remove scope variable\n\t      scope[varName] = undefined;\n\t\n\t      // remove proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = undefined;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateParagraph', function (event, data) {\n\t    if (data.paragraph.id === $scope.paragraph.id && (data.paragraph.dateCreated !== $scope.paragraph.dateCreated || data.paragraph.dateFinished !== $scope.paragraph.dateFinished || data.paragraph.dateStarted !== $scope.paragraph.dateStarted || data.paragraph.dateUpdated !== $scope.paragraph.dateUpdated || data.paragraph.status !== $scope.paragraph.status || data.paragraph.jobName !== $scope.paragraph.jobName || data.paragraph.title !== $scope.paragraph.title || isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) || data.paragraph.errorMessage !== $scope.paragraph.errorMessage || !angular.equals(data.paragraph.settings, $scope.paragraph.settings) || !angular.equals(data.paragraph.config, $scope.paragraph.config))) {\n\t      var statusChanged = data.paragraph.status !== $scope.paragraph.status;\n\t      var resultRefreshed = data.paragraph.dateFinished !== $scope.paragraph.dateFinished || isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) || data.paragraph.status === 'ERROR' || data.paragraph.status === 'FINISHED' && statusChanged;\n\t\n\t      if ($scope.paragraph.text !== data.paragraph.text) {\n\t        if ($scope.dirtyText) {\n\t          // check if editor has local update\n\t          if ($scope.dirtyText === data.paragraph.text) {\n\t            // when local update is the same from remote, clear local update\n\t            $scope.paragraph.text = data.paragraph.text;\n\t            $scope.dirtyText = undefined;\n\t            $scope.originalText = angular.copy(data.paragraph.text);\n\t          } else {\n\t            // if there're local update, keep it.\n\t            $scope.paragraph.text = data.paragraph.text;\n\t          }\n\t        } else {\n\t          $scope.paragraph.text = data.paragraph.text;\n\t          $scope.originalText = angular.copy(data.paragraph.text);\n\t        }\n\t      }\n\t\n\t      /** broadcast update to result controller **/\n\t      if (data.paragraph.results && data.paragraph.results.msg) {\n\t        for (var i in data.paragraph.results.msg) {\n\t          var newResult = data.paragraph.results.msg ? data.paragraph.results.msg[i] : {};\n\t          var oldResult = $scope.paragraph.results && $scope.paragraph.results.msg ? $scope.paragraph.results.msg[i] : {};\n\t          var newConfig = data.paragraph.config.results ? data.paragraph.config.results[i] : {};\n\t          var oldConfig = $scope.paragraph.config.results ? $scope.paragraph.config.results[i] : {};\n\t          if (!angular.equals(newResult, oldResult) || !angular.equals(newConfig, oldConfig)) {\n\t            $rootScope.$broadcast('updateResult', newResult, newConfig, data.paragraph, parseInt(i));\n\t          }\n\t        }\n\t      }\n\t\n\t      // resize col width\n\t      if ($scope.paragraph.config.colWidth !== data.paragraph.colWidth) {\n\t        $rootScope.$broadcast('paragraphResized', $scope.paragraph.id);\n\t      }\n\t\n\t      /** push the rest */\n\t      $scope.paragraph.aborted = data.paragraph.aborted;\n\t      $scope.paragraph.user = data.paragraph.user;\n\t      $scope.paragraph.dateUpdated = data.paragraph.dateUpdated;\n\t      $scope.paragraph.dateCreated = data.paragraph.dateCreated;\n\t      $scope.paragraph.dateFinished = data.paragraph.dateFinished;\n\t      $scope.paragraph.dateStarted = data.paragraph.dateStarted;\n\t      $scope.paragraph.errorMessage = data.paragraph.errorMessage;\n\t      $scope.paragraph.jobName = data.paragraph.jobName;\n\t      $scope.paragraph.title = data.paragraph.title;\n\t      $scope.paragraph.lineNumbers = data.paragraph.lineNumbers;\n\t      $scope.paragraph.status = data.paragraph.status;\n\t      if (data.paragraph.status !== 'RUNNING') {\n\t        $scope.paragraph.results = data.paragraph.results;\n\t      }\n\t      $scope.paragraph.settings = data.paragraph.settings;\n\t      if ($scope.editor) {\n\t        $scope.editor.setReadOnly($scope.isRunning(data.paragraph));\n\t      }\n\t\n\t      if (!$scope.asIframe) {\n\t        $scope.paragraph.config = data.paragraph.config;\n\t        initializeDefault(data.paragraph.config);\n\t      } else {\n\t        data.paragraph.config.editorHide = true;\n\t        data.paragraph.config.tableHide = false;\n\t        $scope.paragraph.config = data.paragraph.config;\n\t      }\n\t\n\t      if (statusChanged || resultRefreshed) {\n\t        // when last paragraph runs, zeppelin automatically appends new paragraph.\n\t        // this broadcast will focus to the newly inserted paragraph\n\t        var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n\t        if (paragraphs.length >= 2 && paragraphs[paragraphs.length - 2].id.indexOf($scope.paragraph.id) === 0) {\n\t          // rendering output can took some time. So delay scrolling event firing for sometime.\n\t          setTimeout(function () {\n\t            $rootScope.$broadcast('scrollToCursor');\n\t          }, 500);\n\t        }\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateProgress', function (event, data) {\n\t    if (data.id === $scope.paragraph.id) {\n\t      $scope.currentProgress = data.progress;\n\t    }\n\t  });\n\t\n\t  $scope.$on('keyEvent', function (event, keyEvent) {\n\t    if ($scope.paragraphFocused) {\n\t\n\t      var paragraphId = $scope.paragraph.id;\n\t      var keyCode = keyEvent.keyCode;\n\t      var noShortcutDefined = false;\n\t      var editorHide = $scope.paragraph.config.editorHide;\n\t\n\t      if (editorHide && (keyCode === 38 || keyCode === 80 && keyEvent.ctrlKey && !keyEvent.altKey)) {\n\t        // up\n\t        // move focus to previous paragraph\n\t        $scope.$emit('moveFocusToPreviousParagraph', paragraphId);\n\t      } else if (editorHide && (keyCode === 40 || keyCode === 78 && keyEvent.ctrlKey && !keyEvent.altKey)) {\n\t        // down\n\t        // move focus to next paragraph\n\t        $scope.$emit('moveFocusToNextParagraph', paragraphId);\n\t      } else if (keyEvent.shiftKey && keyCode === 13) {\n\t        // Shift + Enter\n\t        $scope.run($scope.paragraph, $scope.getEditorValue());\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 67) {\n\t        // Ctrl + Alt + c\n\t        $scope.cancelParagraph($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 68) {\n\t        // Ctrl + Alt + d\n\t        $scope.removeParagraph($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 75) {\n\t        // Ctrl + Alt + k\n\t        $scope.moveUp($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 74) {\n\t        // Ctrl + Alt + j\n\t        $scope.moveDown($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 65) {\n\t        // Ctrl + Alt + a\n\t        $scope.insertNew('above');\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 66) {\n\t        // Ctrl + Alt + b\n\t        $scope.insertNew('below');\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 79) {\n\t        // Ctrl + Alt + o\n\t        $scope.toggleOutput($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 82) {\n\t        // Ctrl + Alt + r\n\t        $scope.toggleEnableDisable($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 69) {\n\t        // Ctrl + Alt + e\n\t        $scope.toggleEditor($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 77) {\n\t        // Ctrl + Alt + m\n\t        if ($scope.paragraph.config.lineNumbers) {\n\t          $scope.hideLineNumbers($scope.paragraph);\n\t        } else {\n\t          $scope.showLineNumbers($scope.paragraph);\n\t        }\n\t      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 189) {\n\t        // Ctrl + Shift + -\n\t        $scope.changeColWidth($scope.paragraph, Math.max(1, $scope.paragraph.config.colWidth - 1));\n\t      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 187) {\n\t        // Ctrl + Shift + =\n\t        $scope.changeColWidth($scope.paragraph, Math.min(12, $scope.paragraph.config.colWidth + 1));\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 84) {\n\t        // Ctrl + Alt + t\n\t        if ($scope.paragraph.config.title) {\n\t          $scope.hideTitle($scope.paragraph);\n\t        } else {\n\t          $scope.showTitle($scope.paragraph);\n\t        }\n\t      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 67) {\n\t        // Ctrl + Alt + c\n\t        $scope.copyPara('below');\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 76) {\n\t        // Ctrl + Alt + l\n\t        $scope.clearParagraphOutput($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 87) {\n\t        // Ctrl + Alt + w\n\t        $scope.goToSingleParagraph();\n\t      } else {\n\t        noShortcutDefined = true;\n\t      }\n\t\n\t      if (!noShortcutDefined) {\n\t        keyEvent.preventDefault();\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('focusParagraph', function (event, paragraphId, cursorPos, mouseEvent) {\n\t    if ($scope.paragraph.id === paragraphId) {\n\t      // focus editor\n\t      if (!$scope.paragraph.config.editorHide) {\n\t        if (!mouseEvent) {\n\t          $scope.editor.focus();\n\t          // move cursor to the first row (or the last row)\n\t          var row;\n\t          if (cursorPos >= 0) {\n\t            row = cursorPos;\n\t            $scope.editor.gotoLine(row, 0);\n\t          } else {\n\t            row = $scope.editor.session.getLength();\n\t            $scope.editor.gotoLine(row, 0);\n\t          }\n\t          $scope.scrollToCursor($scope.paragraph.id, 0);\n\t        }\n\t      }\n\t      handleFocus(true);\n\t    } else {\n\t      if ($scope.editor !== undefined && $scope.editor !== null) {\n\t        $scope.editor.blur();\n\t      }\n\t      var isDigestPass = true;\n\t      handleFocus(false, isDigestPass);\n\t    }\n\t  });\n\t\n\t  $scope.$on('saveInterpreterBindings', function (event, paragraphId) {\n\t    if ($scope.paragraph.id === paragraphId && $scope.editor) {\n\t      setInterpreterBindings = true;\n\t      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n\t    }\n\t  });\n\t\n\t  $scope.$on('doubleClickParagraph', function (event, paragraphId) {\n\t    if ($scope.paragraph.id === paragraphId && $scope.paragraph.config.editorHide && $scope.paragraph.config.editorSetting.editOnDblClick && $scope.revisionView !== true) {\n\t      var deferred = $q.defer();\n\t      openEditorAndCloseTable($scope.paragraph);\n\t      $timeout($scope.$on('updateParagraph', function (event, data) {\n\t        deferred.resolve(data);\n\t      }), 1000);\n\t\n\t      deferred.promise.then(function (data) {\n\t        if ($scope.editor) {\n\t          $scope.editor.focus();\n\t          $scope.goToEnd($scope.editor);\n\t        }\n\t      });\n\t    }\n\t  });\n\t\n\t  $scope.$on('openEditor', function (event) {\n\t    $scope.openEditor($scope.paragraph);\n\t  });\n\t\n\t  $scope.$on('closeEditor', function (event) {\n\t    $scope.closeEditor($scope.paragraph);\n\t  });\n\t\n\t  $scope.$on('openTable', function (event) {\n\t    $scope.openTable($scope.paragraph);\n\t  });\n\t\n\t  $scope.$on('closeTable', function (event) {\n\t    $scope.closeTable($scope.paragraph);\n\t  });\n\t}\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _tabledata = __webpack_require__(6);\n\t\n\tvar _tabledata2 = _interopRequireDefault(_tabledata);\n\t\n\tvar _visualizationTable = __webpack_require__(12);\n\t\n\tvar _visualizationTable2 = _interopRequireDefault(_visualizationTable);\n\t\n\tvar _visualizationBarchart = __webpack_require__(14);\n\t\n\tvar _visualizationBarchart2 = _interopRequireDefault(_visualizationBarchart);\n\t\n\tvar _visualizationPiechart = __webpack_require__(15);\n\t\n\tvar _visualizationPiechart2 = _interopRequireDefault(_visualizationPiechart);\n\t\n\tvar _visualizationAreachart = __webpack_require__(16);\n\t\n\tvar _visualizationAreachart2 = _interopRequireDefault(_visualizationAreachart);\n\t\n\tvar _visualizationLinechart = __webpack_require__(17);\n\t\n\tvar _visualizationLinechart2 = _interopRequireDefault(_visualizationLinechart);\n\t\n\tvar _visualizationScatterchart = __webpack_require__(18);\n\t\n\tvar _visualizationScatterchart2 = _interopRequireDefault(_visualizationScatterchart);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tangular.module('zeppelinWebApp').controller('ResultCtrl', ResultCtrl); /*\n\t                                                                        * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                        * you may not use this file except in compliance with the License.\n\t                                                                        * You may obtain a copy of the License at\n\t                                                                        *\n\t                                                                        *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                        *\n\t                                                                        * Unless required by applicable law or agreed to in writing, software\n\t                                                                        * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                        * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                        * See the License for the specific language governing permissions and\n\t                                                                        * limitations under the License.\n\t                                                                        */\n\t\n\tResultCtrl.$inject = ['$scope', '$rootScope', '$route', '$window', '$routeParams', '$location', '$timeout', '$compile', '$http', '$q', '$templateRequest', '$sce', 'websocketMsgSrv', 'baseUrlSrv', 'ngToast', 'saveAsService', 'noteVarShareService', 'heliumService'];\n\t\n\tfunction ResultCtrl($scope, $rootScope, $route, $window, $routeParams, $location, $timeout, $compile, $http, $q, $templateRequest, $sce, websocketMsgSrv, baseUrlSrv, ngToast, saveAsService, noteVarShareService, heliumService) {\n\t\n\t  /**\n\t   * Built-in visualizations\n\t   */\n\t  $scope.builtInTableDataVisualizationList = [{\n\t    id: 'table', // paragraph.config.graph.mode\n\t    name: 'Table', // human readable name. tooltip\n\t    icon: '<i class=\"fa fa-table\"></i>'\n\t  }, {\n\t    id: 'multiBarChart',\n\t    name: 'Bar Chart',\n\t    icon: '<i class=\"fa fa-bar-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'pieChart',\n\t    name: 'Pie Chart',\n\t    icon: '<i class=\"fa fa-pie-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'stackedAreaChart',\n\t    name: 'Area Chart',\n\t    icon: '<i class=\"fa fa-area-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'lineChart',\n\t    name: 'Line Chart',\n\t    icon: '<i class=\"fa fa-line-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'scatterChart',\n\t    name: 'Scatter Chart',\n\t    icon: '<i class=\"cf cf-scatter-chart\"></i>'\n\t  }];\n\t\n\t  /**\n\t   * Holds class and actual runtime instance and related infos of built-in visualizations\n\t   */\n\t  var builtInVisualizations = {\n\t    'table': {\n\t      class: _visualizationTable2.default,\n\t      instance: undefined // created from setGraphMode()\n\t    },\n\t    'multiBarChart': {\n\t      class: _visualizationBarchart2.default,\n\t      instance: undefined\n\t    },\n\t    'pieChart': {\n\t      class: _visualizationPiechart2.default,\n\t      instance: undefined\n\t    },\n\t    'stackedAreaChart': {\n\t      class: _visualizationAreachart2.default,\n\t      instance: undefined\n\t    },\n\t    'lineChart': {\n\t      class: _visualizationLinechart2.default,\n\t      instance: undefined\n\t    },\n\t    'scatterChart': {\n\t      class: _visualizationScatterchart2.default,\n\t      instance: undefined\n\t    }\n\t  };\n\t\n\t  // type\n\t  $scope.type;\n\t\n\t  // Data of the result\n\t  var data;\n\t\n\t  // config\n\t  $scope.config;\n\t\n\t  // resultId = paragraph.id + index\n\t  $scope.id;\n\t\n\t  // referece to paragraph\n\t  var paragraph;\n\t\n\t  // index of the result\n\t  var resultIndex;\n\t\n\t  // TableData instance\n\t  var tableData;\n\t\n\t  // available columns in tabledata\n\t  $scope.tableDataColumns = [];\n\t\n\t  // enable helium\n\t  var enableHelium = false;\n\t\n\t  // graphMode\n\t  $scope.graphMode;\n\t\n\t  // image data\n\t  $scope.imageData;\n\t\n\t  $scope.init = function (result, config, paragraph, index) {\n\t    console.log('result controller init %o %o %o', result, config, index);\n\t\n\t    // register helium plugin vis\n\t    var heliumVis = heliumService.get();\n\t    console.log('Helium visualizations %o', heliumVis);\n\t    heliumVis.forEach(function (vis) {\n\t      $scope.builtInTableDataVisualizationList.push({\n\t        id: vis.id,\n\t        name: vis.name,\n\t        icon: $sce.trustAsHtml(vis.icon)\n\t      });\n\t      builtInVisualizations[vis.id] = {\n\t        class: vis.class\n\t      };\n\t    });\n\t\n\t    updateData(result, config, paragraph, index);\n\t    renderResult($scope.type);\n\t  };\n\t\n\t  $scope.$on('updateResult', function (event, result, newConfig, paragraphRef, index) {\n\t    if (paragraph.id !== paragraphRef.id || index !== resultIndex) {\n\t      return;\n\t    }\n\t    console.log('updateResult %o %o %o %o', result, newConfig, paragraphRef, index);\n\t    var refresh = !angular.equals(newConfig, $scope.config) || !angular.equals(result.type, $scope.type) || !angular.equals(result.data, data);\n\t\n\t    updateData(result, newConfig, paragraph, resultIndex);\n\t    renderResult($scope.type, refresh);\n\t  });\n\t\n\t  $scope.$on('appendParagraphOutput', function (event, data) {\n\t    /* It has been observed that append events\n\t     * can be errorneously called even if paragraph\n\t     * execution has ended, and in that case, no append\n\t     * should be made. Also, it was observed that between PENDING\n\t     * and RUNNING states, append-events can be called and we can't\n\t     * miss those, else during the length of paragraph run, few\n\t     * initial output line/s will be missing.\n\t     */\n\t    if (paragraph.id === data.paragraphId && resultIndex === data.index && (paragraph.status === 'RUNNING' || paragraph.status === 'PENDING')) {\n\t      appendTextOutput(data.data);\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateParagraphOutput', function (event, data) {\n\t    if (paragraph.id === data.paragraphId && resultIndex === data.index) {\n\t      clearTextOutput();\n\t      appendTextOutput(data.data);\n\t    }\n\t  });\n\t\n\t  var updateData = function updateData(result, config, paragraphRef, index) {\n\t    data = result.data;\n\t    paragraph = paragraphRef;\n\t    resultIndex = parseInt(index);\n\t\n\t    $scope.id = paragraph.id + '_' + index;\n\t    $scope.type = result.type;\n\t    config = config ? config : {};\n\t\n\t    // initialize default config values\n\t    if (!config.graph) {\n\t      config.graph = {};\n\t    }\n\t\n\t    if (!config.graph.mode) {\n\t      config.graph.mode = 'table';\n\t    }\n\t\n\t    if (!config.graph.height) {\n\t      config.graph.height = 300;\n\t    }\n\t\n\t    if (!config.graph.optionOpen) {\n\t      config.graph.optionOpen = false;\n\t    }\n\t\n\t    $scope.graphMode = config.graph.mode;\n\t    $scope.config = angular.copy(config);\n\t\n\t    // enable only when it is last result\n\t    enableHelium = index === paragraphRef.results.msg.length - 1;\n\t\n\t    if ($scope.type === 'TABLE') {\n\t      tableData = new _tabledata2.default();\n\t      tableData.loadParagraphResult({ type: $scope.type, msg: data });\n\t      $scope.tableDataColumns = tableData.columns;\n\t      $scope.tableDataComment = tableData.comment;\n\t    } else if ($scope.type === 'IMG') {\n\t      $scope.imageData = data;\n\t    }\n\t  };\n\t\n\t  var renderResult = function renderResult(type, refresh) {\n\t    var activeApp;\n\t    if (enableHelium) {\n\t      getSuggestions();\n\t      getApplicationStates();\n\t      activeApp = _.get($scope.config, 'helium.activeApp');\n\t    }\n\t\n\t    if (activeApp) {\n\t      var app = _.find($scope.apps, { id: activeApp });\n\t      renderApp(app);\n\t    } else {\n\t      if (type === 'TABLE') {\n\t        var retryRenderer = function retryRenderer() {\n\t          var elem = angular.element('#p' + $scope.id + '_graph');\n\t          if (elem.length) {\n\t            $scope.renderGraph($scope.graphMode, refresh);\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      } else if (type === 'HTML') {\n\t        renderHtml();\n\t      } else if (type === 'ANGULAR') {\n\t        renderAngular();\n\t      } else if (type === 'TEXT') {\n\t        renderText();\n\t      }\n\t    }\n\t  };\n\t\n\t  var renderHtml = function renderHtml() {\n\t    var retryRenderer = function retryRenderer() {\n\t      var htmlEl = angular.element('#p' + $scope.id + '_html');\n\t      if (htmlEl.length) {\n\t        try {\n\t          htmlEl.html(data);\n\t\n\t          htmlEl.find('pre code').each(function (i, e) {\n\t            hljs.highlightBlock(e);\n\t          });\n\t          /*eslint new-cap: [2, {\"capIsNewExceptions\": [\"MathJax.Hub.Queue\"]}]*/\n\t          MathJax.Hub.Queue(['Typeset', MathJax.Hub, htmlEl[0]]);\n\t        } catch (err) {\n\t          console.log('HTML rendering error %o', err);\n\t        }\n\t      } else {\n\t        $timeout(retryRenderer, 10);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  var renderAngular = function renderAngular() {\n\t    var retryRenderer = function retryRenderer() {\n\t      if (angular.element('#p' + $scope.id + '_angular').length) {\n\t        try {\n\t          angular.element('#p' + $scope.id + '_angular').html(data);\n\t\n\t          var paragraphScope = noteVarShareService.get(paragraph.id + '_paragraphScope');\n\t          $compile(angular.element('#p' + $scope.id + '_angular').contents())(paragraphScope);\n\t        } catch (err) {\n\t          console.log('ANGULAR rendering error %o', err);\n\t        }\n\t      } else {\n\t        $timeout(retryRenderer, 10);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  var getTextEl = function getTextEl(paragraphId) {\n\t    return angular.element('#p' + $scope.id + '_text');\n\t  };\n\t\n\t  var textRendererInitialized = false;\n\t  var renderText = function renderText() {\n\t    var retryRenderer = function retryRenderer() {\n\t      var textEl = getTextEl($scope.id);\n\t      if (textEl.length) {\n\t        // clear all lines before render\n\t        clearTextOutput();\n\t        textRendererInitialized = true;\n\t\n\t        if (data) {\n\t          appendTextOutput(data);\n\t        } else {\n\t          flushAppendQueue();\n\t        }\n\t\n\t        getTextEl($scope.id).bind('mousewheel', function (e) {\n\t          $scope.keepScrollDown = false;\n\t        });\n\t      } else {\n\t        $timeout(retryRenderer, 10);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  var clearTextOutput = function clearTextOutput() {\n\t    var textEl = getTextEl($scope.id);\n\t    if (textEl.length) {\n\t      textEl.children().remove();\n\t    }\n\t  };\n\t\n\t  var textAppendQueueBeforeInitialize = [];\n\t\n\t  var flushAppendQueue = function flushAppendQueue() {\n\t    while (textAppendQueueBeforeInitialize.length > 0) {\n\t      appendTextOutput(textAppendQueueBeforeInitialize.pop());\n\t    }\n\t  };\n\t\n\t  var appendTextOutput = function appendTextOutput(msg) {\n\t    if (!textRendererInitialized) {\n\t      textAppendQueueBeforeInitialize.push(msg);\n\t    } else {\n\t      flushAppendQueue();\n\t      var textEl = getTextEl($scope.id);\n\t      if (textEl.length) {\n\t        var lines = msg.split('\\n');\n\t        for (var i = 0; i < lines.length; i++) {\n\t          textEl.append(angular.element('<div></div>').text(lines[i]));\n\t        }\n\t      }\n\t      if ($scope.keepScrollDown) {\n\t        var doc = getTextEl($scope.id);\n\t        doc[0].scrollTop = doc[0].scrollHeight;\n\t      }\n\t    }\n\t  };\n\t\n\t  $scope.renderGraph = function (type, refresh) {\n\t    // set graph height\n\t    var height = $scope.config.graph.height;\n\t    var graphContainerEl = angular.element('#p' + $scope.id + '_graph');\n\t    graphContainerEl.height(height);\n\t\n\t    if (!type) {\n\t      type = 'table';\n\t    }\n\t\n\t    var builtInViz = builtInVisualizations[type];\n\t    if (builtInViz) {\n\t      // deactive previsouly active visualization\n\t      for (var t in builtInVisualizations) {\n\t        var v = builtInVisualizations[t].instance;\n\t\n\t        if (t !== type && v && v.isActive()) {\n\t          v.deactivate();\n\t          break;\n\t        }\n\t      }\n\t\n\t      if (!builtInViz.instance) {\n\t        // not instantiated yet\n\t        // render when targetEl is available\n\t        var retryRenderer = function retryRenderer() {\n\t          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n\t          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n\t          var visualizationSettingTargetEl = angular.element('#vizsetting' + $scope.id + '_' + type);\n\t          if (targetEl.length) {\n\t            try {\n\t              // set height\n\t              targetEl.height(height);\n\t\n\t              // instantiate visualization\n\t              var config = getVizConfig(type);\n\t              var Visualization = builtInViz.class;\n\t              builtInViz.instance = new Visualization(targetEl, config);\n\t\n\t              // inject emitter, $templateRequest\n\t              var emitter = function emitter(graphSetting) {\n\t                commitVizConfigChange(graphSetting, type);\n\t              };\n\t              builtInViz.instance._emitter = emitter;\n\t              builtInViz.instance._compile = $compile;\n\t              builtInViz.instance._createNewScope = createNewScope;\n\t              var transformation = builtInViz.instance.getTransformation();\n\t              transformation._emitter = emitter;\n\t              transformation._templateRequest = $templateRequest;\n\t              transformation._compile = $compile;\n\t              transformation._createNewScope = createNewScope;\n\t\n\t              // render\n\t              var transformed = transformation.transform(tableData);\n\t              transformation.renderSetting(transformationSettingTargetEl);\n\t              builtInViz.instance.render(transformed);\n\t              builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n\t              builtInViz.instance.activate();\n\t              angular.element(window).resize(function () {\n\t                builtInViz.instance.resize();\n\t              });\n\t            } catch (err) {\n\t              console.error('Graph drawing error %o', err);\n\t            }\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      } else if (refresh) {\n\t        console.log('Refresh data %o', tableData);\n\t        // when graph options or data are changed\n\t        var retryRenderer = function retryRenderer() {\n\t          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n\t          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n\t          var visualizationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n\t          if (targetEl.length) {\n\t            var config = getVizConfig(type);\n\t            targetEl.height(height);\n\t            var transformation = builtInViz.instance.getTransformation();\n\t            transformation.setConfig(config);\n\t            var transformed = transformation.transform(tableData);\n\t            transformation.renderSetting(transformationSettingTargetEl);\n\t            builtInViz.instance.setConfig(config);\n\t            builtInViz.instance.render(transformed);\n\t            builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      } else {\n\t        var retryRenderer = function retryRenderer() {\n\t          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n\t          if (targetEl.length) {\n\t            targetEl.height(height);\n\t            builtInViz.instance.activate();\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      }\n\t    }\n\t  };\n\t  $scope.switchViz = function (newMode) {\n\t    var newConfig = angular.copy($scope.config);\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t\n\t    // graph options\n\t    newConfig.graph.mode = newMode;\n\t\n\t    // see switchApp()\n\t    _.set(newConfig, 'helium.activeApp', undefined);\n\t\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  var createNewScope = function createNewScope() {\n\t    return $rootScope.$new(true);\n\t  };\n\t\n\t  var commitParagraphResult = function commitParagraphResult(title, text, config, params) {\n\t    var newParagraphConfig = angular.copy(paragraph.config);\n\t    newParagraphConfig.results = newParagraphConfig.results || [];\n\t    newParagraphConfig.results[resultIndex] = config;\n\t    if ($scope.revisionView === true) {\n\t      // local update without commit\n\t      updateData({\n\t        type: $scope.type,\n\t        data: data\n\t      }, newParagraphConfig.results[resultIndex], paragraph, resultIndex);\n\t      renderResult($scope.type, true);\n\t    } else {\n\t      websocketMsgSrv.commitParagraph(paragraph.id, title, text, newParagraphConfig, params);\n\t    }\n\t  };\n\t\n\t  $scope.toggleGraphSetting = function () {\n\t    var newConfig = angular.copy($scope.config);\n\t    if (newConfig.graph.optionOpen) {\n\t      newConfig.graph.optionOpen = false;\n\t    } else {\n\t      newConfig.graph.optionOpen = true;\n\t    }\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  var getVizConfig = function getVizConfig(vizId) {\n\t    var config;\n\t    var graph = $scope.config.graph;\n\t    if (graph) {\n\t      // copy setting for vizId\n\t      if (graph.setting) {\n\t        config = angular.copy(graph.setting[vizId]);\n\t      }\n\t\n\t      if (!config) {\n\t        config = {};\n\t      }\n\t\n\t      // copy common setting\n\t      config.common = angular.copy(graph.commonSetting) || {};\n\t\n\t      // copy pivot setting\n\t      if (graph.keys) {\n\t        config.common.pivot = {\n\t          keys: angular.copy(graph.keys),\n\t          groups: angular.copy(graph.groups),\n\t          values: angular.copy(graph.values)\n\t        };\n\t      }\n\t    }\n\t    console.log('getVizConfig', config);\n\t    return config;\n\t  };\n\t\n\t  var commitVizConfigChange = function commitVizConfigChange(config, vizId) {\n\t    var newConfig = angular.copy($scope.config);\n\t    if (!newConfig.graph) {\n\t      newConfig.graph = {};\n\t    }\n\t\n\t    // copy setting for vizId\n\t    if (!newConfig.graph.setting) {\n\t      newConfig.graph.setting = {};\n\t    }\n\t    newConfig.graph.setting[vizId] = angular.copy(config);\n\t\n\t    // copy common setting\n\t    if (newConfig.graph.setting[vizId]) {\n\t      newConfig.graph.commonSetting = newConfig.graph.setting[vizId].common;\n\t      delete newConfig.graph.setting[vizId].common;\n\t    }\n\t\n\t    // copy pivot setting\n\t    if (newConfig.graph.commonSetting && newConfig.graph.commonSetting.pivot) {\n\t      newConfig.graph.keys = newConfig.graph.commonSetting.pivot.keys;\n\t      newConfig.graph.groups = newConfig.graph.commonSetting.pivot.groups;\n\t      newConfig.graph.values = newConfig.graph.commonSetting.pivot.values;\n\t      delete newConfig.graph.commonSetting.pivot;\n\t    }\n\t    console.log('committVizConfig', newConfig);\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  $scope.$on('paragraphResized', function (event, paragraphId) {\n\t    // paragraph col width changed\n\t    if (paragraphId === paragraph.id) {\n\t      var builtInViz = builtInVisualizations[$scope.graphMode];\n\t      if (builtInViz && builtInViz.instance) {\n\t        builtInViz.instance.resize();\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.resize = function (width, height) {\n\t    $timeout(function () {\n\t      changeHeight(width, height);\n\t    }, 200);\n\t  };\n\t\n\t  var changeHeight = function changeHeight(width, height) {\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t    var newConfig = angular.copy($scope.config);\n\t\n\t    newConfig.graph.height = height;\n\t    paragraph.config.colWidth = width;\n\t\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  $scope.exportToDSV = function (delimiter) {\n\t    var dsv = '';\n\t    var dateFinished = moment(paragraph.dateFinished).format('YYYY-MM-DD hh:mm:ss A');\n\t    var exportedFileName = paragraph.title ? paragraph.title + '_' + dateFinished : 'data_' + dateFinished;\n\t\n\t    for (var titleIndex in tableData.columns) {\n\t      dsv += tableData.columns[titleIndex].name + delimiter;\n\t    }\n\t    dsv = dsv.substring(0, dsv.length - 1) + '\\n';\n\t    for (var r in tableData.rows) {\n\t      var row = tableData.rows[r];\n\t      var dsvRow = '';\n\t      for (var index in row) {\n\t        var stringValue = row[index].toString();\n\t        if (stringValue.indexOf(delimiter) > -1) {\n\t          dsvRow += '\"' + stringValue + '\"' + delimiter;\n\t        } else {\n\t          dsvRow += row[index] + delimiter;\n\t        }\n\t      }\n\t      dsv += dsvRow.substring(0, dsvRow.length - 1) + '\\n';\n\t    }\n\t    var extension = '';\n\t    if (delimiter === '\\t') {\n\t      extension = 'tsv';\n\t    } else if (delimiter === ',') {\n\t      extension = 'csv';\n\t    }\n\t    saveAsService.saveAs(dsv, exportedFileName, extension);\n\t  };\n\t\n\t  $scope.getBase64ImageSrc = function (base64Data) {\n\t    return 'data:image/png;base64,' + base64Data;\n\t  };\n\t\n\t  // Helium ----------------\n\t  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n\t\n\t  // app states\n\t  $scope.apps = [];\n\t\n\t  // suggested apps\n\t  $scope.suggestion = {};\n\t\n\t  $scope.switchApp = function (appId) {\n\t    var newConfig = angular.copy($scope.config);\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t\n\t    // 'helium.activeApp' can be cleared by switchViz()\n\t    _.set(newConfig, 'helium.activeApp', appId);\n\t\n\t    commitConfig(newConfig, newParams);\n\t  };\n\t\n\t  $scope.loadApp = function (heliumPackage) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    $http.post(baseUrlSrv.getRestApiBase() + '/helium/load/' + noteId + '/' + paragraph.id, heliumPackage).success(function (data, status, headers, config) {\n\t      console.log('Load app %o', data);\n\t    }).error(function (err, status, headers, config) {\n\t      console.log('Error %o', err);\n\t    });\n\t  };\n\t\n\t  var commitConfig = function commitConfig(config, params) {\n\t    commitParagraphResult(paragraph.title, paragraph.text, config, params);\n\t  };\n\t\n\t  var getApplicationStates = function getApplicationStates() {\n\t    var appStates = [];\n\t\n\t    // Display ApplicationState\n\t    if (paragraph.apps) {\n\t      _.forEach(paragraph.apps, function (app) {\n\t        appStates.push({\n\t          id: app.id,\n\t          pkg: app.pkg,\n\t          status: app.status,\n\t          output: app.output\n\t        });\n\t      });\n\t    }\n\t\n\t    // update or remove app states no longer exists\n\t    _.forEach($scope.apps, function (currentAppState, idx) {\n\t      var newAppState = _.find(appStates, { id: currentAppState.id });\n\t      if (newAppState) {\n\t        angular.extend($scope.apps[idx], newAppState);\n\t      } else {\n\t        $scope.apps.splice(idx, 1);\n\t      }\n\t    });\n\t\n\t    // add new app states\n\t    _.forEach(appStates, function (app, idx) {\n\t      if ($scope.apps.length <= idx || $scope.apps[idx].id !== app.id) {\n\t        $scope.apps.splice(idx, 0, app);\n\t      }\n\t    });\n\t  };\n\t\n\t  var getSuggestions = function getSuggestions() {\n\t    // Get suggested apps\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!noteId) {\n\t      return;\n\t    }\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/helium/suggest/' + noteId + '/' + paragraph.id).success(function (data, status, headers, config) {\n\t      $scope.suggestion = data.body;\n\t    }).error(function (err, status, headers, config) {\n\t      console.log('Error %o', err);\n\t    });\n\t  };\n\t\n\t  var renderApp = function renderApp(appState) {\n\t    var retryRenderer = function retryRenderer() {\n\t      var targetEl = angular.element(document.getElementById('p' + appState.id));\n\t      console.log('retry renderApp %o', targetEl);\n\t      if (targetEl.length) {\n\t        try {\n\t          console.log('renderApp %o', appState);\n\t          targetEl.html(appState.output);\n\t          $compile(targetEl.contents())(getAppScope(appState));\n\t        } catch (err) {\n\t          console.log('App rendering error %o', err);\n\t        }\n\t      } else {\n\t        $timeout(retryRenderer, 1000);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t  $scope.$on('appendAppOutput', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (app) {\n\t        app.output += data.data;\n\t\n\t        var paragraphAppState = _.find(paragraph.apps, { id: data.appId });\n\t        paragraphAppState.output = app.output;\n\t\n\t        var targetEl = angular.element(document.getElementById('p' + app.id));\n\t        targetEl.html(app.output);\n\t        $compile(targetEl.contents())(getAppScope(app));\n\t        console.log('append app output %o', $scope.apps);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateAppOutput', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (app) {\n\t        app.output = data.data;\n\t\n\t        var paragraphAppState = _.find(paragraph.apps, { id: data.appId });\n\t        paragraphAppState.output = app.output;\n\t\n\t        var targetEl = angular.element(document.getElementById('p' + app.id));\n\t        targetEl.html(app.output);\n\t        $compile(targetEl.contents())(getAppScope(app));\n\t        console.log('append app output');\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('appLoad', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (!app) {\n\t        app = {\n\t          id: data.appId,\n\t          pkg: data.pkg,\n\t          status: 'UNLOADED',\n\t          output: ''\n\t        };\n\t\n\t        $scope.apps.push(app);\n\t        paragraph.apps.push(app);\n\t        $scope.switchApp(app.id);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('appStatusChange', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (app) {\n\t        app.status = data.status;\n\t        var paragraphAppState = _.find(paragraph.apps, { id: data.appId });\n\t        paragraphAppState.status = app.status;\n\t      }\n\t    }\n\t  });\n\t\n\t  var getAppRegistry = function getAppRegistry(appState) {\n\t    if (!appState.registry) {\n\t      appState.registry = {};\n\t    }\n\t\n\t    return appState.registry;\n\t  };\n\t\n\t  var getAppScope = function getAppScope(appState) {\n\t    if (!appState.scope) {\n\t      appState.scope = $rootScope.$new(true, $rootScope);\n\t    }\n\t    return appState.scope;\n\t  };\n\t\n\t  $scope.$on('angularObjectUpdate', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      var app = _.find($scope.apps, { id: data.paragraphId });\n\t      if (app) {\n\t        scope = getAppScope(app);\n\t        registry = getAppRegistry(app);\n\t      } else {\n\t        // no matching app in this paragraph\n\t        return;\n\t      }\n\t\n\t      var varName = data.angularObject.name;\n\t\n\t      if (angular.equals(data.angularObject.object, scope[varName])) {\n\t        // return when update has no change\n\t        return;\n\t      }\n\t\n\t      if (!registry[varName]) {\n\t        registry[varName] = {\n\t          interpreterGroupId: data.interpreterGroupId,\n\t          noteId: data.noteId,\n\t          paragraphId: data.paragraphId\n\t        };\n\t      } else {\n\t        registry[varName].noteId = registry[varName].noteId || data.noteId;\n\t        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n\t      }\n\t\n\t      registry[varName].skipEmit = true;\n\t\n\t      if (!registry[varName].clearWatcher) {\n\t        registry[varName].clearWatcher = scope.$watch(varName, function (newValue, oldValue) {\n\t          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n\t          if (registry[varName].skipEmit) {\n\t            registry[varName].skipEmit = false;\n\t            return;\n\t          }\n\t          websocketMsgSrv.updateAngularObject(registry[varName].noteId, registry[varName].paragraphId, varName, newValue, registry[varName].interpreterGroupId);\n\t        });\n\t      }\n\t      console.log('angular object (paragraph) created %o', varName);\n\t      scope[varName] = data.angularObject.object;\n\t\n\t      // create proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = function () {\n\t          scope[varName] = arguments;\n\t          console.log('angular function (paragraph) invoked %o', arguments);\n\t        };\n\t\n\t        console.log('angular function (paragraph) created %o', scope[funcName]);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('angularObjectRemove', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      var app = _.find($scope.apps, { id: data.paragraphId });\n\t      if (app) {\n\t        scope = getAppScope(app);\n\t        registry = getAppRegistry(app);\n\t      } else {\n\t        // no matching app in this paragraph\n\t        return;\n\t      }\n\t\n\t      var varName = data.name;\n\t\n\t      // clear watcher\n\t      if (registry[varName]) {\n\t        registry[varName].clearWatcher();\n\t        registry[varName] = undefined;\n\t      }\n\t\n\t      // remove scope variable\n\t      scope[varName] = undefined;\n\t\n\t      // remove proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = undefined;\n\t      }\n\t    }\n\t  });\n\t};\n\n/***/ },\n/* 28 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the 'License');\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an 'AS IS' BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('SearchResultCtrl', SearchResultCtrl);\n\t\n\tSearchResultCtrl.$inject = ['$scope', '$routeParams', 'searchService'];\n\t\n\tfunction SearchResultCtrl($scope, $routeParams, searchService) {\n\t  $scope.isResult = true;\n\t  $scope.searchTerm = $routeParams.searchTerm;\n\t  var results = searchService.search({ 'q': $routeParams.searchTerm }).query();\n\t\n\t  results.$promise.then(function (result) {\n\t    $scope.notes = result.body.map(function (note) {\n\t      // redirect to notebook when search result is a notebook itself,\n\t      // not a paragraph\n\t      if (!/\\/paragraph\\//.test(note.id)) {\n\t        return note;\n\t      }\n\t\n\t      note.id = note.id.replace('paragraph/', '?paragraph=') + '&term=' + $routeParams.searchTerm;\n\t\n\t      return note;\n\t    });\n\t    if ($scope.notes.length === 0) {\n\t      $scope.isResult = false;\n\t    } else {\n\t      $scope.isResult = true;\n\t    }\n\t\n\t    $scope.$on('$routeChangeStart', function (event, next, current) {\n\t      if (next.originalPath !== '/search/:searchTerm') {\n\t        searchService.searchTerm = '';\n\t      }\n\t    });\n\t  });\n\t\n\t  $scope.page = 0;\n\t  $scope.allResults = false;\n\t\n\t  $scope.highlightSearchResults = function (note) {\n\t    return function (_editor) {\n\t      function getEditorMode(text) {\n\t        var editorModes = {\n\t          'ace/mode/scala': /^%(\\w*\\.)?spark/,\n\t          'ace/mode/python': /^%(\\w*\\.)?(pyspark|python)/,\n\t          'ace/mode/r': /^%(\\w*\\.)?(r|sparkr|knitr)/,\n\t          'ace/mode/sql': /^%(\\w*\\.)?\\wql/,\n\t          'ace/mode/markdown': /^%md/,\n\t          'ace/mode/sh': /^%sh/\n\t        };\n\t\n\t        return Object.keys(editorModes).reduce(function (res, mode) {\n\t          return editorModes[mode].test(text) ? mode : res;\n\t        }, 'ace/mode/scala');\n\t      }\n\t\n\t      var Range = ace.require('ace/range').Range;\n\t\n\t      _editor.setOption('highlightActiveLine', false);\n\t      _editor.$blockScrolling = Infinity;\n\t      _editor.setReadOnly(true);\n\t      _editor.renderer.setShowGutter(false);\n\t      _editor.setTheme('ace/theme/chrome');\n\t      _editor.getSession().setMode(getEditorMode(note.text));\n\t\n\t      function getIndeces(term) {\n\t        return function (str) {\n\t          var indeces = [];\n\t          var i = -1;\n\t          while ((i = str.indexOf(term, i + 1)) >= 0) {\n\t            indeces.push(i);\n\t          }\n\t          return indeces;\n\t        };\n\t      }\n\t\n\t      var result = '';\n\t      if (note.header !== '') {\n\t        result = note.header + '\\n\\n' + note.snippet;\n\t      } else {\n\t        result = note.snippet;\n\t      }\n\t\n\t      var lines = result.split('\\n').map(function (line, row) {\n\t\n\t        var match = line.match(/<B>(.+?)<\\/B>/);\n\t\n\t        // return early if nothing to highlight\n\t        if (!match) {\n\t          return line;\n\t        }\n\t\n\t        var term = match[1];\n\t        var __line = line.replace(/<B>/g, '').replace(/<\\/B>/g, '');\n\t\n\t        var indeces = getIndeces(term)(__line);\n\t\n\t        indeces.forEach(function (start) {\n\t          var end = start + term.length;\n\t          if (note.header !== '' && row === 0) {\n\t            _editor.getSession().addMarker(new Range(row, 0, row, line.length), 'search-results-highlight-header', 'background');\n\t            _editor.getSession().addMarker(new Range(row, start, row, end), 'search-results-highlight', 'line');\n\t          } else {\n\t            _editor.getSession().addMarker(new Range(row, start, row, end), 'search-results-highlight', 'line');\n\t          }\n\t        });\n\t        return __line;\n\t      });\n\t\n\t      // resize editor based on content length\n\t      _editor.setOption('maxLines', lines.reduce(function (len, line) {\n\t        return len + line.length;\n\t      }, 0));\n\t\n\t      _editor.getSession().setValue(lines.join('\\n'));\n\t    };\n\t  };\n\t}\n\n/***/ },\n/* 29 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NotebookReposCtrl', NotebookReposCtrl);\n\t\n\tNotebookReposCtrl.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\t\n\tfunction NotebookReposCtrl($http, baseUrlSrv, ngToast) {\n\t  var vm = this;\n\t  vm.notebookRepos = [];\n\t  vm.showDropdownSelected = showDropdownSelected;\n\t  vm.saveNotebookRepo = saveNotebookRepo;\n\t\n\t  _init();\n\t\n\t  // Public functions\n\t\n\t  function saveNotebookRepo(valueform, repo, data) {\n\t    console.log('data %o', data);\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/notebook-repositories', {\n\t      'name': repo.className,\n\t      'settings': data\n\t    }).success(function (data) {\n\t      var index = _.findIndex(vm.notebookRepos, { 'className': repo.className });\n\t      if (index >= 0) {\n\t        vm.notebookRepos[index] = data.body;\n\t        console.log('repos %o, data %o', vm.notebookRepos, data.body);\n\t      }\n\t      valueform.$show();\n\t    }).error(function () {\n\t      ngToast.danger({\n\t        content: 'We couldn\\'t save that NotebookRepo\\'s settings',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      valueform.$show();\n\t    });\n\t\n\t    return 'manual';\n\t  }\n\t\n\t  function showDropdownSelected(setting) {\n\t    var index = _.findIndex(setting.value, { 'value': setting.selected });\n\t    if (index < 0) {\n\t      return 'No value';\n\t    } else {\n\t      return setting.value[index].name;\n\t    }\n\t  }\n\t\n\t  // Private functions\n\t\n\t  function _getInterpreterSettings() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/notebook-repositories').success(function (data, status, headers, config) {\n\t      vm.notebookRepos = data.body;\n\t      console.log('ya notebookRepos %o', vm.notebookRepos);\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  }\n\t\n\t  function _init() {\n\t    _getInterpreterSettings();\n\t  };\n\t}\n\n/***/ },\n/* 30 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t(function () {\n\t\n\t  angular.module('zeppelinWebApp').controller('HeliumCtrl', HeliumCtrl);\n\t\n\t  HeliumCtrl.$inject = ['$scope', '$rootScope', '$sce', 'baseUrlSrv', 'ngToast', 'heliumService'];\n\t\n\t  function HeliumCtrl($scope, $rootScope, $sce, baseUrlSrv, ngToast, heliumService) {\n\t    $scope.packageInfos = {};\n\t    $scope.defaultVersions = {};\n\t    $scope.showVersions = {};\n\t    $scope.visualizationOrder = [];\n\t    $scope.visualizationOrderChanged = false;\n\t\n\t    var buildDefaultVersionListToDisplay = function buildDefaultVersionListToDisplay(packageInfos) {\n\t      var defaultVersions = {};\n\t      // show enabled version if any version of package is enabled\n\t      for (var name in packageInfos) {\n\t        var pkgs = packageInfos[name];\n\t        for (var pkgIdx in pkgs) {\n\t          var pkg = pkgs[pkgIdx];\n\t          pkg.pkg.icon = $sce.trustAsHtml(pkg.pkg.icon);\n\t          if (pkg.enabled) {\n\t            defaultVersions[name] = pkg;\n\t            pkgs.splice(pkgIdx, 1);\n\t            break;\n\t          }\n\t        }\n\t\n\t        // show first available version if package is not enabled\n\t        if (!defaultVersions[name]) {\n\t          defaultVersions[name] = pkgs[0];\n\t          pkgs.splice(0, 1);\n\t        }\n\t      }\n\t      $scope.defaultVersions = defaultVersions;\n\t    };\n\t\n\t    var getAllPackageInfo = function getAllPackageInfo() {\n\t      heliumService.getAllPackageInfo().success(function (data, status) {\n\t        $scope.packageInfos = data.body;\n\t        buildDefaultVersionListToDisplay($scope.packageInfos);\n\t      }).error(function (data, status) {\n\t        console.log('Can not load package info %o %o', status, data);\n\t      });\n\t    };\n\t\n\t    var getVisualizationOrder = function getVisualizationOrder() {\n\t      heliumService.getVisualizationOrder().success(function (data, status) {\n\t        $scope.visualizationOrder = data.body;\n\t      }).error(function (data, status) {\n\t        console.log('Can not get visualization order %o %o', status, data);\n\t      });\n\t    };\n\t\n\t    $scope.visualizationOrderListeners = {\n\t      accept: function accept(sourceItemHandleScope, destSortableScope) {\n\t        return true;\n\t      },\n\t      itemMoved: function itemMoved(event) {},\n\t      orderChanged: function orderChanged(event) {\n\t        $scope.visualizationOrderChanged = true;\n\t      }\n\t    };\n\t\n\t    var init = function init() {\n\t      getAllPackageInfo();\n\t      getVisualizationOrder();\n\t      $scope.visualizationOrderChanged = false;\n\t    };\n\t\n\t    init();\n\t\n\t    $scope.saveVisualizationOrder = function () {\n\t      var confirm = BootstrapDialog.confirm({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: '',\n\t        message: 'Save changes?',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            confirm.$modalFooter.find('button').addClass('disabled');\n\t            confirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n\t            heliumService.setVisualizationOrder($scope.visualizationOrder).success(function (data, status) {\n\t              init();\n\t              confirm.close();\n\t            }).error(function (data, status) {\n\t              confirm.close();\n\t              console.log('Failed to save order');\n\t              BootstrapDialog.show({\n\t                title: 'Error on saving order ',\n\t                message: data.message\n\t              });\n\t            });\n\t            return false;\n\t          }\n\t        }\n\t      });\n\t    };\n\t\n\t    var getLicense = function getLicense(name, artifact) {\n\t      var pkg = _.filter($scope.defaultVersions[name], function (p) {\n\t        return p.artifact === artifact;\n\t      });\n\t\n\t      var license;\n\t      if (pkg.length === 0) {\n\t        pkg = _.filter($scope.packageInfos[name], function (p) {\n\t          return p.pkg.artifact === artifact;\n\t        });\n\t\n\t        if (pkg.length > 0) {\n\t          license = pkg[0].pkg.license;\n\t        }\n\t      } else {\n\t        license = pkg[0].license;\n\t      }\n\t\n\t      if (!license) {\n\t        license = 'Unknown';\n\t      }\n\t      return license;\n\t    };\n\t\n\t    $scope.enable = function (name, artifact) {\n\t      var license = getLicense(name, artifact);\n\t\n\t      var confirm = BootstrapDialog.confirm({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: '',\n\t        message: 'Do you want to enable ' + name + '?' + '<div style=\"color:gray\">' + artifact + '</div>' + '<div style=\"border-top: 1px solid #efefef; margin-top: 10px; padding-top: 5px;\">License</div>' + '<div style=\"color:gray\">' + license + '</div>',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            confirm.$modalFooter.find('button').addClass('disabled');\n\t            confirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n\t            heliumService.enable(name, artifact).success(function (data, status) {\n\t              init();\n\t              confirm.close();\n\t            }).error(function (data, status) {\n\t              confirm.close();\n\t              console.log('Failed to enable package %o %o. %o', name, artifact, data);\n\t              BootstrapDialog.show({\n\t                title: 'Error on enabling ' + name,\n\t                message: data.message\n\t              });\n\t            });\n\t            return false;\n\t          }\n\t        }\n\t      });\n\t    };\n\t\n\t    $scope.disable = function (name) {\n\t      var confirm = BootstrapDialog.confirm({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: '',\n\t        message: 'Do you want to disable ' + name + '?',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            confirm.$modalFooter.find('button').addClass('disabled');\n\t            confirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Disabling');\n\t            heliumService.disable(name).success(function (data, status) {\n\t              init();\n\t              confirm.close();\n\t            }).error(function (data, status) {\n\t              confirm.close();\n\t              console.log('Failed to disable package %o. %o', name, data);\n\t              BootstrapDialog.show({\n\t                title: 'Error on disabling ' + name,\n\t                message: data.message\n\t              });\n\t            });\n\t            return false;\n\t          }\n\t        }\n\t      });\n\t    };\n\t\n\t    $scope.toggleVersions = function (pkgName) {\n\t      if ($scope.showVersions[pkgName]) {\n\t        $scope.showVersions[pkgName] = false;\n\t      } else {\n\t        $scope.showVersions[pkgName] = true;\n\t      }\n\t    };\n\t  }\n\t})();\n\n/***/ },\n/* 31 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('arrayOrderingSrv', arrayOrderingSrv);\n\t\n\tarrayOrderingSrv.$inject = ['TRASH_FOLDER_ID'];\n\t\n\tfunction arrayOrderingSrv(TRASH_FOLDER_ID) {\n\t  var arrayOrderingSrv = this;\n\t\n\t  this.noteListOrdering = function (note) {\n\t    if (note.id === TRASH_FOLDER_ID) {\n\t      return '\\uFFFF';\n\t    }\n\t    return arrayOrderingSrv.getNoteName(note);\n\t  };\n\t\n\t  this.getNoteName = function (note) {\n\t    if (note.name === undefined || note.name.trim() === '') {\n\t      return 'Note ' + note.id;\n\t    } else {\n\t      return note.name;\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 32 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\tangular.module('zeppelinWebApp').controller('clipboardCtrl', clipboardCtrl);\n\tclipboardCtrl.$inject = ['$scope'];\n\t\n\tfunction clipboardCtrl($scope) {\n\t  $scope.complete = function (e) {\n\t    $scope.copied = true;\n\t    $scope.tooltip = 'Copied!';\n\t    setTimeout(function () {\n\t      $scope.tooltip = 'Copy to clipboard';\n\t    }, 400);\n\t  };\n\t  $scope.$watch('input', function () {\n\t    $scope.copied = false;\n\t    $scope.tooltip = 'Copy to clipboard';\n\t  });\n\t  $scope.clipError = function (e) {\n\t    console.log('Error: ' + e.name + ' - ' + e.message);\n\t    $scope.tooltip = 'Not supported browser';\n\t  };\n\t}\n\n/***/ },\n/* 33 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NavCtrl', NavCtrl);\n\t\n\tNavCtrl.$inject = ['$scope', '$rootScope', '$http', '$routeParams', '$location', 'noteListDataFactory', 'baseUrlSrv', 'websocketMsgSrv', 'arrayOrderingSrv', 'searchService', 'TRASH_FOLDER_ID'];\n\t\n\tfunction NavCtrl($scope, $rootScope, $http, $routeParams, $location, noteListDataFactory, baseUrlSrv, websocketMsgSrv, arrayOrderingSrv, searchService, TRASH_FOLDER_ID) {\n\t  var vm = this;\n\t  vm.arrayOrderingSrv = arrayOrderingSrv;\n\t  vm.connected = websocketMsgSrv.isConnected();\n\t  vm.isActive = isActive;\n\t  vm.logout = logout;\n\t  vm.notes = noteListDataFactory;\n\t  vm.search = search;\n\t  vm.searchForm = searchService;\n\t  vm.showLoginWindow = showLoginWindow;\n\t  vm.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n\t  vm.isFilterNote = isFilterNote;\n\t\n\t  $scope.query = { q: '' };\n\t\n\t  initController();\n\t\n\t  function getZeppelinVersion() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/version').success(function (data, status, headers, config) {\n\t      $rootScope.zeppelinVersion = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  }\n\t\n\t  function initController() {\n\t    $scope.isDrawNavbarNoteList = false;\n\t    angular.element('#notebook-list').perfectScrollbar({ suppressScrollX: true });\n\t\n\t    angular.element(document).click(function () {\n\t      $scope.query.q = '';\n\t    });\n\t\n\t    getZeppelinVersion();\n\t    loadNotes();\n\t  }\n\t\n\t  function isFilterNote(note) {\n\t    if (!$scope.query.q) {\n\t      return true;\n\t    }\n\t\n\t    var noteName = note.name;\n\t    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n\t      return true;\n\t    }\n\t    return false;\n\t  }\n\t\n\t  function isActive(noteId) {\n\t    return $routeParams.noteId === noteId;\n\t  }\n\t\n\t  function listConfigurations() {\n\t    websocketMsgSrv.listConfigurations();\n\t  }\n\t\n\t  function loadNotes() {\n\t    websocketMsgSrv.getNoteList();\n\t  }\n\t\n\t  function getHomeNote() {\n\t    websocketMsgSrv.getHomeNote();\n\t  }\n\t\n\t  function logout() {\n\t    var logoutURL = baseUrlSrv.getRestApiBase() + '/login/logout';\n\t\n\t    //for firefox and safari\n\t    logoutURL = logoutURL.replace('//', '//false:false@');\n\t    $http.post(logoutURL).error(function () {\n\t      //force authcBasic (if configured) to logout\n\t      $http.post(logoutURL).error(function () {\n\t        $rootScope.userName = '';\n\t        $rootScope.ticket.principal = '';\n\t        $rootScope.ticket.ticket = '';\n\t        $rootScope.ticket.roles = '';\n\t        BootstrapDialog.show({\n\t          message: 'Logout Success'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 1000);\n\t      });\n\t    });\n\t  }\n\t\n\t  function search(searchTerm) {\n\t    $location.path('/search/' + searchTerm);\n\t  }\n\t\n\t  function showLoginWindow() {\n\t    setTimeout(function () {\n\t      angular.element('#userName').focus();\n\t    }, 500);\n\t  }\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteMenu', function (event, notes) {\n\t    noteListDataFactory.setNotes(notes);\n\t    initNotebookListEventListener();\n\t  });\n\t\n\t  $scope.$on('setConnectedStatus', function (event, param) {\n\t    vm.connected = param;\n\t  });\n\t\n\t  $scope.$on('loginSuccess', function (event, param) {\n\t    listConfigurations();\n\t    loadNotes();\n\t    getHomeNote();\n\t  });\n\t\n\t  /*\n\t   ** Performance optimization for Browser Render.\n\t   */\n\t  function initNotebookListEventListener() {\n\t    angular.element(document).ready(function () {\n\t      angular.element('.notebook-list-dropdown').on('show.bs.dropdown', function () {\n\t        $scope.isDrawNavbarNoteList = true;\n\t      });\n\t\n\t      angular.element('.notebook-list-dropdown').on('hide.bs.dropdown', function () {\n\t        $scope.isDrawNavbarNoteList = false;\n\t      });\n\t    });\n\t  }\n\t}\n\n/***/ },\n/* 34 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('ngEscape', ngEscape);\n\t\n\tfunction ngEscape() {\n\t  return function (scope, element, attrs) {\n\t    element.bind('keydown keyup', function (event) {\n\t      if (event.which === 27) {\n\t        scope.$apply(function () {\n\t          scope.$eval(attrs.ngEscape);\n\t        });\n\t        event.preventDefault();\n\t      }\n\t    });\n\t  };\n\t}\n\n/***/ },\n/* 35 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('interpreterDirective', interpreterDirective);\n\t\n\tinterpreterDirective.$inject = ['$timeout'];\n\t\n\tfunction interpreterDirective($timeout) {\n\t  return {\n\t    restrict: 'A',\n\t    link: function link(scope, element, attr) {\n\t      if (scope.$last === true) {\n\t        $timeout(function () {\n\t          var id = 'ngRenderFinished';\n\t          scope.$emit(id);\n\t        });\n\t      }\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 36 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('expandCollapse', expandCollapse);\n\t\n\tfunction expandCollapse() {\n\t  return {\n\t    restrict: 'EA',\n\t    link: function link(scope, element, attrs) {\n\t      angular.element(element).click(function (event) {\n\t        if (angular.element(element).find('.expandable:visible').length > 1) {\n\t          angular.element(element).find('.expandable:visible').slideUp('slow');\n\t          angular.element(element).find('i.icon-folder-alt').toggleClass('icon-folder icon-folder-alt');\n\t        } else {\n\t          angular.element(element).find('.expandable').first().slideToggle('200', function () {\n\t            // do not toggle trash folder\n\t            if (angular.element(element).find('.fa-trash-o').length === 0) {\n\t              angular.element(element).find('i').first().toggleClass('icon-folder icon-folder-alt');\n\t            }\n\t          });\n\t        }\n\t        event.stopPropagation();\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 37 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NotenameCtrl', NotenameCtrl);\n\t\n\tNotenameCtrl.$inject = ['$scope', 'noteListDataFactory', '$routeParams', 'websocketMsgSrv'];\n\t\n\tfunction NotenameCtrl($scope, noteListDataFactory, $routeParams, websocketMsgSrv) {\n\t  var vm = this;\n\t  vm.clone = false;\n\t  vm.notes = noteListDataFactory;\n\t  vm.websocketMsgSrv = websocketMsgSrv;\n\t  $scope.note = {};\n\t  $scope.interpreterSettings = {};\n\t  $scope.note.defaultInterpreter = null;\n\t\n\t  vm.createNote = function () {\n\t    if (!vm.clone) {\n\t      var defaultInterpreterId = '';\n\t      if ($scope.note.defaultInterpreter !== null) {\n\t        defaultInterpreterId = $scope.note.defaultInterpreter.id;\n\t      }\n\t      vm.websocketMsgSrv.createNotebook($scope.note.notename, defaultInterpreterId);\n\t      $scope.note.defaultInterpreter = $scope.interpreterSettings[0];\n\t    } else {\n\t      var noteId = $routeParams.noteId;\n\t      vm.websocketMsgSrv.cloneNote(noteId, $scope.note.notename);\n\t    }\n\t  };\n\t\n\t  vm.handleNameEnter = function () {\n\t    angular.element('#noteNameModal').modal('toggle');\n\t    vm.createNote();\n\t  };\n\t\n\t  vm.preVisible = function (clone, sourceNoteName) {\n\t    vm.clone = clone;\n\t    vm.sourceNoteName = sourceNoteName;\n\t    $scope.note.notename = vm.clone ? vm.cloneNoteName() : vm.newNoteName();\n\t    $scope.$apply();\n\t  };\n\t\n\t  vm.newNoteName = function () {\n\t    var newCount = 1;\n\t    angular.forEach(vm.notes.flatList, function (noteName) {\n\t      noteName = noteName.name;\n\t      if (noteName.match(/^Untitled Note [0-9]*$/)) {\n\t        var lastCount = noteName.substr(14) * 1;\n\t        if (newCount <= lastCount) {\n\t          newCount = lastCount + 1;\n\t        }\n\t      }\n\t    });\n\t    return 'Untitled Note ' + newCount;\n\t  };\n\t\n\t  vm.cloneNoteName = function () {\n\t    var copyCount = 1;\n\t    var newCloneName = '';\n\t    var lastIndex = vm.sourceNoteName.lastIndexOf(' ');\n\t    var endsWithNumber = !!vm.sourceNoteName.match('^.+?\\\\s\\\\d$');\n\t    var noteNamePrefix = endsWithNumber ? vm.sourceNoteName.substr(0, lastIndex) : vm.sourceNoteName;\n\t    var regexp = new RegExp('^' + noteNamePrefix + ' .+');\n\t\n\t    angular.forEach(vm.notes.flatList, function (noteName) {\n\t      noteName = noteName.name;\n\t      if (noteName.match(regexp)) {\n\t        var lastCopyCount = noteName.substr(lastIndex).trim();\n\t        newCloneName = noteNamePrefix;\n\t        lastCopyCount = parseInt(lastCopyCount);\n\t        if (copyCount <= lastCopyCount) {\n\t          copyCount = lastCopyCount + 1;\n\t        }\n\t      }\n\t    });\n\t\n\t    if (!newCloneName) {\n\t      newCloneName = vm.sourceNoteName;\n\t    }\n\t    return newCloneName + ' ' + copyCount;\n\t  };\n\t\n\t  vm.getInterpreterSettings = function () {\n\t    vm.websocketMsgSrv.getInterpreterSettings();\n\t  };\n\t\n\t  $scope.$on('interpreterSettings', function (event, data) {\n\t    $scope.interpreterSettings = data.interpreterSettings;\n\t\n\t    //initialize default interpreter with Spark interpreter\n\t    $scope.note.defaultInterpreter = data.interpreterSettings[0];\n\t  });\n\t}\n\n/***/ },\n/* 38 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NoteImportCtrl', NoteImportCtrl);\n\t\n\tNoteImportCtrl.$inject = ['$scope', '$timeout', 'websocketMsgSrv'];\n\t\n\tfunction NoteImportCtrl($scope, $timeout, websocketMsgSrv) {\n\t  var vm = this;\n\t  $scope.note = {};\n\t  $scope.note.step1 = true;\n\t  $scope.note.step2 = false;\n\t  $scope.maxLimit = '';\n\t  var limit = 0;\n\t\n\t  websocketMsgSrv.listConfigurations();\n\t  $scope.$on('configurationsInfo', function (scope, event) {\n\t    limit = event.configurations['zeppelin.websocket.max.text.message.size'];\n\t    $scope.maxLimit = Math.round(limit / 1048576);\n\t  });\n\t\n\t  vm.resetFlags = function () {\n\t    $scope.note = {};\n\t    $scope.note.step1 = true;\n\t    $scope.note.step2 = false;\n\t    angular.element('#noteImportFile').val('');\n\t  };\n\t\n\t  $scope.uploadFile = function () {\n\t    angular.element('#noteImportFile').click();\n\t  };\n\t\n\t  $scope.importFile = function (element) {\n\t    $scope.note.errorText = '';\n\t    $scope.note.importFile = element.files[0];\n\t    var file = $scope.note.importFile;\n\t    var reader = new FileReader();\n\t\n\t    if (file.size > limit) {\n\t      $scope.note.errorText = 'File size limit Exceeded!';\n\t      $scope.$apply();\n\t      return;\n\t    }\n\t\n\t    reader.onloadend = function () {\n\t      vm.processImportJson(reader.result);\n\t    };\n\t\n\t    if (file) {\n\t      reader.readAsText(file);\n\t    }\n\t  };\n\t\n\t  $scope.uploadURL = function () {\n\t    $scope.note.errorText = '';\n\t    $scope.note.step1 = false;\n\t    $timeout(function () {\n\t      $scope.note.step2 = true;\n\t    }, 400);\n\t  };\n\t\n\t  vm.importBack = function () {\n\t    $scope.note.errorText = '';\n\t    $timeout(function () {\n\t      $scope.note.step1 = true;\n\t    }, 400);\n\t    $scope.note.step2 = false;\n\t  };\n\t\n\t  vm.importNote = function () {\n\t    $scope.note.errorText = '';\n\t    if ($scope.note.importUrl) {\n\t      jQuery.ajax({\n\t        url: $scope.note.importUrl,\n\t        type: 'GET',\n\t        dataType: 'json',\n\t        jsonp: false,\n\t        xhrFields: {\n\t          withCredentials: false\n\t        },\n\t        error: function error(xhr, ajaxOptions, thrownError) {\n\t          $scope.note.errorText = 'Unable to Fetch URL';\n\t          $scope.$apply();\n\t        } }).done(function (data) {\n\t        vm.processImportJson(data);\n\t      });\n\t    } else {\n\t      $scope.note.errorText = 'Enter URL';\n\t      $scope.$apply();\n\t    }\n\t  };\n\t\n\t  vm.processImportJson = function (result) {\n\t    if ((typeof result === 'undefined' ? 'undefined' : _typeof(result)) !== 'object') {\n\t      try {\n\t        result = JSON.parse(result);\n\t      } catch (e) {\n\t        $scope.note.errorText = 'JSON parse exception';\n\t        $scope.$apply();\n\t        return;\n\t      }\n\t    }\n\t    if (result.paragraphs && result.paragraphs.length > 0) {\n\t      if (!$scope.note.noteImportName) {\n\t        $scope.note.noteImportName = result.name;\n\t      } else {\n\t        result.name = $scope.note.noteImportName;\n\t      }\n\t      websocketMsgSrv.importNote(result);\n\t      //angular.element('#noteImportModal').modal('hide');\n\t    } else {\n\t      $scope.note.errorText = 'Invalid JSON';\n\t    }\n\t    $scope.$apply();\n\t  };\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteMenu', function (event, notes) {\n\t    vm.resetFlags();\n\t    angular.element('#noteImportModal').modal('hide');\n\t  });\n\t}\n\n/***/ },\n/* 39 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('popoverHtmlUnsafe', popoverHtmlUnsafe);\n\t\n\tpopoverHtmlUnsafe.$inject = ['$tooltip'];\n\t\n\tfunction popoverHtmlUnsafe($tooltip) {\n\t  return $tooltip('popoverHtmlUnsafe', 'popover', 'click');\n\t}\n\n/***/ },\n/* 40 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('popoverHtmlUnsafePopup', popoverHtmlUnsafePopup);\n\t\n\tfunction popoverHtmlUnsafePopup() {\n\t  return {\n\t    restrict: 'EA',\n\t    replace: true,\n\t    scope: { title: '@', content: '@', placement: '@', animation: '&', isOpen: '&' },\n\t    templateUrl: 'components/popover-html-unsafe/popover-html-unsafe-popup.html'\n\t  };\n\t}\n\n/***/ },\n/* 41 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tcodeEditor.$inject = [\"$templateRequest\", \"$compile\"];\n\tangular.module('zeppelinWebApp').directive('codeEditor', codeEditor);\n\t\n\tfunction codeEditor($templateRequest, $compile) {\n\t  return {\n\t    restrict: 'AE',\n\t    scope: {\n\t      paragraphId: '=paragraphId',\n\t      paragraph: '=paragraphContext',\n\t      dirtyText: '=dirtyText',\n\t      originalText: '=originalText',\n\t      onLoad: '=onLoad',\n\t      revisionView: '=revisionView'\n\t    },\n\t    link: function link(scope, element, attrs, controller) {\n\t      $templateRequest('components/editor/ace.editor.directive.html').then(function (editorHtml) {\n\t        var editor = angular.element(editorHtml);\n\t        editor.attr('id', scope.paragraphId + '_editor');\n\t        element.append(editor);\n\t        $compile(editor)(scope);\n\t        console.log('codeEditor directive revision view is ' + scope.revisionView);\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 42 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('ngEnter', ngEnter);\n\t\n\tfunction ngEnter() {\n\t  return function (scope, element, attrs) {\n\t    element.bind('keydown keypress', function (event) {\n\t      if (event.which === 13) {\n\t        if (!event.shiftKey) {\n\t          scope.$apply(function () {\n\t            scope.$eval(attrs.ngEnter);\n\t          });\n\t        }\n\t        event.preventDefault();\n\t      }\n\t    });\n\t  };\n\t}\n\n/***/ },\n/* 43 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('dropdownInput', dropdownInput);\n\t\n\tfunction dropdownInput() {\n\t  return {\n\t    restrict: 'A',\n\t    link: function link(scope, element) {\n\t      element.bind('click', function (event) {\n\t        event.stopPropagation();\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 44 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('resizable', resizable);\n\t\n\tfunction resizable() {\n\t  var resizableConfig = {\n\t    autoHide: true,\n\t    handles: 'se',\n\t    helper: 'resizable-helper',\n\t    stop: function stop() {\n\t      angular.element(this).css({ 'width': '100%', 'height': '100%' });\n\t    }\n\t  };\n\t\n\t  return {\n\t    restrict: 'A',\n\t    scope: {\n\t      callback: '&onResize'\n\t    },\n\t    link: function postLink(scope, elem, attrs) {\n\t      attrs.$observe('resize', function (resize) {\n\t        var resetResize = function resetResize(elem, resize) {\n\t          var colStep = window.innerWidth / 12;\n\t          elem.off('resizestop');\n\t          var conf = angular.copy(resizableConfig);\n\t          if (resize.graphType === 'TABLE' || resize.graphType === 'TEXT') {\n\t            conf.grid = [colStep, 10];\n\t            conf.minHeight = 100;\n\t          } else {\n\t            conf.grid = [colStep, 10000];\n\t            conf.minHeight = 0;\n\t          }\n\t          conf.maxWidth = window.innerWidth;\n\t\n\t          elem.resizable(conf);\n\t          elem.on('resizestop', function () {\n\t            if (scope.callback) {\n\t              var height = elem.height();\n\t              if (height < 50) {\n\t                height = 300;\n\t              }\n\t              scope.callback({ width: Math.ceil(elem.width() / colStep), height: height });\n\t            }\n\t          });\n\t        };\n\t\n\t        resize = JSON.parse(resize);\n\t        if (resize.allowresize === 'true') {\n\t          resetResize(elem, resize);\n\t          angular.element(window).resize(function () {\n\t            resetResize(elem, resize);\n\t          });\n\t        }\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 45 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('modalvisible', modalvisible);\n\t\n\tfunction modalvisible() {\n\t  return {\n\t    restrict: 'A',\n\t    scope: {\n\t      preVisibleCallback: '&previsiblecallback',\n\t      postVisibleCallback: '&postvisiblecallback',\n\t      targetinput: '@targetinput'\n\t    },\n\t    link: function link(scope, element, attrs) {\n\t      // Add some listeners\n\t      var previsibleMethod = scope.preVisibleCallback;\n\t      var postVisibleMethod = scope.postVisibleCallback;\n\t      element.on('show.bs.modal', function (e) {\n\t        var relatedTarget = angular.element(e.relatedTarget);\n\t        var clone = relatedTarget.data('clone');\n\t        var sourceNoteName = relatedTarget.data('source-note-name');\n\t        var cloneNote = clone ? true : false;\n\t        previsibleMethod()(cloneNote, sourceNoteName);\n\t      });\n\t      element.on('shown.bs.modal', function (e) {\n\t        if (scope.targetinput) {\n\t          angular.element(e.target).find('input#' + scope.targetinput).select();\n\t        }\n\t        postVisibleMethod();\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 46 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('websocketMsgSrv', websocketMsgSrv);\n\t\n\twebsocketMsgSrv.$inject = ['$rootScope', 'websocketEvents'];\n\t\n\tfunction websocketMsgSrv($rootScope, websocketEvents) {\n\t  return {\n\t\n\t    getHomeNote: function getHomeNote() {\n\t      websocketEvents.sendNewEvent({ op: 'GET_HOME_NOTE' });\n\t    },\n\t\n\t    createNotebook: function createNotebook(noteName, defaultInterpreterId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'NEW_NOTE',\n\t        data: {\n\t          name: noteName,\n\t          defaultInterpreterId: defaultInterpreterId\n\t        }\n\t      });\n\t    },\n\t\n\t    moveNoteToTrash: function moveNoteToTrash(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'MOVE_NOTE_TO_TRASH', data: { id: noteId } });\n\t    },\n\t\n\t    moveFolderToTrash: function moveFolderToTrash(folderId) {\n\t      websocketEvents.sendNewEvent({ op: 'MOVE_FOLDER_TO_TRASH', data: { id: folderId } });\n\t    },\n\t\n\t    restoreNote: function restoreNote(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'RESTORE_NOTE', data: { id: noteId } });\n\t    },\n\t\n\t    restoreFolder: function restoreFolder(folderId) {\n\t      websocketEvents.sendNewEvent({ op: 'RESTORE_FOLDER', data: { id: folderId } });\n\t    },\n\t\n\t    restoreAll: function restoreAll() {\n\t      websocketEvents.sendNewEvent({ op: 'RESTORE_ALL' });\n\t    },\n\t\n\t    deleteNote: function deleteNote(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'DEL_NOTE', data: { id: noteId } });\n\t    },\n\t\n\t    removeFolder: function removeFolder(folderId) {\n\t      websocketEvents.sendNewEvent({ op: 'REMOVE_FOLDER', data: { id: folderId } });\n\t    },\n\t\n\t    emptyTrash: function emptyTrash() {\n\t      websocketEvents.sendNewEvent({ op: 'EMPTY_TRASH' });\n\t    },\n\t\n\t    cloneNote: function cloneNote(noteIdToClone, newNoteName) {\n\t      websocketEvents.sendNewEvent({ op: 'CLONE_NOTE', data: { id: noteIdToClone, name: newNoteName } });\n\t    },\n\t\n\t    getNoteList: function getNoteList() {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_NOTES' });\n\t    },\n\t\n\t    reloadAllNotesFromRepo: function reloadAllNotesFromRepo() {\n\t      websocketEvents.sendNewEvent({ op: 'RELOAD_NOTES_FROM_REPO' });\n\t    },\n\t\n\t    getNote: function getNote(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'GET_NOTE', data: { id: noteId } });\n\t    },\n\t\n\t    updateNote: function updateNote(noteId, noteName, noteConfig) {\n\t      websocketEvents.sendNewEvent({ op: 'NOTE_UPDATE', data: { id: noteId, name: noteName, config: noteConfig } });\n\t    },\n\t\n\t    updatePersonalizedMode: function updatePersonalizedMode(noteId, modeValue) {\n\t      websocketEvents.sendNewEvent({ op: 'UPDATE_PERSONALIZED_MODE', data: { id: noteId, personalized: modeValue } });\n\t    },\n\t\n\t    renameNote: function renameNote(noteId, noteName) {\n\t      websocketEvents.sendNewEvent({ op: 'NOTE_RENAME', data: { id: noteId, name: noteName } });\n\t    },\n\t\n\t    renameFolder: function renameFolder(folderId, folderName) {\n\t      websocketEvents.sendNewEvent({ op: 'FOLDER_RENAME', data: { id: folderId, name: folderName } });\n\t    },\n\t\n\t    moveParagraph: function moveParagraph(paragraphId, newIndex) {\n\t      websocketEvents.sendNewEvent({ op: 'MOVE_PARAGRAPH', data: { id: paragraphId, index: newIndex } });\n\t    },\n\t\n\t    insertParagraph: function insertParagraph(newIndex) {\n\t      websocketEvents.sendNewEvent({ op: 'INSERT_PARAGRAPH', data: { index: newIndex } });\n\t    },\n\t\n\t    copyParagraph: function copyParagraph(newIndex, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'COPY_PARAGRAPH',\n\t        data: {\n\t          index: newIndex,\n\t          title: paragraphTitle,\n\t          paragraph: paragraphData,\n\t          config: paragraphConfig,\n\t          params: paragraphParams\n\t        }\n\t      });\n\t    },\n\t\n\t    updateAngularObject: function updateAngularObject(noteId, paragraphId, name, value, interpreterGroupId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'ANGULAR_OBJECT_UPDATED',\n\t        data: {\n\t          noteId: noteId,\n\t          paragraphId: paragraphId,\n\t          name: name,\n\t          value: value,\n\t          interpreterGroupId: interpreterGroupId\n\t        }\n\t      });\n\t    },\n\t\n\t    clientBindAngularObject: function clientBindAngularObject(noteId, name, value, paragraphId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'ANGULAR_OBJECT_CLIENT_BIND',\n\t        data: {\n\t          noteId: noteId,\n\t          name: name,\n\t          value: value,\n\t          paragraphId: paragraphId\n\t        }\n\t      });\n\t    },\n\t\n\t    clientUnbindAngularObject: function clientUnbindAngularObject(noteId, name, paragraphId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'ANGULAR_OBJECT_CLIENT_UNBIND',\n\t        data: {\n\t          noteId: noteId,\n\t          name: name,\n\t          paragraphId: paragraphId\n\t        }\n\t      });\n\t    },\n\t\n\t    cancelParagraphRun: function cancelParagraphRun(paragraphId) {\n\t      websocketEvents.sendNewEvent({ op: 'CANCEL_PARAGRAPH', data: { id: paragraphId } });\n\t    },\n\t\n\t    runParagraph: function runParagraph(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'RUN_PARAGRAPH',\n\t        data: {\n\t          id: paragraphId,\n\t          title: paragraphTitle,\n\t          paragraph: paragraphData,\n\t          config: paragraphConfig,\n\t          params: paragraphParams\n\t        }\n\t      });\n\t    },\n\t\n\t    runAllParagraphs: function runAllParagraphs(noteId, paragraphs) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'RUN_ALL_PARAGRAPHS',\n\t        data: {\n\t          noteId: noteId,\n\t          paragraphs: JSON.stringify(paragraphs)\n\t        }\n\t      });\n\t    },\n\t\n\t    removeParagraph: function removeParagraph(paragraphId) {\n\t      websocketEvents.sendNewEvent({ op: 'PARAGRAPH_REMOVE', data: { id: paragraphId } });\n\t    },\n\t\n\t    clearParagraphOutput: function clearParagraphOutput(paragraphId) {\n\t      websocketEvents.sendNewEvent({ op: 'PARAGRAPH_CLEAR_OUTPUT', data: { id: paragraphId } });\n\t    },\n\t\n\t    clearAllParagraphOutput: function clearAllParagraphOutput(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'PARAGRAPH_CLEAR_ALL_OUTPUT', data: { id: noteId } });\n\t    },\n\t\n\t    completion: function completion(paragraphId, buf, cursor) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'COMPLETION',\n\t        data: {\n\t          id: paragraphId,\n\t          buf: buf,\n\t          cursor: cursor\n\t        }\n\t      });\n\t    },\n\t\n\t    commitParagraph: function commitParagraph(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'COMMIT_PARAGRAPH',\n\t        data: {\n\t          id: paragraphId,\n\t          title: paragraphTitle,\n\t          paragraph: paragraphData,\n\t          config: paragraphConfig,\n\t          params: paragraphParams\n\t        }\n\t      });\n\t    },\n\t\n\t    importNote: function importNote(note) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'IMPORT_NOTE',\n\t        data: {\n\t          note: note\n\t        }\n\t      });\n\t    },\n\t\n\t    checkpointNote: function checkpointNote(noteId, commitMessage) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'CHECKPOINT_NOTE',\n\t        data: {\n\t          noteId: noteId,\n\t          commitMessage: commitMessage\n\t        }\n\t      });\n\t    },\n\t\n\t    setNoteRevision: function setNoteRevision(noteId, revisionId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'SET_NOTE_REVISION',\n\t        data: {\n\t          noteId: noteId,\n\t          revisionId: revisionId\n\t        }\n\t      });\n\t    },\n\t\n\t    listRevisionHistory: function listRevisionHistory(noteId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'LIST_REVISION_HISTORY',\n\t        data: {\n\t          noteId: noteId\n\t        }\n\t      });\n\t    },\n\t\n\t    getNoteByRevision: function getNoteByRevision(noteId, revisionId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'NOTE_REVISION',\n\t        data: {\n\t          noteId: noteId,\n\t          revisionId: revisionId\n\t        }\n\t      });\n\t    },\n\t\n\t    getEditorSetting: function getEditorSetting(paragraphId, replName) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'EDITOR_SETTING',\n\t        data: {\n\t          paragraphId: paragraphId,\n\t          magic: replName\n\t        }\n\t      });\n\t    },\n\t\n\t    isConnected: function isConnected() {\n\t      return websocketEvents.isConnected();\n\t    },\n\t\n\t    getNoteJobsList: function getNoteJobsList() {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_NOTE_JOBS' });\n\t    },\n\t\n\t    getUpdateNoteJobsList: function getUpdateNoteJobsList(lastUpdateServerUnixTime) {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_UPDATE_NOTE_JOBS', data: { lastUpdateUnixTime: lastUpdateServerUnixTime * 1 } });\n\t    },\n\t\n\t    unsubscribeJobManager: function unsubscribeJobManager() {\n\t      websocketEvents.sendNewEvent({ op: 'UNSUBSCRIBE_UPDATE_NOTE_JOBS' });\n\t    },\n\t\n\t    getInterpreterBindings: function getInterpreterBindings(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'GET_INTERPRETER_BINDINGS', data: { noteId: noteId } });\n\t    },\n\t\n\t    saveInterpreterBindings: function saveInterpreterBindings(noteId, selectedSettingIds) {\n\t      websocketEvents.sendNewEvent({ op: 'SAVE_INTERPRETER_BINDINGS',\n\t        data: { noteId: noteId, selectedSettingIds: selectedSettingIds } });\n\t    },\n\t\n\t    listConfigurations: function listConfigurations() {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_CONFIGURATIONS' });\n\t    },\n\t\n\t    getInterpreterSettings: function getInterpreterSettings() {\n\t      websocketEvents.sendNewEvent({ op: 'GET_INTERPRETER_SETTINGS' });\n\t    }\n\t\n\t  };\n\t}\n\n/***/ },\n/* 47 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').factory('websocketEvents', websocketEvents);\n\t\n\twebsocketEvents.$inject = ['$rootScope', '$websocket', '$location', 'baseUrlSrv'];\n\t\n\tfunction websocketEvents($rootScope, $websocket, $location, baseUrlSrv) {\n\t  var websocketCalls = {};\n\t  var pingIntervalId;\n\t\n\t  websocketCalls.ws = $websocket(baseUrlSrv.getWebsocketUrl());\n\t  websocketCalls.ws.reconnectIfNotNormalClose = true;\n\t\n\t  websocketCalls.ws.onOpen(function () {\n\t    console.log('Websocket created');\n\t    $rootScope.$broadcast('setConnectedStatus', true);\n\t    pingIntervalId = setInterval(function () {\n\t      websocketCalls.sendNewEvent({ op: 'PING' });\n\t    }, 10000);\n\t  });\n\t\n\t  websocketCalls.sendNewEvent = function (data) {\n\t    if ($rootScope.ticket !== undefined) {\n\t      data.principal = $rootScope.ticket.principal;\n\t      data.ticket = $rootScope.ticket.ticket;\n\t      data.roles = $rootScope.ticket.roles;\n\t    } else {\n\t      data.principal = '';\n\t      data.ticket = '';\n\t      data.roles = '';\n\t    }\n\t    console.log('Send >> %o, %o, %o, %o, %o', data.op, data.principal, data.ticket, data.roles, data);\n\t    websocketCalls.ws.send(JSON.stringify(data));\n\t  };\n\t\n\t  websocketCalls.isConnected = function () {\n\t    return websocketCalls.ws.socket.readyState === 1;\n\t  };\n\t\n\t  websocketCalls.ws.onMessage(function (event) {\n\t    var payload;\n\t    if (event.data) {\n\t      payload = angular.fromJson(event.data);\n\t    }\n\t    console.log('Receive << %o, %o', payload.op, payload);\n\t    var op = payload.op;\n\t    var data = payload.data;\n\t    if (op === 'NOTE') {\n\t      $rootScope.$broadcast('setNoteContent', data.note);\n\t    } else if (op === 'NEW_NOTE') {\n\t      $location.path('/notebook/' + data.note.id);\n\t    } else if (op === 'NOTES_INFO') {\n\t      $rootScope.$broadcast('setNoteMenu', data.notes);\n\t    } else if (op === 'LIST_NOTE_JOBS') {\n\t      $rootScope.$broadcast('setNoteJobs', data.noteJobs);\n\t    } else if (op === 'LIST_UPDATE_NOTE_JOBS') {\n\t      $rootScope.$broadcast('setUpdateNoteJobs', data.noteRunningJobs);\n\t    } else if (op === 'AUTH_INFO') {\n\t      var btn = [];\n\t      if ($rootScope.ticket.roles === '[]') {\n\t        btn = [{\n\t          label: 'Close',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t          }\n\t        }];\n\t      } else {\n\t        btn = [{\n\t          label: 'Login',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            angular.element('#loginModal').modal({\n\t              show: 'true'\n\t            });\n\t          }\n\t        }, {\n\t          label: 'Cancel',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            // using $rootScope.apply to trigger angular digest cycle\n\t            // changing $location.path inside bootstrap modal wont trigger digest\n\t            $rootScope.$apply(function () {\n\t              $location.path('/');\n\t            });\n\t          }\n\t        }];\n\t      }\n\t\n\t      BootstrapDialog.show({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: 'Insufficient privileges',\n\t        message: data.info.toString(),\n\t        buttons: btn\n\t      });\n\t    } else if (op === 'PARAGRAPH') {\n\t      $rootScope.$broadcast('updateParagraph', data);\n\t    } else if (op === 'PARAGRAPH_APPEND_OUTPUT') {\n\t      $rootScope.$broadcast('appendParagraphOutput', data);\n\t    } else if (op === 'PARAGRAPH_UPDATE_OUTPUT') {\n\t      $rootScope.$broadcast('updateParagraphOutput', data);\n\t    } else if (op === 'PROGRESS') {\n\t      $rootScope.$broadcast('updateProgress', data);\n\t    } else if (op === 'COMPLETION_LIST') {\n\t      $rootScope.$broadcast('completionList', data);\n\t    } else if (op === 'EDITOR_SETTING') {\n\t      $rootScope.$broadcast('editorSetting', data);\n\t    } else if (op === 'ANGULAR_OBJECT_UPDATE') {\n\t      $rootScope.$broadcast('angularObjectUpdate', data);\n\t    } else if (op === 'ANGULAR_OBJECT_REMOVE') {\n\t      $rootScope.$broadcast('angularObjectRemove', data);\n\t    } else if (op === 'APP_APPEND_OUTPUT') {\n\t      $rootScope.$broadcast('appendAppOutput', data);\n\t    } else if (op === 'APP_UPDATE_OUTPUT') {\n\t      $rootScope.$broadcast('updateAppOutput', data);\n\t    } else if (op === 'APP_LOAD') {\n\t      $rootScope.$broadcast('appLoad', data);\n\t    } else if (op === 'APP_STATUS_CHANGE') {\n\t      $rootScope.$broadcast('appStatusChange', data);\n\t    } else if (op === 'LIST_REVISION_HISTORY') {\n\t      $rootScope.$broadcast('listRevisionHistory', data);\n\t    } else if (op === 'NOTE_REVISION') {\n\t      $rootScope.$broadcast('noteRevision', data);\n\t    } else if (op === 'INTERPRETER_BINDINGS') {\n\t      $rootScope.$broadcast('interpreterBindings', data);\n\t    } else if (op === 'ERROR_INFO') {\n\t      BootstrapDialog.show({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: 'Details',\n\t        message: data.info.toString(),\n\t        buttons: [{\n\t          // close all the dialogs when there are error on running all paragraphs\n\t          label: 'Close',\n\t          action: function action() {\n\t            BootstrapDialog.closeAll();\n\t          }\n\t        }]\n\t      });\n\t    } else if (op === 'SESSION_LOGOUT') {\n\t      $rootScope.$broadcast('session_logout', data);\n\t    } else if (op === 'CONFIGURATIONS_INFO') {\n\t      $rootScope.$broadcast('configurationsInfo', data);\n\t    } else if (op === 'INTERPRETER_SETTINGS') {\n\t      $rootScope.$broadcast('interpreterSettings', data);\n\t    } else if (op === 'PARAGRAPH_ADDED') {\n\t      $rootScope.$broadcast('addParagraph', data.paragraph, data.index);\n\t    } else if (op === 'PARAGRAPH_REMOVED') {\n\t      $rootScope.$broadcast('removeParagraph', data.id);\n\t    } else if (op === 'PARAGRAPH_MOVED') {\n\t      $rootScope.$broadcast('moveParagraph', data.id, data.index);\n\t    } else if (op === 'NOTE_UPDATED') {\n\t      $rootScope.$broadcast('updateNote', data.name, data.config, data.info);\n\t    } else if (op === 'SET_NOTE_REVISION') {\n\t      $rootScope.$broadcast('setNoteRevisionResult', data);\n\t    }\n\t  });\n\t\n\t  websocketCalls.ws.onError(function (event) {\n\t    console.log('error message: ', event);\n\t    $rootScope.$broadcast('setConnectedStatus', false);\n\t  });\n\t\n\t  websocketCalls.ws.onClose(function (event) {\n\t    console.log('close message: ', event);\n\t    if (pingIntervalId !== undefined) {\n\t      clearInterval(pingIntervalId);\n\t      pingIntervalId = undefined;\n\t    }\n\t    $rootScope.$broadcast('setConnectedStatus', false);\n\t  });\n\t\n\t  return websocketCalls;\n\t}\n\n/***/ },\n/* 48 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').factory('noteListDataFactory', noteListDataFactory);\n\t\n\tnoteListDataFactory.$inject = ['TRASH_FOLDER_ID'];\n\t\n\tfunction noteListDataFactory(TRASH_FOLDER_ID) {\n\t  var notes = {\n\t    root: { children: [] },\n\t    flatList: [],\n\t    flatFolderMap: {},\n\t\n\t    setNotes: function setNotes(notesList) {\n\t      // a flat list to boost searching\n\t      notes.flatList = _.map(notesList, function (note) {\n\t        note.isTrash = note.name ? note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n\t        return note;\n\t      });\n\t\n\t      // construct the folder-based tree\n\t      notes.root = { children: [] };\n\t      notes.flatFolderMap = {};\n\t      _.reduce(notesList, function (root, note) {\n\t        var noteName = note.name || note.id;\n\t        var nodes = noteName.match(/([^\\/][^\\/]*)/g);\n\t\n\t        // recursively add nodes\n\t        addNode(root, nodes, note.id);\n\t\n\t        return root;\n\t      }, notes.root);\n\t    }\n\t  };\n\t\n\t  var addNode = function addNode(curDir, nodes, noteId) {\n\t    if (nodes.length === 1) {\n\t      // the leaf\n\t      curDir.children.push({\n\t        name: nodes[0],\n\t        id: noteId,\n\t        path: curDir.id ? curDir.id + '/' + nodes[0] : nodes[0],\n\t        isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n\t      });\n\t    } else {\n\t      // a folder node\n\t      var node = nodes.shift();\n\t      var dir = _.find(curDir.children, function (c) {\n\t        return c.name === node && c.children !== undefined;\n\t      });\n\t      if (dir !== undefined) {\n\t        // found an existing dir\n\t        addNode(dir, nodes, noteId);\n\t      } else {\n\t        var newDir = {\n\t          id: curDir.id ? curDir.id + '/' + node : node,\n\t          name: node,\n\t          hidden: true,\n\t          children: [],\n\t          isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n\t        };\n\t\n\t        // add the folder to flat folder map\n\t        notes.flatFolderMap[newDir.id] = newDir;\n\t\n\t        curDir.children.push(newDir);\n\t        addNode(newDir, nodes, noteId);\n\t      }\n\t    }\n\t  };\n\t\n\t  return notes;\n\t}\n\n/***/ },\n/* 49 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('baseUrlSrv', baseUrlSrv);\n\t\n\tfunction baseUrlSrv() {\n\t  this.getPort = function () {\n\t    var port = Number(location.port);\n\t    if (!port) {\n\t      port = 80;\n\t      if (location.protocol === 'https:') {\n\t        port = 443;\n\t      }\n\t    }\n\t    //Exception for when running locally via grunt\n\t    if (port === 3333 || port === 9000) {\n\t      port = 8080;\n\t    }\n\t    return port;\n\t  };\n\t\n\t  this.getWebsocketUrl = function () {\n\t    var wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';\n\t    return wsProtocol + '//' + location.hostname + ':' + this.getPort() + skipTrailingSlash(location.pathname) + '/ws';\n\t  };\n\t\n\t  this.getRestApiBase = function () {\n\t    return location.protocol + '//' + location.hostname + ':' + this.getPort() + skipTrailingSlash(location.pathname) + '/api';\n\t  };\n\t\n\t  var skipTrailingSlash = function skipTrailingSlash(path) {\n\t    return path.replace(/\\/$/, '');\n\t  };\n\t}\n\n/***/ },\n/* 50 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('browserDetectService', browserDetectService);\n\t\n\tfunction browserDetectService() {\n\t  this.detectIE = function () {\n\t    var ua = window.navigator.userAgent;\n\t    var msie = ua.indexOf('MSIE ');\n\t    if (msie > 0) {\n\t      // IE 10 or older => return version number\n\t      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n\t    }\n\t    var trident = ua.indexOf('Trident/');\n\t    if (trident > 0) {\n\t      // IE 11 => return version number\n\t      var rv = ua.indexOf('rv:');\n\t      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n\t    }\n\t    var edge = ua.indexOf('Edge/');\n\t    if (edge > 0) {\n\t      // IE 12 (aka Edge) => return version number\n\t      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n\t    }\n\t    // other browser\n\t    return false;\n\t  };\n\t}\n\n/***/ },\n/* 51 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('saveAsService', saveAsService);\n\t\n\tsaveAsService.$inject = ['browserDetectService'];\n\t\n\tfunction saveAsService(browserDetectService) {\n\t  this.saveAs = function (content, filename, extension) {\n\t    var BOM = '\\uFEFF';\n\t    if (browserDetectService.detectIE()) {\n\t      angular.element('body').append('<iframe id=\"SaveAsId\" style=\"display: none\"></iframe>');\n\t      var frameSaveAs = angular.element('body > iframe#SaveAsId')[0].contentWindow;\n\t      content = BOM + content;\n\t      frameSaveAs.document.open('text/json', 'replace');\n\t      frameSaveAs.document.write(content);\n\t      frameSaveAs.document.close();\n\t      frameSaveAs.focus();\n\t      var t1 = Date.now();\n\t      frameSaveAs.document.execCommand('SaveAs', false, filename + '.' + extension);\n\t      var t2 = Date.now();\n\t\n\t      //This means, this version of IE dosen't support auto download of a file with extension provided in param\n\t      //falling back to \".txt\"\n\t      if (t1 === t2) {\n\t        frameSaveAs.document.execCommand('SaveAs', true, filename + '.txt');\n\t      }\n\t      angular.element('body > iframe#SaveAsId').remove();\n\t    } else {\n\t      content = 'data:image/svg;charset=utf-8,' + BOM + encodeURIComponent(content);\n\t      angular.element('body').append('<a id=\"SaveAsId\"></a>');\n\t      var saveAsElement = angular.element('body > a#SaveAsId');\n\t      saveAsElement.attr('href', content);\n\t      saveAsElement.attr('download', filename + '.' + extension);\n\t      saveAsElement.attr('target', '_blank');\n\t      saveAsElement[0].click();\n\t      saveAsElement.remove();\n\t    }\n\t  };\n\t}\n\n/***/ },\n/* 52 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('searchService', searchService);\n\t\n\tsearchService.$inject = ['$resource', 'baseUrlSrv'];\n\t\n\tfunction searchService($resource, baseUrlSrv) {\n\t  this.search = function (term) {\n\t    this.searchTerm = term.q;\n\t    console.log('Searching for: %o', term.q);\n\t    if (!term.q) {\n\t      //TODO(bzz): empty string check\n\t      return;\n\t    }\n\t    var encQuery = window.encodeURIComponent(term.q);\n\t    return $resource(baseUrlSrv.getRestApiBase() + '/notebook/search?q=' + encQuery, {}, {\n\t      query: { method: 'GET' }\n\t    });\n\t  };\n\t\n\t  this.searchTerm = '';\n\t}\n\n/***/ },\n/* 53 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('LoginCtrl', LoginCtrl);\n\t\n\tLoginCtrl.$inject = ['$scope', '$rootScope', '$http', '$httpParamSerializer', 'baseUrlSrv', '$location', '$timeout'];\n\tfunction LoginCtrl($scope, $rootScope, $http, $httpParamSerializer, baseUrlSrv, $location, $timeout) {\n\t\n\t  $scope.SigningIn = false;\n\t  $scope.loginParams = {};\n\t  $scope.login = function () {\n\t\n\t    $scope.SigningIn = true;\n\t    $http({\n\t      method: 'POST',\n\t      url: baseUrlSrv.getRestApiBase() + '/login',\n\t      headers: {\n\t        'Content-Type': 'application/x-www-form-urlencoded'\n\t      },\n\t      data: $httpParamSerializer({\n\t        'userName': $scope.loginParams.userName,\n\t        'password': $scope.loginParams.password\n\t      })\n\t    }).then(function successCallback(response) {\n\t      $rootScope.ticket = response.data.body;\n\t      angular.element('#loginModal').modal('toggle');\n\t      $rootScope.$broadcast('loginSuccess', true);\n\t      $rootScope.userName = $scope.loginParams.userName;\n\t      $scope.SigningIn = false;\n\t\n\t      //redirect to the page from where the user originally was\n\t      if ($location.search() && $location.search()['ref']) {\n\t        $timeout(function () {\n\t          var redirectLocation = $location.search()['ref'];\n\t          $location.$$search = {};\n\t          $location.path(redirectLocation);\n\t        }, 100);\n\t      }\n\t    }, function errorCallback(errorResponse) {\n\t      $scope.loginParams.errorText = 'The username and password that you entered don\\'t match.';\n\t      $scope.SigningIn = false;\n\t    });\n\t  };\n\t\n\t  var initValues = function initValues() {\n\t    $scope.loginParams = {\n\t      userName: '',\n\t      password: ''\n\t    };\n\t  };\n\t\n\t  //handle session logout message received from WebSocket\n\t  $rootScope.$on('session_logout', function (event, data) {\n\t    if ($rootScope.userName !== '') {\n\t      $rootScope.userName = '';\n\t      $rootScope.ticket = undefined;\n\t\n\t      setTimeout(function () {\n\t        $scope.loginParams = {};\n\t        $scope.loginParams.errorText = data.info;\n\t        angular.element('.nav-login-btn').click();\n\t      }, 1000);\n\t      var locationPath = $location.path();\n\t      $location.path('/').search('ref', locationPath);\n\t    }\n\t  });\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t  $scope.$on('initLoginValues', function () {\n\t    initValues();\n\t  });\n\t}\n\n/***/ },\n/* 54 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('ElasticInputCtrl', ElasticInputCtrl);\n\t\n\tfunction ElasticInputCtrl() {\n\t  var vm = this;\n\t  vm.showEditor = false;\n\t  vm.value = '';\n\t}\n\n/***/ },\n/* 55 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('noteActionSrv', noteActionSrv);\n\t\n\tnoteActionSrv.$inject = ['websocketMsgSrv', '$location', 'renameSrv', 'noteListDataFactory'];\n\t\n\tfunction noteActionSrv(websocketMsgSrv, $location, renameSrv, noteListDataFactory) {\n\t  this.moveNoteToTrash = function (noteId, redirectToHome) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: 'Move this note to trash?',\n\t      message: 'This note will be moved to <strong>trash</strong>.',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.moveNoteToTrash(noteId);\n\t          if (redirectToHome) {\n\t            $location.path('/');\n\t          }\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.moveFolderToTrash = function (folderId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: 'Move this folder to trash?',\n\t      message: 'This folder will be moved to <strong>trash</strong>.',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.moveFolderToTrash(folderId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.removeNote = function (noteId, redirectToHome) {\n\t    BootstrapDialog.confirm({\n\t      type: BootstrapDialog.TYPE_WARNING,\n\t      closable: true,\n\t      title: 'WARNING! This note will be removed permanently',\n\t      message: 'This cannot be undone. Are you sure?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.deleteNote(noteId);\n\t          if (redirectToHome) {\n\t            $location.path('/');\n\t          }\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.removeFolder = function (folderId) {\n\t    BootstrapDialog.confirm({\n\t      type: BootstrapDialog.TYPE_WARNING,\n\t      closable: true,\n\t      title: 'WARNING! This folder will be removed permanently',\n\t      message: 'This cannot be undone. Are you sure?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.removeFolder(folderId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.restoreAll = function () {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: 'Are you sure want to restore all notes in the trash?',\n\t      message: 'Folders and notes in the trash will be ' + '<strong>merged</strong> into their original position.',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.restoreAll();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.emptyTrash = function () {\n\t    BootstrapDialog.confirm({\n\t      type: BootstrapDialog.TYPE_WARNING,\n\t      closable: true,\n\t      title: 'WARNING! Notes under trash will be removed permanently',\n\t      message: 'This cannot be undone. Are you sure?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.emptyTrash();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.clearAllParagraphOutput = function (noteId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to clear all output?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.clearAllParagraphOutput(noteId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.renameNote = function (noteId, notePath) {\n\t    renameSrv.openRenameModal({\n\t      title: 'Rename note',\n\t      oldName: notePath,\n\t      callback: function callback(newName) {\n\t        websocketMsgSrv.renameNote(noteId, newName);\n\t      }\n\t    });\n\t  };\n\t\n\t  this.renameFolder = function (folderId) {\n\t    renameSrv.openRenameModal({\n\t      title: 'Rename folder',\n\t      oldName: folderId,\n\t      callback: function callback(newName) {\n\t        var newFolderId = normalizeFolderId(newName);\n\t        if (_.has(noteListDataFactory.flatFolderMap, newFolderId)) {\n\t          BootstrapDialog.confirm({\n\t            type: BootstrapDialog.TYPE_WARNING,\n\t            closable: true,\n\t            title: 'WARNING! The folder will be MERGED',\n\t            message: 'The folder will be merged into <strong>' + newFolderId + '</strong>. Are you sure?',\n\t            callback: function callback(result) {\n\t              if (result) {\n\t                websocketMsgSrv.renameFolder(folderId, newFolderId);\n\t              }\n\t            }\n\t          });\n\t        } else {\n\t          websocketMsgSrv.renameFolder(folderId, newFolderId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  function normalizeFolderId(folderId) {\n\t    folderId = folderId.trim();\n\t\n\t    while (folderId.indexOf('\\\\') > -1) {\n\t      folderId = folderId.replace('\\\\', '/');\n\t    }\n\t\n\t    while (folderId.indexOf('///') > -1) {\n\t      folderId = folderId.replace('///', '/');\n\t    }\n\t\n\t    folderId = folderId.replace('//', '/');\n\t\n\t    if (folderId === '/') {\n\t      return '/';\n\t    }\n\t\n\t    if (folderId[0] === '/') {\n\t      folderId = folderId.substring(1);\n\t    }\n\t\n\t    if (folderId.slice(-1) === '/') {\n\t      folderId = folderId.slice(0, -1);\n\t    }\n\t\n\t    return folderId;\n\t  }\n\t}\n\n/***/ },\n/* 56 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('noteVarShareService', noteVarShareService);\n\t\n\tnoteVarShareService.$inject = [];\n\t\n\tfunction noteVarShareService() {\n\t  var store = {};\n\t\n\t  this.clear = function () {\n\t    store = {};\n\t  };\n\t\n\t  this.put = function (key, value) {\n\t    store[key] = value;\n\t  };\n\t\n\t  this.get = function (key) {\n\t    return store[key];\n\t  };\n\t\n\t  this.del = function (key) {\n\t    var v = store[key];\n\t    delete store[key];\n\t    return v;\n\t  };\n\t}\n\n/***/ },\n/* 57 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('RenameCtrl', RenameCtrl);\n\t\n\tRenameCtrl.$inject = ['$scope'];\n\t\n\tfunction RenameCtrl($scope) {\n\t  var self = this;\n\t\n\t  $scope.params = { newName: '' };\n\t  $scope.isValid = true;\n\t\n\t  $scope.rename = function () {\n\t    angular.element('#renameModal').modal('hide');\n\t    self.callback($scope.params.newName);\n\t  };\n\t\n\t  $scope.$on('openRenameModal', function (event, options) {\n\t    self.validator = options.validator || defaultValidator;\n\t    self.callback = options.callback || function () {};\n\t\n\t    $scope.title = options.title || 'Rename';\n\t    $scope.params.newName = options.oldName || '';\n\t    $scope.validate = function () {\n\t      $scope.isValid = self.validator($scope.params.newName);\n\t    };\n\t\n\t    angular.element('#renameModal').modal('show');\n\t  });\n\t\n\t  function defaultValidator(str) {\n\t    return !!str.trim();\n\t  }\n\t}\n\n/***/ },\n/* 58 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('renameSrv', renameSrv);\n\t\n\trenameSrv.$inject = ['$rootScope'];\n\t\n\tfunction renameSrv($rootScope) {\n\t  var self = this;\n\t\n\t  /**\n\t   * <options schema>\n\t   * title: string - Modal title\n\t   * oldName: string - name to initialize input\n\t   * callback: (newName: string)=>void - callback onButtonClick\n\t   * validator: (str: string)=>boolean - input validator\n\t   */\n\t  self.openRenameModal = function (options) {\n\t    $rootScope.$broadcast('openRenameModal', options);\n\t  };\n\t}\n\n/***/ },\n/* 59 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t(function () {\n\t\n\t  angular.module('zeppelinWebApp').service('heliumService', heliumService);\n\t\n\t  heliumService.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\t\n\t  function heliumService($http, baseUrlSrv, ngToast) {\n\t\n\t    var url = baseUrlSrv.getRestApiBase() + '/helium/visualizations/load';\n\t    if ((undefined)) {\n\t      url = url + '?refresh=true';\n\t    }\n\t    var visualizations = [];\n\t\n\t    // load should be promise\n\t    this.load = $http.get(url).success(function (response) {\n\t      if (response.substring(0, 'ERROR:'.length) !== 'ERROR:') {\n\t        eval(response);\n\t      } else {\n\t        console.error(response);\n\t      }\n\t    });\n\t\n\t    this.get = function () {\n\t      return visualizations;\n\t    };\n\t\n\t    this.getVisualizationOrder = function () {\n\t      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder');\n\t    };\n\t\n\t    this.setVisualizationOrder = function (list) {\n\t      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder', list);\n\t    };\n\t\n\t    this.getAllPackageInfo = function () {\n\t      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/all');\n\t    };\n\t\n\t    this.enable = function (name, artifact) {\n\t      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/enable/' + name, artifact);\n\t    };\n\t\n\t    this.disable = function (name) {\n\t      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/disable/' + name);\n\t    };\n\t  };\n\t})();\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// app.997e38abb8f8bc084cb1.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 997e38abb8f8bc084cb1","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './app/app.js';\nimport './app/app.controller.js';\nimport './app/home/home.controller.js';\nimport './app/handsontable/handsonHelper.js';\nimport './app/notebook/notebook.controller.js';\n\n/** start: global variable `zeppelin` related files */\nimport './app/tabledata/tabledata.js';\nimport './app/tabledata/transformation.js';\nimport './app/tabledata/pivot.js';\nimport './app/tabledata/passthrough.js';\nimport './app/tabledata/columnselector.js';\nimport './app/visualization/visualization.js';\nimport './app/visualization/builtins/visualization-table.js';\nimport './app/visualization/builtins/visualization-nvd3chart.js';\nimport './app/visualization/builtins/visualization-barchart.js';\nimport './app/visualization/builtins/visualization-piechart.js';\nimport './app/visualization/builtins/visualization-areachart.js';\nimport './app/visualization/builtins/visualization-linechart.js';\nimport './app/visualization/builtins/visualization-scatterchart.js';\n/** end: global variable `zeppelin` related files */\n\nimport './app/jobmanager/jobmanager.controller.js';\nimport './app/jobmanager/jobs/job.controller.js';\nimport './app/jobmanager/jobmanager.filter.js';\nimport './app/interpreter/interpreter.controller.js';\nimport './app/interpreter/interpreter.filter.js';\nimport './app/credential/credential.controller.js';\nimport './app/configuration/configuration.controller.js';\nimport './app/notebook/paragraph/paragraph.controller.js';\nimport './app/notebook/paragraph/result/result.controller.js';\nimport './app/search/result-list.controller.js';\nimport './app/notebookRepos/notebookRepos.controller.js';\nimport './app/helium/helium.controller.js';\nimport './components/arrayOrderingSrv/arrayOrdering.service.js';\nimport './components/clipboard/clipboard.controller.js';\nimport './components/navbar/navbar.controller.js';\nimport './components/ngescape/ngescape.directive.js';\nimport './components/interpreter/interpreter.directive.js';\nimport './components/expandCollapse/expandCollapse.directive.js';\nimport './components/noteName-create/notename.controller.js';\nimport './components/noteName-import/notenameImport.controller.js';\nimport './components/popover-html-unsafe/popover-html-unsafe.directive.js';\nimport './components/popover-html-unsafe/popover-html-unsafe-popup.directive.js';\nimport './components/editor/codeEditor.directive.js';\nimport './components/ngenter/ngenter.directive.js';\nimport './components/dropdowninput/dropdowninput.directive.js';\nimport './components/resizable/resizable.directive.js';\nimport './components/noteName-create/visible.directive.js';\nimport './components/websocketEvents/websocketMsg.service.js';\nimport './components/websocketEvents/websocketEvents.factory.js';\nimport './components/noteListDataFactory/noteList.datafactory.js';\nimport './components/baseUrl/baseUrl.service.js';\nimport './components/browser-detect/browserDetect.service.js';\nimport './components/saveAs/saveAs.service.js';\nimport './components/searchService/search.service.js';\nimport './components/login/login.controller.js';\nimport './components/elasticInputCtrl/elasticInput.controller.js';\nimport './components/noteAction/noteAction.service.js';\nimport './components/notevarshareService/notevarshare.service.js';\nimport './components/rename/rename.controller.js';\nimport './components/rename/rename.service.js';\nimport './components/helium/helium.service.js';\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/*\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License.  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar zeppelinWebApp = angular.module('zeppelinWebApp', [\n  'ngCookies',\n  'ngAnimate',\n  'ngRoute',\n  'ngSanitize',\n  'angular-websocket',\n  'ui.ace',\n  'ui.bootstrap',\n  'as.sortable',\n  'ngTouch',\n  'ngDragDrop',\n  'angular.filter',\n  'monospaced.elastic',\n  'puElasticInput',\n  'xeditable',\n  'ngToast',\n  'focus-if',\n  'ngResource',\n  'ngclipboard'\n])\n  .filter('breakFilter', function() {\n    return function(text) {\n      if (!!text) {\n        return text.replace(/\\n/g, '<br />');\n      }\n    };\n  })\n  .config(function($httpProvider, $routeProvider, ngToastProvider) {\n    // withCredentials when running locally via grunt\n    $httpProvider.defaults.withCredentials = true;\n\n    var visBundleLoad = {\n      load: ['heliumService', function(heliumService) {\n        return heliumService.load;\n      }]\n    };\n\n    $routeProvider\n      .when('/', {\n        templateUrl: 'app/home/home.html'\n      })\n      .when('/notebook/:noteId', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/notebook/:noteId/paragraph?=:paragraphId', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/notebook/:noteId/paragraph/:paragraphId?', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/notebook/:noteId/revision/:revisionId', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/jobmanager', {\n        templateUrl: 'app/jobmanager/jobmanager.html',\n        controller: 'JobmanagerCtrl'\n      })\n      .when('/interpreter', {\n        templateUrl: 'app/interpreter/interpreter.html',\n        controller: 'InterpreterCtrl'\n      })\n      .when('/notebookRepos', {\n        templateUrl: 'app/notebookRepos/notebookRepos.html',\n        controller: 'NotebookReposCtrl',\n        controllerAs: 'noterepo'\n      })\n      .when('/credential', {\n        templateUrl: 'app/credential/credential.html',\n        controller: 'CredentialCtrl'\n      })\n      .when('/helium', {\n        templateUrl: 'app/helium/helium.html',\n        controller: 'HeliumCtrl'\n      })\n      .when('/configuration', {\n        templateUrl: 'app/configuration/configuration.html',\n        controller: 'ConfigurationCtrl'\n      })\n      .when('/search/:searchTerm', {\n        templateUrl: 'app/search/result-list.html',\n        controller: 'SearchResultCtrl'\n      })\n      .otherwise({\n        redirectTo: '/'\n      });\n\n    ngToastProvider.configure({\n      dismissButton: true,\n      dismissOnClick: false,\n      combineDuplications: true,\n      timeout: 6000\n    });\n  })\n\n  //handel logout on API failure\n  .config(function ($httpProvider, $provide) {\n    $provide.factory('httpInterceptor', function ($q, $rootScope) {\n      return {\n        'responseError': function (rejection) {\n          if (rejection.status === 405) {\n            var data = {};\n            data.info = '';\n            $rootScope.$broadcast('session_logout', data);\n          }\n          $rootScope.$broadcast('httpResponseError', rejection);\n          return $q.reject(rejection);\n        }\n      };\n    });\n    $httpProvider.interceptors.push('httpInterceptor');\n  })\n  .constant('TRASH_FOLDER_ID', '~Trash');\n\nfunction auth() {\n  var $http = angular.injector(['ng']).get('$http');\n  var baseUrlSrv = angular.injector(['zeppelinWebApp']).get('baseUrlSrv');\n  // withCredentials when running locally via grunt\n  $http.defaults.withCredentials = true;\n  jQuery.ajaxSetup({\n    dataType: 'json',\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true\n  });\n  return $http.get(baseUrlSrv.getRestApiBase() + '/security/ticket').then(function(response) {\n    zeppelinWebApp.run(function($rootScope) {\n      $rootScope.ticket = angular.fromJson(response.data).body;\n    });\n  }, function(errorResponse) {\n    // Handle error case\n  });\n}\n\nfunction bootstrapApplication() {\n  zeppelinWebApp.run(function($rootScope, $location) {\n    $rootScope.$on('$routeChangeStart', function(event, next, current) {\n      if (!$rootScope.ticket && next.$$route && !next.$$route.publicAccess) {\n        $location.path('/');\n      }\n    });\n  });\n  angular.bootstrap(document, ['zeppelinWebApp']);\n}\n\nangular.element(document).ready(function() {\n  auth().then(bootstrapApplication);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('MainCtrl', MainCtrl);\n\nMainCtrl.$inject = ['$scope', '$rootScope', '$window', 'arrayOrderingSrv'];\n\nfunction MainCtrl($scope, $rootScope, $window, arrayOrderingSrv) {\n  $scope.looknfeel = 'default';\n\n  var init = function() {\n    $scope.asIframe = (($window.location.href.indexOf('asIframe') > -1) ? true : false);\n  };\n\n  init();\n\n  $rootScope.$on('setIframe', function(event, data) {\n    if (!event.defaultPrevented) {\n      $scope.asIframe = data;\n      event.preventDefault();\n    }\n  });\n\n  $rootScope.$on('setLookAndFeel', function(event, data) {\n    if (!event.defaultPrevented && data && data !== '' && data !== $scope.looknfeel) {\n      $scope.looknfeel = data;\n      event.preventDefault();\n    }\n  });\n\n  // Set The lookAndFeel to default on every page\n  $rootScope.$on('$routeChangeStart', function(event, next, current) {\n    $rootScope.$broadcast('setLookAndFeel', 'default');\n  });\n\n  $rootScope.noteName = function(note) {\n    if (!_.isEmpty(note)) {\n      return arrayOrderingSrv.getNoteName(note);\n    }\n  };\n\n  BootstrapDialog.defaultOptions.onshown = function() {\n    angular.element('#' + this.id).find('.btn:last').focus();\n  };\n\n  // Remove BootstrapDialog animation\n  BootstrapDialog.configDefaultOptions({animate: false});\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('HomeCtrl', HomeCtrl);\n\nHomeCtrl.$inject = [\n  '$scope',\n  'noteListDataFactory',\n  'websocketMsgSrv',\n  '$rootScope',\n  'arrayOrderingSrv',\n  'ngToast',\n  'noteActionSrv',\n  'TRASH_FOLDER_ID'\n];\n\nfunction HomeCtrl($scope, noteListDataFactory, websocketMsgSrv, $rootScope, arrayOrderingSrv,\n                  ngToast, noteActionSrv, TRASH_FOLDER_ID) {\n  ngToast.dismiss();\n  var vm = this;\n  vm.notes = noteListDataFactory;\n  vm.websocketMsgSrv = websocketMsgSrv;\n  vm.arrayOrderingSrv = arrayOrderingSrv;\n\n  vm.notebookHome = false;\n  vm.noteCustomHome = true;\n  if ($rootScope.ticket !== undefined) {\n    vm.staticHome = false;\n  } else {\n    vm.staticHome = true;\n  }\n\n  $scope.isReloading = false;\n  $scope.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n  $scope.query = {q: ''};\n\n  $scope.initHome = function() {\n    websocketMsgSrv.getHomeNote();\n    vm.noteCustomHome = false;\n  };\n\n  $scope.reloadNoteList = function() {\n    websocketMsgSrv.reloadAllNotesFromRepo();\n    $scope.isReloadingNotes = true;\n  };\n\n  $scope.toggleFolderNode = function(node) {\n    node.hidden = !node.hidden;\n  };\n\n  angular.element('#loginModal').on('hidden.bs.modal', function(e) {\n    $rootScope.$broadcast('initLoginValues');\n  });\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteMenu', function(event, notes) {\n    $scope.isReloadingNotes = false;\n  });\n\n  $scope.$on('setNoteContent', function(event, note) {\n    if (vm.noteCustomHome) {\n      return;\n    }\n\n    if (note) {\n      vm.note = note;\n\n      // initialize look And Feel\n      $rootScope.$broadcast('setLookAndFeel', 'home');\n\n      // make it read only\n      vm.viewOnly = true;\n\n      vm.notebookHome = true;\n      vm.staticHome = false;\n    } else {\n      vm.staticHome = true;\n      vm.notebookHome = false;\n    }\n  });\n\n  $scope.renameNote = function(nodeId, nodePath) {\n    noteActionSrv.renameNote(nodeId, nodePath);\n  };\n\n  $scope.moveNoteToTrash = function(noteId) {\n    noteActionSrv.moveNoteToTrash(noteId, false);\n  };\n\n  $scope.moveFolderToTrash = function(folderId) {\n    noteActionSrv.moveFolderToTrash(folderId);\n  };\n\n  $scope.restoreNote = function(noteId) {\n    websocketMsgSrv.restoreNote(noteId);\n  };\n\n  $scope.restoreFolder = function(folderId) {\n    websocketMsgSrv.restoreFolder(folderId);\n  };\n\n  $scope.restoreAll = function() {\n    noteActionSrv.restoreAll();\n  };\n\n  $scope.renameFolder = function(node) {\n    noteActionSrv.renameFolder(node.id);\n  };\n\n  $scope.removeNote = function(noteId) {\n    noteActionSrv.removeNote(noteId, false);\n  };\n\n  $scope.removeFolder = function(folderId) {\n    noteActionSrv.removeFolder(folderId);\n  };\n\n  $scope.emptyTrash = function() {\n    noteActionSrv.emptyTrash();\n  };\n\n  $scope.clearAllParagraphOutput = function(noteId) {\n    noteActionSrv.clearAllParagraphOutput(noteId);\n  };\n\n  $scope.isFilterNote = function(note) {\n    if (!$scope.query.q) {\n      return true;\n    }\n\n    var noteName = note.name;\n    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n      return true;\n    }\n    return false;\n  };\n\n  $scope.getNoteName = function(note) {\n    return arrayOrderingSrv.getNoteName(note);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/home/home.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * HandsonHelper class\n */\nexport default class HandsonHelper {\n  constructor(columns, rows, comment) {\n    this.columns = columns || [];\n    this.rows = rows || [];\n    this.comment = comment || '';\n    this._numericValidator = this._numericValidator.bind(this);\n  };\n\n  getHandsonTableConfig(columns, columnNames, resultRows) {\n    var self = this;\n    return {\n      colHeaders: columnNames,\n      data: resultRows,\n      rowHeaders: false,\n      stretchH: 'all',\n      sortIndicator: true,\n      columns: columns,\n      columnSorting: true,\n      contextMenu: false,\n      manualColumnResize: true,\n      manualRowResize: true,\n      readOnly: true,\n      readOnlyCellClassName: '',\n      fillHandle: false,\n      fragmentSelection: true,\n      disableVisualSelection: true,\n      cells: function(ro, co, pro) {\n        var cellProperties = {};\n        var colType = columns[co].type;\n        cellProperties.renderer = function(instance, td, row, col, prop, value, cellProperties) {\n          self._cellRenderer(instance, td, row, col, prop, value, cellProperties, colType);\n        };\n        return cellProperties;\n      },\n      afterGetColHeader: function(col, TH) {\n        var instance = this;\n        var menu = self._buildDropDownMenu(columns[col].type);\n        var button = self._buildTypeSwitchButton();\n\n        self._addButtonMenuEvent(button, menu);\n\n        Handsontable.Dom.addEvent(menu, 'click', function(event) {\n          if (event.target.nodeName === 'LI') {\n            self._setColumnType(columns, event.target.data.colType, instance, col);\n          }\n        });\n        if (TH.firstChild.lastChild.nodeName === 'BUTTON') {\n          TH.firstChild.removeChild(TH.firstChild.lastChild);\n        }\n        TH.firstChild.appendChild(button);\n        TH.style['white-space'] = 'normal';\n      }\n    };\n  };\n\n  /*\n  ** Private Service Functions\n  */\n\n  _addButtonMenuEvent(button, menu) {\n    Handsontable.Dom.addEvent(button, 'click', function(event) {\n      var changeTypeMenu;\n      var position;\n      var removeMenu;\n\n      document.body.appendChild(menu);\n\n      event.preventDefault();\n      event.stopImmediatePropagation();\n\n      changeTypeMenu = document.querySelectorAll('.changeTypeMenu');\n\n      for (var i = 0, len = changeTypeMenu.length; i < len; i++) {\n        changeTypeMenu[i].style.display = 'none';\n      }\n      menu.style.display = 'block';\n      position = button.getBoundingClientRect();\n\n      menu.style.top = (position.top + (window.scrollY || window.pageYOffset)) + 2 + 'px';\n      menu.style.left = (position.left) + 'px';\n\n      removeMenu = function(event) {\n        if (menu.parentNode) {\n          menu.parentNode.removeChild(menu);\n        }\n      };\n      Handsontable.Dom.removeEvent(document, 'click', removeMenu);\n      Handsontable.Dom.addEvent(document, 'click', removeMenu);\n    });\n  }\n\n  _buildDropDownMenu(activeCellType) {\n    var menu = document.createElement('UL');\n    var types = ['text', 'numeric', 'date'];\n    var item;\n\n    menu.className = 'changeTypeMenu';\n\n    for (var i = 0, len = types.length; i < len; i++) {\n      item = document.createElement('LI');\n      if ('innerText' in item) {\n        item.innerText = types[i];\n      } else {\n        item.textContent = types[i];\n      }\n\n      item.data = {'colType': types[i]};\n\n      if (activeCellType === types[i]) {\n        item.className = 'active';\n      }\n      menu.appendChild(item);\n    }\n\n    return menu;\n  }\n\n  _buildTypeSwitchButton() {\n    var button = document.createElement('BUTTON');\n\n    button.innerHTML = '\\u25BC';\n    button.className = 'changeType';\n\n    return button;\n  }\n\n  _isNumeric(value) {\n    if (!isNaN(value)) {\n      if (value.length !== 0) {\n        if (Number(value) <= Number.MAX_SAFE_INTEGER && Number(value) >= Number.MIN_SAFE_INTEGER) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  _cellRenderer(instance, td, row, col, prop, value, cellProperties, colType) {\n    if (colType === 'numeric' && this._isNumeric(value)) {\n      cellProperties.format = '0,0.[00000]';\n      td.style.textAlign = 'left';\n      Handsontable.renderers.NumericRenderer.apply(this, arguments);\n    } else if (value.length > '%html'.length && '%html ' === value.substring(0, '%html '.length)) {\n      td.innerHTML = value.substring('%html'.length);\n    } else {\n      Handsontable.renderers.TextRenderer.apply(this, arguments);\n    }\n  }\n\n  _dateValidator(value, callback) {\n    var d = moment(value);\n    return callback(d.isValid());\n  }\n\n  _numericValidator(value, callback) {\n    return callback(this._isNumeric(value));\n  }\n\n  _setColumnType(columns, type, instance, col) {\n    columns[col].type = type;\n    this._setColumnValidator(columns, col);\n    instance.updateSettings({columns: columns});\n    instance.validateCells(null);\n    if (this._isColumnSorted(instance, col)) {\n      instance.sort(col, instance.sortOrder);\n    }\n  }\n\n  _isColumnSorted(instance, col) {\n    return instance.sortingEnabled && instance.sortColumn === col;\n  }\n\n  _setColumnValidator(columns, col) {\n    if (columns[col].type === 'numeric') {\n      columns[col].validator = this._numericValidator;\n    } else if (columns[col].type === 'date') {\n      columns[col].validator = this._dateValidator;\n    } else {\n      columns[col].validator = null;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/handsontable/handsonHelper.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NotebookCtrl', NotebookCtrl);\n\nNotebookCtrl.$inject = [\n  '$scope',\n  '$route',\n  '$routeParams',\n  '$location',\n  '$rootScope',\n  '$http',\n  'websocketMsgSrv',\n  'baseUrlSrv',\n  '$timeout',\n  'saveAsService',\n  'ngToast',\n  'noteActionSrv',\n  'noteVarShareService',\n  'TRASH_FOLDER_ID'\n];\n\nfunction NotebookCtrl($scope, $route, $routeParams, $location, $rootScope,\n                      $http, websocketMsgSrv, baseUrlSrv, $timeout, saveAsService,\n                      ngToast, noteActionSrv, noteVarShareService, TRASH_FOLDER_ID) {\n\n  ngToast.dismiss();\n\n  $scope.note = null;\n  $scope.moment = moment;\n  $scope.editorToggled = false;\n  $scope.tableToggled = false;\n  $scope.viewOnly = false;\n  $scope.showSetting = false;\n  $scope.looknfeelOption = ['default', 'simple', 'report'];\n  $scope.cronOption = [\n    {name: 'None', value: undefined},\n    {name: '1m', value: '0 0/1 * * * ?'},\n    {name: '5m', value: '0 0/5 * * * ?'},\n    {name: '1h', value: '0 0 0/1 * * ?'},\n    {name: '3h', value: '0 0 0/3 * * ?'},\n    {name: '6h', value: '0 0 0/6 * * ?'},\n    {name: '12h', value: '0 0 0/12 * * ?'},\n    {name: '1d', value: '0 0 0 * * ?'}\n  ];\n\n  $scope.interpreterSettings = [];\n  $scope.interpreterBindings = [];\n  $scope.isNoteDirty = null;\n  $scope.saveTimer = null;\n\n  var connectedOnce = false;\n  var isRevisionPath = function(path) {\n    var pattern = new RegExp('^.*\\/notebook\\/[a-zA-Z0-9_]*\\/revision\\/[a-zA-Z0-9_]*');\n    return pattern.test(path);\n  };\n\n  $scope.noteRevisions = [];\n  $scope.currentRevision = 'Head';\n  $scope.revisionView = isRevisionPath($location.path());\n\n  $scope.$on('setConnectedStatus', function(event, param) {\n    if (connectedOnce && param) {\n      initNotebook();\n    }\n    connectedOnce = true;\n  });\n\n  $scope.getCronOptionNameFromValue = function(value) {\n    if (!value) {\n      return '';\n    }\n\n    for (var o in $scope.cronOption) {\n      if ($scope.cronOption[o].value === value) {\n        return $scope.cronOption[o].name;\n      }\n    }\n    return value;\n  };\n\n  $scope.blockAnonUsers = function() {\n    var zeppelinVersion = $rootScope.zeppelinVersion;\n    var url = 'https://zeppelin.apache.org/docs/' + zeppelinVersion + '/security/notebook_authorization.html';\n    var content = 'Only authenticated user can set the permission.' +\n      '<a data-toggle=\"tooltip\" data-placement=\"top\" title=\"Learn more\" target=\"_blank\" href=' + url + '>' +\n      '<i class=\"icon-question\" />' +\n      '</a>';\n    BootstrapDialog.show({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: 'No permission',\n      message: content,\n      buttons: [{\n        label: 'Close',\n        action: function(dialog) {\n          dialog.close();\n        }\n      }]\n    });\n  };\n\n  /** Init the new controller */\n  var initNotebook = function() {\n    noteVarShareService.clear();\n    if ($routeParams.revisionId) {\n      websocketMsgSrv.getNoteByRevision($routeParams.noteId, $routeParams.revisionId);\n    } else {\n      websocketMsgSrv.getNote($routeParams.noteId);\n    }\n    websocketMsgSrv.listRevisionHistory($routeParams.noteId);\n    var currentRoute = $route.current;\n    if (currentRoute) {\n      setTimeout(\n        function() {\n          var routeParams = currentRoute.params;\n          var $id = angular.element('#' + routeParams.paragraph + '_container');\n\n          if ($id.length > 0) {\n            // adjust for navbar\n            var top = $id.offset().top - 103;\n            angular.element('html, body').scrollTo({top: top, left: 0});\n          }\n        },\n        1000\n      );\n    }\n  };\n\n  initNotebook();\n\n  // force notebook reload on user change\n  $scope.$on('setNoteMenu', function(event, note) {\n    initNotebook();\n  });\n\n  $scope.focusParagraphOnClick = function(clickEvent) {\n    if (!$scope.note) {\n      return;\n    }\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      var paragraphId = $scope.note.paragraphs[i].id;\n      if (jQuery.contains(angular.element('#' + paragraphId + '_container')[0], clickEvent.target)) {\n        $scope.$broadcast('focusParagraph', paragraphId, 0, true);\n        break;\n      }\n    }\n  };\n\n  // register mouseevent handler for focus paragraph\n  document.addEventListener('click', $scope.focusParagraphOnClick);\n\n  $scope.keyboardShortcut = function(keyEvent) {\n    // handle keyevent\n    if (!$scope.viewOnly && !$scope.revisionView) {\n      $scope.$broadcast('keyEvent', keyEvent);\n    }\n  };\n\n  // register mouseevent handler for focus paragraph\n  document.addEventListener('keydown', $scope.keyboardShortcut);\n\n  $scope.paragraphOnDoubleClick = function(paragraphId) {\n    $scope.$broadcast('doubleClickParagraph', paragraphId);\n  };\n\n  // Move the note to trash and go back to the main page\n  $scope.moveNoteToTrash = function(noteId) {\n    noteActionSrv.moveNoteToTrash(noteId, true);\n  };\n\n  // Remove the note permanently if it's in the trash\n  $scope.removeNote = function(noteId) {\n    noteActionSrv.removeNote(noteId, true);\n  };\n\n  $scope.isTrash = function(note) {\n    return note ? note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n  };\n\n  //Export notebook\n  $scope.exportNote = function() {\n    var jsonContent = JSON.stringify($scope.note);\n    saveAsService.saveAs(jsonContent, $scope.note.name, 'json');\n  };\n\n  //Clone note\n  $scope.cloneNote = function(noteId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to clone this note?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.cloneNote(noteId);\n          $location.path('/');\n        }\n      }\n    });\n  };\n\n  // checkpoint/commit notebook\n  $scope.checkpointNote = function(commitMessage) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Commit note to current repository?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.checkpointNote($routeParams.noteId, commitMessage);\n        }\n      }\n    });\n    document.getElementById('note.checkpoint.message').value = '';\n  };\n\n  // set notebook head to given revision\n  $scope.setNoteRevision = function() {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Set notebook head to current revision?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.setNoteRevision($routeParams.noteId, $routeParams.revisionId);\n        }\n      }\n    });\n  };\n\n  $scope.$on('listRevisionHistory', function(event, data) {\n    console.log('received list of revisions %o', data);\n    $scope.noteRevisions = data.revisionList;\n    $scope.noteRevisions.splice(0, 0, {\n      id: 'Head',\n      message: 'Head'\n    });\n    if ($routeParams.revisionId) {\n      var index = _.findIndex($scope.noteRevisions, {'id': $routeParams.revisionId});\n      if (index > -1) {\n        $scope.currentRevision = $scope.noteRevisions[index].message;\n      }\n    }\n  });\n\n  $scope.$on('noteRevision', function(event, data) {\n    console.log('received note revision %o', data);\n    if (data.note) {\n      $scope.note = data.note;\n      initializeLookAndFeel();\n    } else {\n      $location.path('/');\n    }\n  });\n\n  $scope.$on('setNoteRevisionResult', function(event, data) {\n    console.log('received set note revision result %o', data);\n    if (data.status) {\n      $location.path('/notebook/' + $routeParams.noteId);\n    }\n  });\n\n  $scope.visitRevision = function(revision) {\n    if (revision.id) {\n      if (revision.id === 'Head') {\n        $location.path('/notebook/' + $routeParams.noteId);\n      } else {\n        $location.path('/notebook/' + $routeParams.noteId + '/revision/' + revision.id);\n      }\n    } else {\n      ngToast.danger({content: 'There is a problem with this Revision',\n        verticalPosition: 'top', dismissOnTimeout: false});\n    }\n  };\n\n  $scope.runAllParagraphs = function(noteId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Run all paragraphs?',\n      callback: function(result) {\n        if (result) {\n          const paragraphs = $scope.note.paragraphs.map(p => {\n            return {\n              id: p.id,\n              title: p.title,\n              paragraph: p.text,\n              config: p.config,\n              params: p.settings.params\n            };\n          });\n          websocketMsgSrv.runAllParagraphs(noteId, paragraphs);\n        }\n      }\n    });\n  };\n\n  $scope.saveNote = function() {\n    if ($scope.note && $scope.note.paragraphs) {\n      _.forEach($scope.note.paragraphs, function(par) {\n        angular\n          .element('#' + par.id + '_paragraphColumn_main')\n          .scope()\n          .saveParagraph(par);\n      });\n      $scope.isNoteDirty = null;\n    }\n  };\n\n  $scope.clearAllParagraphOutput = function(noteId) {\n    noteActionSrv.clearAllParagraphOutput(noteId);\n  };\n\n  $scope.toggleAllEditor = function() {\n    if ($scope.editorToggled) {\n      $scope.$broadcast('openEditor');\n    } else {\n      $scope.$broadcast('closeEditor');\n    }\n    $scope.editorToggled = !$scope.editorToggled;\n  };\n\n  $scope.showAllEditor = function() {\n    $scope.$broadcast('openEditor');\n  };\n\n  $scope.hideAllEditor = function() {\n    $scope.$broadcast('closeEditor');\n  };\n\n  $scope.toggleAllTable = function() {\n    if ($scope.tableToggled) {\n      $scope.$broadcast('openTable');\n    } else {\n      $scope.$broadcast('closeTable');\n    }\n    $scope.tableToggled = !$scope.tableToggled;\n  };\n\n  $scope.showAllTable = function() {\n    $scope.$broadcast('openTable');\n  };\n\n  $scope.hideAllTable = function() {\n    $scope.$broadcast('closeTable');\n  };\n\n  $scope.isNoteRunning = function() {\n    if (!$scope.note) { return false; }\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      const status = $scope.note.paragraphs[i].status;\n      if (status === 'PENDING' || status === 'RUNNING') {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  $scope.killSaveTimer = function() {\n    if ($scope.saveTimer) {\n      $timeout.cancel($scope.saveTimer);\n      $scope.saveTimer = null;\n    }\n  };\n\n  $scope.startSaveTimer = function() {\n    $scope.killSaveTimer();\n    $scope.isNoteDirty = true;\n    //console.log('startSaveTimer called ' + $scope.note.id);\n    $scope.saveTimer = $timeout(function() {\n      $scope.saveNote();\n    }, 10000);\n  };\n\n  angular.element(window).on('beforeunload', function(e) {\n    $scope.killSaveTimer();\n    $scope.saveNote();\n  });\n\n  $scope.setLookAndFeel = function(looknfeel) {\n    $scope.note.config.looknfeel = looknfeel;\n    if ($scope.revisionView === true) {\n      $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n    } else {\n      $scope.setConfig();\n    }\n  };\n\n  /** Set cron expression for this note **/\n  $scope.setCronScheduler = function(cronExpr) {\n    if (cronExpr) {\n      if (!$scope.note.config.cronExecutingUser) {\n        $scope.note.config.cronExecutingUser = $rootScope.ticket.principal;\n      }\n    } else {\n      $scope.note.config.cronExecutingUser = '';\n    }\n    $scope.note.config.cron = cronExpr;\n    $scope.setConfig();\n  };\n\n  /** Set the username of the user to be used to execute all notes in notebook **/\n  $scope.setCronExecutingUser = function(cronExecutingUser) {\n    $scope.note.config.cronExecutingUser = cronExecutingUser;\n    $scope.setConfig();\n  };\n\n  /** Set release resource for this note **/\n  $scope.setReleaseResource = function(value) {\n    $scope.note.config.releaseresource = value;\n    $scope.setConfig();\n  };\n\n  /** Update note config **/\n  $scope.setConfig = function(config) {\n    if (config) {\n      $scope.note.config = config;\n    }\n    websocketMsgSrv.updateNote($scope.note.id, $scope.note.name, $scope.note.config);\n  };\n\n  /** Update the note name */\n  $scope.updateNoteName = function(newName) {\n    const trimmedNewName = newName.trim();\n    if (trimmedNewName.length > 0 && $scope.note.name !== trimmedNewName) {\n      $scope.note.name = trimmedNewName;\n      websocketMsgSrv.renameNote($scope.note.id, $scope.note.name);\n    }\n  };\n\n  var initializeLookAndFeel = function() {\n    if (!$scope.note.config.looknfeel) {\n      $scope.note.config.looknfeel = 'default';\n    } else {\n      $scope.viewOnly = $scope.note.config.looknfeel === 'report' ? true : false;\n    }\n\n    if ($scope.note.paragraphs && $scope.note.paragraphs[0]) {\n      $scope.note.paragraphs[0].focus = true;\n    }\n    $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n  };\n\n  var cleanParagraphExcept = function(paragraphId, note) {\n    var noteCopy = {};\n    noteCopy.id = note.id;\n    noteCopy.name = note.name;\n    noteCopy.config = note.config;\n    noteCopy.info = note.info;\n    noteCopy.paragraphs = [];\n    for (var i = 0; i < note.paragraphs.length; i++) {\n      if (note.paragraphs[i].id === paragraphId) {\n        noteCopy.paragraphs[0] = note.paragraphs[i];\n        if (!noteCopy.paragraphs[0].config) {\n          noteCopy.paragraphs[0].config = {};\n        }\n        noteCopy.paragraphs[0].config.editorHide = true;\n        noteCopy.paragraphs[0].config.tableHide = false;\n        break;\n      }\n    }\n    return noteCopy;\n  };\n\n  var addPara = function(paragraph, index) {\n    $scope.note.paragraphs.splice(index, 0, paragraph);\n    _.each($scope.note.paragraphs, function(para) {\n      if (para.id === paragraph.id) {\n        para.focus = true;\n        $scope.$broadcast('focusParagraph', para.id, 0, false);\n      }\n    });\n  };\n\n  var removePara = function(paragraphId) {\n    var removeIdx;\n    _.each($scope.note.paragraphs, function(para, idx) {\n      if (para.id === paragraphId) {\n        removeIdx = idx;\n      }\n    });\n    return $scope.note.paragraphs.splice(removeIdx, 1);\n  };\n\n  $scope.$on('addParagraph', function(event, paragraph, index) {\n    if ($scope.paragraphUrl) {\n      return;\n    }\n    addPara(paragraph, index);\n  });\n\n  $scope.$on('removeParagraph', function(event, paragraphId) {\n    if ($scope.paragraphUrl) {\n      return;\n    }\n    removePara(paragraphId);\n  });\n\n  $scope.$on('moveParagraph', function(event, paragraphId, newIdx) {\n    var removedPara = removePara(paragraphId);\n    if (removedPara && removedPara.length === 1) {\n      addPara(removedPara[0], newIdx);\n    }\n  });\n\n  $scope.$on('updateNote', function(event, name, config, info) {\n    /** update Note name */\n    if (name !== $scope.note.name) {\n      console.log('change note name to : %o', $scope.note.name);\n      $scope.note.name = name;\n    }\n    $scope.note.config = config;\n    $scope.note.info = info;\n    initializeLookAndFeel();\n  });\n\n  var getInterpreterBindings = function() {\n    websocketMsgSrv.getInterpreterBindings($scope.note.id);\n  };\n\n  $scope.$on('interpreterBindings', function(event, data) {\n    $scope.interpreterBindings = data.interpreterBindings;\n    $scope.interpreterBindingsOrig = angular.copy($scope.interpreterBindings); // to check dirty\n\n    var selected = false;\n    var key;\n    var setting;\n\n    for (key in $scope.interpreterBindings) {\n      setting = $scope.interpreterBindings[key];\n      if (setting.selected) {\n        selected = true;\n        break;\n      }\n    }\n\n    if (!selected) {\n      // make default selection\n      var selectedIntp = {};\n      for (key in $scope.interpreterBindings) {\n        setting = $scope.interpreterBindings[key];\n        if (!selectedIntp[setting.name]) {\n          setting.selected = true;\n          selectedIntp[setting.name] = true;\n        }\n      }\n      $scope.showSetting = true;\n    }\n  });\n\n  $scope.interpreterSelectionListeners = {\n    accept: function(sourceItemHandleScope, destSortableScope) {return true;},\n    itemMoved: function(event) {},\n    orderChanged: function(event) {}\n  };\n\n  $scope.openSetting = function() {\n    $scope.showSetting = true;\n    getInterpreterBindings();\n  };\n\n  $scope.closeSetting = function() {\n    if (isSettingDirty()) {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: '',\n        message: 'Interpreter setting changes will be discarded.',\n        callback: function(result) {\n          if (result) {\n            $scope.$apply(function() {\n              $scope.showSetting = false;\n            });\n          }\n        }\n      });\n    } else {\n      $scope.showSetting = false;\n    }\n  };\n\n  $scope.saveSetting = function() {\n    var selectedSettingIds = [];\n    for (var no in $scope.interpreterBindings) {\n      var setting = $scope.interpreterBindings[no];\n      if (setting.selected) {\n        selectedSettingIds.push(setting.id);\n      }\n    }\n    websocketMsgSrv.saveInterpreterBindings($scope.note.id, selectedSettingIds);\n    console.log('Interpreter bindings %o saved', selectedSettingIds);\n\n    _.forEach($scope.note.paragraphs, function(n, key) {\n      var regExp = /^\\s*%/g;\n      if (n.text && !regExp.exec(n.text)) {\n        $scope.$broadcast('saveInterpreterBindings', n.id);\n      }\n    });\n\n    $scope.showSetting = false;\n  };\n\n  $scope.toggleSetting = function() {\n    if ($scope.showSetting) {\n      $scope.closeSetting();\n    } else {\n      $scope.openSetting();\n      $scope.closePermissions();\n    }\n  };\n\n  var getPermissions = function(callback) {\n    $http.get(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions').\n    success(function(data, status, headers, config) {\n      $scope.permissions = data.body;\n      $scope.permissionsOrig = angular.copy($scope.permissions); // to check dirty\n\n      var selectJson = {\n        tokenSeparators: [',', ' '],\n        ajax: {\n          url: function(params) {\n            if (!params.term) {\n              return false;\n            }\n            return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n          },\n          delay: 250,\n          processResults: function(data, params) {\n            var results = [];\n\n            if (data.body.users.length !== 0) {\n              var users = [];\n              for (var len = 0; len < data.body.users.length; len++) {\n                users.push({\n                  'id': data.body.users[len],\n                  'text': data.body.users[len]\n                });\n              }\n              results.push({\n                'text': 'Users :',\n                'children': users\n              });\n            }\n            if (data.body.roles.length !== 0) {\n              var roles = [];\n              for (var len = 0; len < data.body.roles.length; len++) {\n                roles.push({\n                  'id': data.body.roles[len],\n                  'text': data.body.roles[len]\n                });\n              }\n              results.push({\n                'text': 'Roles :',\n                'children': roles\n              });\n            }\n            return {\n              results: results,\n              pagination: {\n                more: false\n              }\n            };\n          },\n          cache: false\n        },\n        width: ' ',\n        tags: true,\n        minimumInputLength: 3\n      };\n\n      $scope.setIamOwner();\n      angular.element('#selectOwners').select2(selectJson);\n      angular.element('#selectReaders').select2(selectJson);\n      angular.element('#selectWriters').select2(selectJson);\n      if (callback) {\n        callback();\n      }\n    }).\n    error(function(data, status, headers, config) {\n      if (status !== 0) {\n        console.log('Error %o %o', status, data.message);\n      }\n    });\n  };\n\n  $scope.openPermissions = function() {\n    $scope.showPermissions = true;\n    getPermissions();\n  };\n\n  $scope.closePermissions = function() {\n    if (isPermissionsDirty()) {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: '',\n        message: 'Changes will be discarded.',\n        callback: function(result) {\n          if (result) {\n            $scope.$apply(function() {\n              $scope.showPermissions = false;\n            });\n          }\n        }\n      });\n    } else {\n      $scope.showPermissions = false;\n    }\n  };\n\n  function convertPermissionsToArray() {\n    $scope.permissions.owners = angular.element('#selectOwners').val();\n    $scope.permissions.readers = angular.element('#selectReaders').val();\n    $scope.permissions.writers = angular.element('#selectWriters').val();\n  }\n\n  $scope.restartInterpreter = function(interpeter) {\n    var thisConfirm = BootstrapDialog.confirm({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: '',\n      message: 'Do you want to restart ' + interpeter.name + ' interpreter?',\n      callback: function(result) {\n        if (result) {\n          var payload  = {\n            'noteId': $scope.note.id\n          };\n\n          thisConfirm.$modalFooter.find('button').addClass('disabled');\n          thisConfirm.$modalFooter.find('button:contains(\"OK\")')\n            .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\n          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + interpeter.id, payload)\n            .success(function(data, status, headers, config) {\n              var index = _.findIndex($scope.interpreterSettings, {'id': interpeter.id});\n              $scope.interpreterSettings[index] = data.body;\n              thisConfirm.close();\n            }).error(function(data, status, headers, config) {\n            thisConfirm.close();\n            console.log('Error %o %o', status, data.message);\n            BootstrapDialog.show({\n              title: 'Error restart interpreter.',\n              message: data.message\n            });\n          });\n          return false;\n        }\n      }\n    });\n  };\n\n  $scope.savePermissions = function() {\n    convertPermissionsToArray();\n    $http.put(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions',\n      $scope.permissions, {withCredentials: true}).\n    success(function(data, status, headers, config) {\n      getPermissions(function() {\n        console.log('Note permissions %o saved', $scope.permissions);\n        BootstrapDialog.alert({\n          closable: true,\n          title: 'Permissions Saved Successfully!!!',\n          message: 'Owners : ' + $scope.permissions.owners + '\\n\\n' + 'Readers : ' +\n          $scope.permissions.readers + '\\n\\n' + 'Writers  : ' + $scope.permissions.writers\n        });\n        $scope.showPermissions = false;\n      });\n    }).\n    error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n      BootstrapDialog.show({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: 'Insufficient privileges',\n        message: data.message,\n        buttons: [\n          {\n            label: 'Login',\n            action: function(dialog) {\n              dialog.close();\n              angular.element('#loginModal').modal({\n                show: 'true'\n              });\n            }\n          },\n          {\n            label: 'Cancel',\n            action: function(dialog) {\n              dialog.close();\n              $location.path('/');\n            }\n          }\n        ]\n      });\n    });\n  };\n\n  $scope.togglePermissions = function() {\n    var principal = $rootScope.ticket.principal;\n    $scope.isAnonymous = principal === 'anonymous' ? true : false;\n    if (!!principal && $scope.isAnonymous) {\n      $scope.blockAnonUsers();\n    } else {\n      if ($scope.showPermissions) {\n        $scope.closePermissions();\n        angular.element('#selectOwners').select2({});\n        angular.element('#selectReaders').select2({});\n        angular.element('#selectWriters').select2({});\n      } else {\n        $scope.openPermissions();\n        $scope.closeSetting();\n      }\n    }\n  };\n\n  $scope.setIamOwner = function() {\n    if ($scope.permissions.owners.length > 0 &&\n      _.indexOf($scope.permissions.owners, $rootScope.ticket.principal) < 0) {\n      $scope.isOwner = false;\n      return false;\n    }\n    $scope.isOwner = true;\n    return true;\n  };\n\n  $scope.toggleNotePersonalizedMode = function() {\n    var personalizedMode = $scope.note.config.personalizedMode;\n    if ($scope.isOwner) {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: 'Setting the result display',\n        message: function(dialog) {\n          var modeText = $scope.note.config.personalizedMode === 'true' ? 'collaborate' : 'personalize';\n          return 'Do you want to <span class=\"text-info\">' + modeText + '</span> your analysis?';\n        },\n        callback: function(result) {\n          if (result) {\n            if ($scope.note.config.personalizedMode === undefined) {\n              $scope.note.config.personalizedMode = 'false';\n            }\n            $scope.note.config.personalizedMode = personalizedMode === 'true' ?  'false' : 'true';\n            websocketMsgSrv.updatePersonalizedMode($scope.note.id, $scope.note.config.personalizedMode);\n          }\n        }\n      });\n    }\n  };\n\n  var isSettingDirty = function() {\n    if (angular.equals($scope.interpreterBindings, $scope.interpreterBindingsOrig)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  var isPermissionsDirty = function() {\n    if (angular.equals($scope.permissions, $scope.permissionsOrig)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  angular.element(document).click(function() {\n    angular.element('.ace_autocomplete').hide();\n  });\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setConnectedStatus', function(event, param) {\n    if (connectedOnce && param) {\n      initNotebook();\n    }\n    connectedOnce = true;\n  });\n\n  $scope.$on('moveParagraphUp', function(event, paragraph) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === paragraph.id) {\n        newIndex = i - 1;\n        break;\n      }\n    }\n    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n      return;\n    }\n    // save dirtyText of moving paragraphs.\n    var prevParagraph = $scope.note.paragraphs[newIndex];\n    angular\n      .element('#' + paragraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(paragraph);\n    angular\n      .element('#' + prevParagraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(prevParagraph);\n    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n  });\n\n  $scope.$on('moveParagraphDown', function(event, paragraph) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === paragraph.id) {\n        newIndex = i + 1;\n        break;\n      }\n    }\n\n    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n      return;\n    }\n    // save dirtyText of moving paragraphs.\n    var nextParagraph = $scope.note.paragraphs[newIndex];\n    angular\n      .element('#' + paragraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(paragraph);\n    angular\n      .element('#' + nextParagraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(nextParagraph);\n    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n  });\n\n  $scope.$on('moveFocusToPreviousParagraph', function(event, currentParagraphId) {\n    var focus = false;\n    for (var i = $scope.note.paragraphs.length - 1; i >= 0; i--) {\n      if (focus === false) {\n        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n          focus = true;\n          continue;\n        }\n      } else {\n        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, -1);\n        break;\n      }\n    }\n  });\n\n  $scope.$on('moveFocusToNextParagraph', function(event, currentParagraphId) {\n    var focus = false;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if (focus === false) {\n        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n          focus = true;\n          continue;\n        }\n      } else {\n        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, 0);\n        break;\n      }\n    }\n  });\n\n  $scope.$on('insertParagraph', function(event, paragraphId, position) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === paragraphId) {\n        //determine position of where to add new paragraph; default is below\n        if (position === 'above') {\n          newIndex = i;\n        } else {\n          newIndex = i + 1;\n        }\n        break;\n      }\n    }\n\n    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n      return;\n    }\n    websocketMsgSrv.insertParagraph(newIndex);\n  });\n\n  $scope.$on('setNoteContent', function(event, note) {\n    if (note === undefined) {\n      $location.path('/');\n    }\n\n    $scope.note = note;\n\n    $scope.paragraphUrl = $routeParams.paragraphId;\n    $scope.asIframe = $routeParams.asIframe;\n    if ($scope.paragraphUrl) {\n      $scope.note = cleanParagraphExcept($scope.paragraphUrl, note);\n      $scope.$broadcast('$unBindKeyEvent', $scope.$unBindKeyEvent);\n      $rootScope.$broadcast('setIframe', $scope.asIframe);\n    }\n\n    initializeLookAndFeel();\n    //open interpreter binding setting when there're none selected\n    getInterpreterBindings();\n    getPermissions();\n    var isPersonalized = $scope.note.config.personalizedMode;\n    isPersonalized = isPersonalized === undefined ?  'false' : isPersonalized;\n    $scope.note.config.personalizedMode = isPersonalized;\n  });\n\n  $scope.$on('$destroy', function() {\n    angular.element(window).off('beforeunload');\n    $scope.killSaveTimer();\n    $scope.saveNote();\n\n    document.removeEventListener('click', $scope.focusParagraphOnClick);\n    document.removeEventListener('keydown', $scope.keyboardShortcut);\n  });\n\n  $scope.$on('$unBindKeyEvent', function() {\n    document.removeEventListener('click', $scope.focusParagraphOnClick);\n    document.removeEventListener('keydown', $scope.keyboardShortcut);\n  });\n\n  angular.element(window).bind('resize', function() {\n    const actionbarHeight = document.getElementById('actionbar').lastElementChild.clientHeight;\n    angular.element(document.getElementById('content')).css('padding-top', actionbarHeight - 20);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebook/notebook.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Create table data object from paragraph table type result\n */\nexport default class TableData {\n  constructor(columns, rows, comment) {\n    this.columns = columns || [];\n    this.rows = rows || [];\n    this.comment = comment || '';\n  };\n\n  loadParagraphResult(paragraphResult) {\n    if (!paragraphResult || paragraphResult.type !== 'TABLE') {\n      console.log('Can not load paragraph result');\n      return;\n    }\n\n    var columnNames = [];\n    var rows = [];\n    var array = [];\n    var textRows = paragraphResult.msg.split('\\n');\n    var comment = '';\n    var commentRow = false;\n\n    for (var i = 0; i < textRows.length; i++) {\n      var textRow = textRows[i];\n\n      if (commentRow) {\n        comment += textRow;\n        continue;\n      }\n\n      if (textRow === '' || textRow === '<!--TABLE_COMMENT-->') {\n        if (rows.length > 0) {\n          commentRow = true;\n        }\n        continue;\n      }\n      var textCols = textRow.split('\\t');\n      var cols = [];\n      var cols2 = [];\n      for (var j = 0; j < textCols.length; j++) {\n        var col = textCols[j];\n        if (i === 0) {\n          columnNames.push({name: col, index: j, aggr: 'sum'});\n        } else {\n          cols.push(col);\n          cols2.push({key: (columnNames[i]) ? columnNames[i].name : undefined, value: col});\n        }\n      }\n      if (i !== 0) {\n        rows.push(cols);\n        array.push(cols2);\n      }\n    }\n    this.comment = comment;\n    this.columns = columnNames;\n    this.rows = rows;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/tabledata.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Base class for visualization\n */\nexport default class Transformation {\n  constructor(config) {\n    this.config = config;\n    this._emitter;\n  };\n\n  /**\n   * return {\n   *   template : angular template string or url (url should end with .html),\n   *   scope : an object to bind to template scope\n   * }\n   */\n  getSetting() {\n    // override this\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    // override this\n  };\n\n  /**\n   * render setting\n   */\n  renderSetting(targetEl) {\n    var setting = this.getSetting();\n    if (!setting) {\n      return;\n    }\n\n    // already readered\n    if (this._scope) {\n      var self = this;\n      this._scope.$apply(function() {\n        for (var k in setting.scope) {\n          self._scope[k] = setting.scope[k];\n        }\n\n        for (var k in self._prevSettingScope) {\n          if (!setting.scope[k]) {\n            self._scope[k] = setting.scope[k];\n          }\n        }\n      });\n      return;\n    } else {\n      this._prevSettingScope = setting.scope;\n    }\n\n    var scope = this._createNewScope();\n    for (var k in setting.scope) {\n      scope[k] = setting.scope[k];\n    }\n    var template = setting.template;\n\n    if (template.split('\\n').length === 1 &&\n        template.endsWith('.html')) { // template is url\n      var self = this;\n      this._templateRequest(template).then(function(t) {\n        self._render(targetEl, t, scope);\n      });\n    } else {\n      this._render(targetEl, template, scope);\n    }\n  };\n\n  _render(targetEl, template, scope) {\n    this._targetEl = targetEl;\n    targetEl.html(template);\n    this._compile(targetEl.contents())(scope);\n    this._scope = scope;\n  };\n\n  setConfig(config) {\n    this.config = config;\n  };\n\n  /**\n   * Emit config. config will sent to server and saved.\n   */\n  emitConfig(config) {\n    this._emitter(config);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/transformation.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Transformation from './transformation';\n\n/**\n * pivot table data and return d3 chart data\n */\nexport default class PivotTransformation extends Transformation {\n  constructor(config) {\n    super(config);\n  };\n\n  getSetting() {\n    var self = this;\n\n    var configObj = self.config;\n    console.log('getSetting', configObj);\n    return {\n      template: 'app/tabledata/pivot_settings.html',\n      scope: {\n        config: configObj.common.pivot,\n        tableDataColumns: self.tableDataColumns,\n        save: function() {\n          self.emitConfig(configObj);\n        },\n        removeKey: function(idx) {\n          configObj.common.pivot.keys.splice(idx, 1);\n          self.emitConfig(configObj);\n        },\n        removeGroup: function(idx) {\n          configObj.common.pivot.groups.splice(idx, 1);\n          self.emitConfig(configObj);\n        },\n        removeValue: function(idx) {\n          configObj.common.pivot.values.splice(idx, 1);\n          self.emitConfig(configObj);\n        },\n        setValueAggr: function(idx, aggr) {\n          configObj.common.pivot.values[idx].aggr = aggr;\n          self.emitConfig(configObj);\n        }\n      }\n    };\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    this.tableDataColumns = tableData.columns;\n    this.config.common = this.config.common || {};\n    this.config.common.pivot = this.config.common.pivot || {};\n    var config = this.config.common.pivot;\n    var firstTime = (!config.keys && !config.groups && !config.values);\n\n    config.keys = config.keys || [];\n    config.groups = config.groups || [];\n    config.values = config.values || [];\n\n    this.removeUnknown();\n    if (firstTime) {\n      this.selectDefault();\n    }\n    return this.pivot(\n      tableData,\n      config.keys,\n      config.groups,\n      config.values);\n  };\n\n  removeUnknown() {\n    var config = this.config.common.pivot;\n    var tableDataColumns = this.tableDataColumns;\n    var unique = function(list) {\n      for (var i = 0; i < list.length; i++) {\n        for (var j = i + 1; j < list.length; j++) {\n          if (angular.equals(list[i], list[j])) {\n            list.splice(j, 1);\n          }\n        }\n      }\n    };\n\n    var removeUnknown = function(list) {\n      for (var i = 0; i < list.length; i++) {\n        // remove non existing column\n        var found = false;\n        for (var j = 0; j < tableDataColumns.length; j++) {\n          var a = list[i];\n          var b = tableDataColumns[j];\n          if (a.index === b.index && a.name === b.name) {\n            found = true;\n            break;\n          }\n        }\n        if (!found) {\n          list.splice(i, 1);\n        }\n      }\n    };\n\n    unique(config.keys);\n    removeUnknown(config.keys);\n    unique(config.groups);\n    removeUnknown(config.groups);\n    removeUnknown(config.values);\n  };\n\n  selectDefault() {\n    var config = this.config.common.pivot;\n    if (config.keys.length === 0 &&\n        config.groups.length === 0 &&\n        config.values.length === 0) {\n      if (config.keys.length === 0 && this.tableDataColumns.length > 0) {\n        config.keys.push(this.tableDataColumns[0]);\n      }\n\n      if (config.values.length === 0 && this.tableDataColumns.length > 1) {\n        config.values.push(this.tableDataColumns[1]);\n      }\n    }\n  };\n\n  pivot(data, keys, groups, values) {\n    var aggrFunc = {\n      sum: function(a, b) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return varA + varB;\n      },\n      count: function(a, b) {\n        var varA = (a !== undefined) ? parseInt(a) : 0;\n        var varB = (b !== undefined) ? 1 : 0;\n        return varA + varB;\n      },\n      min: function(a, b) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return Math.min(varA,varB);\n      },\n      max: function(a, b) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return Math.max(varA,varB);\n      },\n      avg: function(a, b, c) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return varA + varB;\n      }\n    };\n\n    var aggrFuncDiv = {\n      sum: false,\n      count: false,\n      min: false,\n      max: false,\n      avg: true\n    };\n\n    var schema = {};\n    var rows = {};\n\n    for (var i = 0; i < data.rows.length; i++) {\n      var row = data.rows[i];\n      var s = schema;\n      var p = rows;\n\n      for (var k = 0; k < keys.length; k++) {\n        var key = keys[k];\n\n        // add key to schema\n        if (!s[key.name]) {\n          s[key.name] = {\n            order: k,\n            index: key.index,\n            type: 'key',\n            children: {}\n          };\n        }\n        s = s[key.name].children;\n\n        // add key to row\n        var keyKey = row[key.index];\n        if (!p[keyKey]) {\n          p[keyKey] = {};\n        }\n        p = p[keyKey];\n      }\n\n      for (var g = 0; g < groups.length; g++) {\n        var group = groups[g];\n        var groupKey = row[group.index];\n\n        // add group to schema\n        if (!s[groupKey]) {\n          s[groupKey] = {\n            order: g,\n            index: group.index,\n            type: 'group',\n            children: {}\n          };\n        }\n        s = s[groupKey].children;\n\n        // add key to row\n        if (!p[groupKey]) {\n          p[groupKey] = {};\n        }\n        p = p[groupKey];\n      }\n\n      for (var v = 0; v < values.length; v++) {\n        var value = values[v];\n        var valueKey = value.name + '(' + value.aggr + ')';\n\n        // add value to schema\n        if (!s[valueKey]) {\n          s[valueKey] = {\n            type: 'value',\n            order: v,\n            index: value.index\n          };\n        }\n\n        // add value to row\n        if (!p[valueKey]) {\n          p[valueKey] = {\n            value: (value.aggr !== 'count') ? row[value.index] : 1,\n            count: 1\n          };\n        } else {\n          p[valueKey] = {\n            value: aggrFunc[value.aggr](p[valueKey].value, row[value.index], p[valueKey].count + 1),\n            count: (aggrFuncDiv[value.aggr]) ?  p[valueKey].count + 1 : p[valueKey].count\n          };\n        }\n      }\n    }\n\n    //console.log('schema=%o, rows=%o', schema, rows);\n    return {\n      keys: keys,\n      groups: groups,\n      values: values,\n      schema: schema,\n      rows: rows\n    };\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/pivot.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Transformation from './transformation';\n\n/**\n * passthough the data\n */\nexport default class PassthroughTransformation extends Transformation {\n  constructor(config) {\n    super(config);\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    return tableData;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/passthrough.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Transformation from './transformation';\n\n/**\n * select columns\n * - columnSelectorProp\n *   [\n *     {\n *       \"name\":\n *       \"tooltip\":\n *     },\n *     ...\n *   ]\n */\nexport default class ColumnselectorTransformation extends Transformation {\n  constructor(config, columnSelectorProp) {\n    super(config);\n    this.props = columnSelectorProp;\n  };\n\n  getSetting() {\n    var self = this;\n    var configObj = self.config;\n    return {\n      template: 'app/tabledata/columnselector_settings.html',\n      scope: {\n        config: self.config,\n        props: self.props,\n        tableDataColumns: self.tableDataColumns,\n        save: function() {\n          self.emitConfig(configObj);\n        },\n        remove: function(selectorName) {\n          configObj[selectorName] = null;\n          self.emitConfig(configObj);\n        }\n      }\n    };\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    this.tableDataColumns = tableData.columns;\n    this.removeUnknown();\n    return tableData;\n  };\n\n  removeUnknown() {\n    var fields = this.config;\n    for (var f in fields) {\n      if (fields[f]) {\n        var found = false;\n        for (var i = 0; i < this.tableDataColumns.length; i++) {\n          var a = fields[f];\n          var b = this.tableDataColumns[i];\n          if (a.index === b.index && a.name === b.name) {\n            found = true;\n            break;\n          }\n        }\n        if (!found && (fields[f] instanceof Object) && !(fields[f] instanceof Array)) {\n          fields[f] = null;\n        }\n      }\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/columnselector.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Base class for visualization\n */\nexport default class Visualization {\n  constructor(targetEl, config) {\n    this.targetEl = targetEl;\n    this.config = config;\n    this._dirty = false;\n    this._active = false;\n    this._emitter;\n  };\n\n  /**\n   * get transformation\n   */\n  getTransformation() {\n    // override this\n  };\n\n  /**\n   * Method will be invoked when data or configuration changed\n   */\n  render(tableData) {\n    // override this\n  };\n\n  /**\n   * Refresh visualization.\n   */\n  refresh() {\n    // override this\n  };\n\n  /**\n   * method will be invoked when visualization need to be destroyed.\n   * Don't need to destroy this.targetEl.\n   */\n  destroy() {\n    // override this\n  };\n\n  /**\n   * return {\n   *   template : angular template string or url (url should end with .html),\n   *   scope : an object to bind to template scope\n   * }\n   */\n  getSetting() {\n    // override this\n  };\n\n  /**\n   * Activate. invoked when visualization is selected\n   */\n  activate() {\n    if (!this._active || this._dirty) {\n      this.refresh();\n      this._dirty = false;\n    }\n    this._active = true;\n  };\n\n  /**\n   * Activate. invoked when visualization is de selected\n   */\n  deactivate() {\n    this._active = false;\n  };\n\n  /**\n   * Is active\n   */\n  isActive() {\n    return this._active;\n  };\n\n  /**\n   * When window or paragraph is resized\n   */\n  resize() {\n    if (this.isActive()) {\n      this.refresh();\n    } else {\n      this._dirty = true;\n    }\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    this.config = config;\n    if (this.isActive()) {\n      this.refresh();\n    } else {\n      this._dirty = true;\n    }\n  };\n\n  /**\n   * Emit config. config will sent to server and saved.\n   */\n  emitConfig(config) {\n    this._emitter(config);\n  };\n\n  /**\n   * render setting\n   */\n  renderSetting(targetEl) {\n    var setting = this.getSetting();\n    if (!setting) {\n      return;\n    }\n\n    // already readered\n    if (this._scope) {\n      var self = this;\n      this._scope.$apply(function() {\n        for (var k in setting.scope) {\n          self._scope[k] = setting.scope[k];\n        }\n\n        for (var k in self._prevSettingScope) {\n          if (!setting.scope[k]) {\n            self._scope[k] = setting.scope[k];\n          }\n        }\n      });\n      return;\n    } else {\n      this._prevSettingScope = setting.scope;\n    }\n\n    var scope = this._createNewScope();\n    for (var k in setting.scope) {\n      scope[k] = setting.scope[k];\n    }\n    var template = setting.template;\n\n    if (template.split('\\n').length === 1 &&\n        template.endsWith('.html')) { // template is url\n      this._templateRequest(template).then(t =>\n      _renderSetting(this, targetEl, t, scope)\n      );\n    } else {\n      _renderSetting(this, targetEl, template, scope);\n    }\n  };\n}\n\nfunction _renderSetting(instance, targetEl, template, scope) {\n  instance._targetEl = targetEl;\n  targetEl.html(template);\n  instance._compile(targetEl.contents())(scope);\n  instance._scope = scope;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/visualization.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Visualization from '../visualization';\nimport PassthroughTransformation from '../../tabledata/passthrough';\nimport HandsonHelper from '../../handsontable/handsonHelper';\n\n/**\n * Visualize data in table format\n */\nexport default class TableVisualization extends Visualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n    console.log('Init table viz');\n    targetEl.addClass('table');\n    this.passthrough = new PassthroughTransformation(config);\n  };\n\n  refresh() {\n    this.hot.render();\n  };\n\n  render(tableData) {\n    var height = this.targetEl.height();\n    var container = this.targetEl.css('height', height).get(0);\n    var resultRows = tableData.rows;\n    var columnNames = _.pluck(tableData.columns, 'name');\n    var columns = Array.apply(null, Array(tableData.columns.length)).map(function() {\n      return {type: 'text'};\n    });\n\n    if (this.hot) {\n      this.hot.destroy();\n    }\n\n    var handsonHelper = new HandsonHelper();\n    this.hot = new Handsontable(container, handsonHelper.getHandsonTableConfig(\n      columns, columnNames, resultRows));\n    this.hot.validateCells(null);\n  };\n\n  destroy() {\n    if (this.hot) {\n      this.hot.destroy();\n    }\n  };\n\n  getTransformation() {\n    return this.passthrough;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-table.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Visualization from '../visualization';\n\n/**\n * Visualize data in table format\n */\nexport default class Nvd3ChartVisualization extends Visualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n    this.targetEl.append('<svg></svg>');\n  };\n\n  refresh() {\n    if (this.chart) {\n      this.chart.update();\n    }\n  };\n\n  render(data) {\n    var type = this.type();\n    var d3g = data.d3g;\n\n    if (!this.chart) {\n      this.chart = nv.models[type]();\n    }\n\n    this.configureChart(this.chart);\n\n    var animationDuration = 300;\n    var numberOfDataThreshold = 150;\n    var height = this.targetEl.height();\n\n    // turn off animation when dataset is too large. (for performance issue)\n    // still, since dataset is large, the chart content sequentially appears like animated.\n    try {\n      if (d3g[0].values.length > numberOfDataThreshold) {\n        animationDuration = 0;\n      }\n    } catch (ignoreErr) {\n    }\n\n    d3.select('#' + this.targetEl[0].id + ' svg')\n      .attr('height', height)\n      .datum(d3g)\n      .transition()\n      .duration(animationDuration)\n      .call(this.chart);\n    d3.select('#' + this.targetEl[0].id + ' svg').style.height = height + 'px';\n  };\n\n  type() {\n    // override this and return chart type\n  };\n\n  configureChart(chart) {\n    // override this to configure chart\n  };\n\n  groupedThousandsWith3DigitsFormatter(x) {\n    return d3.format(',')(d3.round(x, 3));\n  };\n\n  customAbbrevFormatter(x) {\n    var s = d3.format('.3s')(x);\n    switch (s[s.length - 1]) {\n      case 'G': return s.slice(0, -1) + 'B';\n    }\n    return s;\n  };\n\n  xAxisTickFormat(d, xLabels) {\n    if (xLabels[d] && (isNaN(parseFloat(xLabels[d])) || !isFinite(xLabels[d]))) { // to handle string type xlabel\n      return xLabels[d];\n    } else {\n      return d;\n    }\n  };\n\n  yAxisTickFormat(d) {\n    if (Math.abs(d) >= Math.pow(10,6)) {\n      return this.customAbbrevFormatter(d);\n    }\n    return this.groupedThousandsWith3DigitsFormatter(d);\n  };\n\n  d3DataFromPivot(\n    schema, rows, keys, groups, values, allowTextXAxis, fillMissingValues, multiBarChart) {\n    // construct table data\n    var d3g = [];\n\n    var concat = function(o, n) {\n      if (!o) {\n        return n;\n      } else {\n        return o + '.' + n;\n      }\n    };\n\n    var getSchemaUnderKey = function(key, s) {\n      for (var c in key.children) {\n        s[c] = {};\n        getSchemaUnderKey(key.children[c], s[c]);\n      }\n    };\n\n    var traverse = function(sKey, s, rKey, r, func, rowName, rowValue, colName) {\n      //console.log(\"TRAVERSE sKey=%o, s=%o, rKey=%o, r=%o, rowName=%o, rowValue=%o, colName=%o\", sKey, s, rKey, r, rowName, rowValue, colName);\n\n      if (s.type === 'key') {\n        rowName = concat(rowName, sKey);\n        rowValue = concat(rowValue, rKey);\n      } else if (s.type === 'group') {\n        colName = concat(colName, rKey);\n      } else if (s.type === 'value' && sKey === rKey || valueOnly) {\n        colName = concat(colName, rKey);\n        func(rowName, rowValue, colName, r);\n      }\n\n      for (var c in s.children) {\n        if (fillMissingValues && s.children[c].type === 'group' && r[c] === undefined) {\n          var cs = {};\n          getSchemaUnderKey(s.children[c], cs);\n          traverse(c, s.children[c], c, cs, func, rowName, rowValue, colName);\n          continue;\n        }\n\n        for (var j in r) {\n          if (s.children[c].type === 'key' || c === j) {\n            traverse(c, s.children[c], j, r[j], func, rowName, rowValue, colName);\n          }\n        }\n      }\n    };\n\n    var valueOnly = (keys.length === 0 && groups.length === 0 && values.length > 0);\n    var noKey = (keys.length === 0);\n    var isMultiBarChart = multiBarChart;\n\n    var sKey = Object.keys(schema)[0];\n\n    var rowNameIndex = {};\n    var rowIdx = 0;\n    var colNameIndex = {};\n    var colIdx = 0;\n    var rowIndexValue = {};\n\n    for (var k in rows) {\n      traverse(sKey, schema[sKey], k, rows[k], function(rowName, rowValue, colName, value) {\n        //console.log(\"RowName=%o, row=%o, col=%o, value=%o\", rowName, rowValue, colName, value);\n        if (rowNameIndex[rowValue] === undefined) {\n          rowIndexValue[rowIdx] = rowValue;\n          rowNameIndex[rowValue] = rowIdx++;\n        }\n\n        if (colNameIndex[colName] === undefined) {\n          colNameIndex[colName] = colIdx++;\n        }\n        var i = colNameIndex[colName];\n        if (noKey && isMultiBarChart) {\n          i = 0;\n        }\n\n        if (!d3g[i]) {\n          d3g[i] = {\n            values: [],\n            key: (noKey && isMultiBarChart) ? 'values' : colName\n          };\n        }\n\n        var xVar = isNaN(rowValue) ? ((allowTextXAxis) ? rowValue : rowNameIndex[rowValue]) : parseFloat(rowValue);\n        var yVar = 0;\n        if (xVar === undefined) { xVar = colName; }\n        if (value !== undefined) {\n          yVar = isNaN(value.value) ? 0 : parseFloat(value.value) / parseFloat(value.count);\n        }\n        d3g[i].values.push({\n          x: xVar,\n          y: yVar\n        });\n      });\n    }\n\n    // clear aggregation name, if possible\n    var namesWithoutAggr = {};\n    var colName;\n    var withoutAggr;\n    // TODO - This part could use som refactoring - Weird if/else with similar actions and variable names\n    for (colName in colNameIndex) {\n      withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n      if (!namesWithoutAggr[withoutAggr]) {\n        namesWithoutAggr[withoutAggr] = 1;\n      } else {\n        namesWithoutAggr[withoutAggr]++;\n      }\n    }\n\n    if (valueOnly) {\n      for (var valueIndex = 0; valueIndex < d3g[0].values.length; valueIndex++) {\n        colName = d3g[0].values[valueIndex].x;\n        if (!colName) {\n          continue;\n        }\n\n        withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n        if (namesWithoutAggr[withoutAggr] <= 1) {\n          d3g[0].values[valueIndex].x = withoutAggr;\n        }\n      }\n    } else {\n      for (var d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n        colName = d3g[d3gIndex].key;\n        withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n        if (namesWithoutAggr[withoutAggr] <= 1) {\n          d3g[d3gIndex].key = withoutAggr;\n        }\n      }\n\n      // use group name instead of group.value as a column name, if there're only one group and one value selected.\n      if (groups.length === 1 && values.length === 1) {\n        for (d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n          colName = d3g[d3gIndex].key;\n          colName = colName.split('.').slice(0, -1).join('.');\n          d3g[d3gIndex].key = colName;\n        }\n      }\n    }\n\n    return {\n      xLabels: rowIndexValue,\n      d3g: d3g\n    };\n  };\n\n  /**\n   * method will be invoked when visualization need to be destroyed.\n   * Don't need to destroy this.targetEl.\n   */\n  destroy() {\n    if (this.chart) {\n      d3.selectAll('#' + this.targetEl[0].id + ' svg > *').remove();\n      this.chart = undefined;\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-nvd3chart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in bar char\n */\nexport default class BarchartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.pivot = new PivotTransformation(config);\n  };\n\n  type() {\n    return 'multiBarChart';\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    var d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      true,\n      true,\n      true);\n\n    super.render(d3Data);\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n  };\n\n  configureChart(chart) {\n    var self = this;\n    chart.yAxis.axisLabelDistance(50);\n    chart.yAxis.tickFormat(function(d) {return self.yAxisTickFormat(d);});\n\n    this.chart.stacked(this.config.stacked);\n\n    var self = this;\n    this.chart.dispatch.on('stateChange', function(s) {\n      self.config.stacked = s.stacked;\n\n      // give some time to animation finish\n      setTimeout(function() {\n        self.emitConfig(self.config);\n      }, 500);\n    });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-barchart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in pie chart\n */\nexport default class PiechartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n    this.pivot = new PivotTransformation(config);\n  };\n\n  type() {\n    return 'pieChart';\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    // [ZEPPELIN-2253] New chart function will be created each time inside super.render()\n    this.chart = null;\n    const d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      true,\n      false,\n      false);\n    const d = d3Data.d3g;\n\n    let generateLabel;\n    // data is grouped\n    if (pivot.groups && pivot.groups.length > 0) {\n      generateLabel = (suffix, prefix) => `${prefix}.${suffix}`;\n    } else { // data isn't grouped\n      generateLabel = suffix => suffix;\n    }\n\n    let d3g = d.map(group => {\n      return group.values.map(row => ({\n        label: generateLabel(row.x, group.key),\n        value: row.y\n      }));\n    });\n    // the map function returns d3g as a nested array\n    // [].concat flattens it, http://stackoverflow.com/a/10865042/5154397\n    d3g = [].concat.apply([], d3g);\n    super.render({d3g: d3g});\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n  };\n\n  configureChart(chart) {\n    chart.x(function(d) { return d.label;})\n\t .y(function(d) { return d.value;})\n\t .showLabels(false)\n\t .showTooltipPercent(true);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-piechart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in area chart\n */\nexport default class AreachartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.pivot = new PivotTransformation(config);\n    this.xLables = [];\n  };\n\n  type() {\n    return 'stackedAreaChart';\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    var d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      false,\n      true,\n      false);\n\n    this.xLabels = d3Data.xLabels;\n    super.render(d3Data);\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n  };\n\n  configureChart(chart) {\n    var self = this;\n    chart.xAxis.tickFormat(function(d) {return self.xAxisTickFormat(d, self.xLabels);});\n    chart.yAxis.tickFormat(function(d) {return self.yAxisTickFormat(d);});\n    chart.yAxis.axisLabelDistance(50);\n    chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n\n    this.chart.style(this.config.style || 'stack');\n\n    var self = this;\n    this.chart.dispatch.on('stateChange', function(s) {\n      self.config.style = s.style;\n\n      // give some time to animation finish\n      setTimeout(function() {\n        self.emitConfig(self.config);\n      }, 500);\n    });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-areachart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in line chart\n */\nexport default class LinechartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.pivot = new PivotTransformation(config);\n    this.xLables = [];\n  };\n\n  type() {\n    if (this.config.lineWithFocus) {\n      return 'lineWithFocusChart';\n    } else {\n      return 'lineChart';\n    }\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    var d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      false,\n      true,\n      false);\n\n    this.xLabels = d3Data.xLabels;\n    super.render(d3Data);\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n\n    // change mode\n    if (this.currentMode !== config.lineWithFocus) {\n      super.destroy();\n      this.currentMode = config.lineWithFocus;\n    }\n  };\n\n  configureChart(chart) {\n    var self = this;\n    chart.xAxis.tickFormat(function(d) {return self.xAxisTickFormat(d, self.xLabels);});\n    chart.yAxis.tickFormat(function(d) {return self.yAxisTickFormat(d, self.xLabels);});\n    chart.yAxis.axisLabelDistance(50);\n    if (chart.useInteractiveGuideline) {   // lineWithFocusChart hasn't got useInteractiveGuideline\n      chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n    }\n    if (this.config.forceY) {\n      chart.forceY([0]); // force y-axis minimum to 0 for line chart.\n    } else {\n      chart.forceY([]);\n    }\n  };\n\n  getSetting(chart) {\n    var self = this;\n    var configObj = self.config;\n\n    return {\n      template: `<div>\n        <label>\n          <input type=\"checkbox\"\n               ng-model=\"config.forceY\"\n               ng-click=\"save()\" />\n          force Y to 0\n        </label>\n        <br/>\n\n        <label>\n          <input type=\"checkbox\"\n               ng-model=\"config.lineWithFocus\"\n               ng-click=\"save()\" />\n          show line chart with focus\n        </label>\n      </div>`,\n      scope: {\n        config: configObj,\n        save: function() {\n          self.emitConfig(configObj);\n        }\n      }\n    };\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-linechart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport ColumnselectorTransformation from '../../tabledata/columnselector';\n\n/**\n * Visualize data in scatter char\n */\nexport default class ScatterchartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.columnselectorProps = [\n      {\n        name: 'xAxis'\n      },\n      {\n        name: 'yAxis'\n      },\n      {\n        name: 'group'\n      },\n      {\n        name: 'size',\n        tooltip: `<li>Size option is valid only when you drop numeric field here.</li>\n                  <li>When data in each axis are discrete,\n                  'number of values in corresponding coordinate' will be used as size.</li>\n                  <li>Zeppelin consider values as discrete when the values contain string value\n                  or the number of distinct values are bigger than 5% of total number of values.</li>\n                  <li>Size field button turns to grey when the option you chose is not valid.</li>`\n      }\n    ];\n    this.columnselector = new ColumnselectorTransformation(config, this.columnselectorProps);\n  };\n\n  type() {\n    return 'scatterChart';\n  };\n\n  getTransformation() {\n    return this.columnselector;\n  };\n\n  render(tableData) {\n    this.tableData = tableData;\n    this.selectDefault();\n    var d3Data = this.setScatterChart(tableData, true);\n    this.xLabels = d3Data.xLabels;\n    this.yLabels = d3Data.yLabels;\n\n    super.render(d3Data);\n  };\n\n  configureChart(chart) {\n    var self = this;\n\n    chart.xAxis.tickFormat(function(d) { // TODO remove round after bump to nvd3 > 1.8.5\n      return self.xAxisTickFormat(Math.round(d * 1e3)/1e3, self.xLabels);\n      });\n\n    chart.yAxis.tickFormat(function(d) { // TODO remove round after bump to nvd3 > 1.8.5\n      return self.yAxisTickFormat(Math.round(d * 1e3)/1e3, self.yLabels);\n      });\n\n    chart.showDistX(true).showDistY(true);\n    //handle the problem of tooltip not showing when muliple points have same value.\n  };\n\n  yAxisTickFormat(d, yLabels){\n     if (yLabels[d] && (isNaN(parseFloat(yLabels[d])) || !isFinite(yLabels[d]))) { // to handle string type xlabel\n      return yLabels[d];\n     } else {\n      return super.yAxisTickFormat(d);\n     }\n   }\n\n  selectDefault() {\n    if (!this.config.xAxis && !this.config.yAxis) {\n      if (this.tableData.columns.length > 1) {\n        this.config.xAxis = this.tableData.columns[0];\n        this.config.yAxis = this.tableData.columns[1];\n      } else if (this.tableData.columns.length === 1) {\n        this.config.xAxis = this.tableData.columns[0];\n      }\n    }\n  };\n\n  setScatterChart(data, refresh) {\n    var xAxis = this.config.xAxis;\n    var yAxis = this.config.yAxis;\n    var group = this.config.group;\n    var size = this.config.size;\n\n    var xValues = [];\n    var yValues = [];\n    var rows = {};\n    var d3g = [];\n\n    var rowNameIndex = {};\n    var colNameIndex = {};\n    var grpNameIndex = {};\n    var rowIndexValue = {};\n    var colIndexValue = {};\n    var grpIndexValue = {};\n    var rowIdx = 0;\n    var colIdx = 0;\n    var grpIdx = 0;\n    var grpName = '';\n\n    var xValue;\n    var yValue;\n    var row;\n\n    if (!xAxis && !yAxis) {\n      return {\n        d3g: []\n      };\n    }\n\n\n\n\n    for (var i = 0; i < data.rows.length; i++) {\n      row = data.rows[i];\n      if (xAxis) {\n        xValue = row[xAxis.index];\n        xValues[i] = xValue;\n      }\n      if (yAxis) {\n        yValue = row[yAxis.index];\n        yValues[i] = yValue;\n      }\n    }\n\n    var isAllDiscrete = ((xAxis && yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues)) ||\n    (!xAxis && this.isDiscrete(yValues)) ||\n    (!yAxis && this.isDiscrete(xValues)));\n\n    if (isAllDiscrete) {\n      rows = this.setDiscreteScatterData(data);\n    } else {\n      rows = data.rows;\n    }\n\n    if (!group && isAllDiscrete) {\n      grpName = 'count';\n    } else if (!group && !size) {\n      if (xAxis && yAxis) {\n        grpName = '(' + xAxis.name + ', ' + yAxis.name + ')';\n      } else if (xAxis && !yAxis) {\n        grpName = xAxis.name;\n      } else if (!xAxis && yAxis) {\n        grpName = yAxis.name;\n      }\n    } else if (!group && size) {\n      grpName = size.name;\n    }\n\n    var epsilon = 1e-4; // TODO remove after bump to nvd3 > 1.8.5\n\n    for (i = 0; i < rows.length; i++) {\n      row = rows[i];\n      if (xAxis) {\n        xValue = row[xAxis.index];\n      }\n      if (yAxis) {\n        yValue = row[yAxis.index];\n      }\n      if (group) {\n        grpName = row[group.index];\n      }\n      var sz = (isAllDiscrete) ? row[row.length - 1] : ((size) ? row[size.index] : 1);\n\n      if (grpNameIndex[grpName] === undefined) {\n        grpIndexValue[grpIdx] = grpName;\n        grpNameIndex[grpName] = grpIdx++;\n      }\n\n      if (xAxis && rowNameIndex[xValue] === undefined) {\n        rowIndexValue[rowIdx] = xValue;\n        rowNameIndex[xValue] = rowIdx++;\n      }\n\n      if (yAxis && colNameIndex[yValue] === undefined) {\n        colIndexValue[colIdx] = yValue;\n        colNameIndex[yValue] = colIdx++;\n      }\n\n      if (!d3g[grpNameIndex[grpName]]) {\n        d3g[grpNameIndex[grpName]] = {\n          key: grpName,\n          values: []\n        };\n      }\n\n\n      // TODO remove epsilon jitter after bump to nvd3 > 1.8.5\n      var xval, yval = 0;\n      if ( xAxis ){\n        xval = (isNaN(xValue) ? rowNameIndex[xValue] : parseFloat(xValue)) + Math.random() * epsilon;\n      }\n      if ( yAxis ){\n        yval = (isNaN(yValue) ? colNameIndex[yValue] : parseFloat(yValue)) + Math.random() * epsilon;\n      }\n\n      d3g[grpNameIndex[grpName]].values.push({\n        x: xval,\n        y: yval,\n        size: isNaN(parseFloat(sz)) ? 1 : parseFloat(sz)\n      });\n    }\n\n    // TODO remove sort and dedup after bump to nvd3 > 1.8.5\n    var d3gvalues = d3g[grpNameIndex[grpName]].values;\n    d3gvalues.sort(function(a,b){\n                  return ((a['x'] - b['x']) || (a['y'] - b['y']))});\n\n    for (var i = 0; i < d3gvalues.length - 1; ){\n      if ( (Math.abs(d3gvalues[i]['x'] - d3gvalues[i+1]['x']) < epsilon) &&\n           (Math.abs(d3gvalues[i]['y'] - d3gvalues[i+1]['y']) < epsilon) ){\n           d3gvalues.splice(i+1,1);\n      } else{\n        i++;\n      }\n    }\n\n    return {\n      xLabels: rowIndexValue,\n      yLabels: colIndexValue,\n      d3g: d3g\n    };\n  };\n\n  setDiscreteScatterData(data) {\n    var xAxis = this.config.xAxis;\n    var yAxis = this.config.yAxis;\n    var group = this.config.group;\n\n    var xValue;\n    var yValue;\n    var grp;\n\n    var rows = {};\n\n    for (var i = 0; i < data.rows.length; i++) {\n      var row = data.rows[i];\n      if (xAxis) {\n        xValue = row[xAxis.index];\n      }\n      if (yAxis) {\n        yValue = row[yAxis.index];\n      }\n      if (group) {\n        grp = row[group.index];\n      }\n\n      var key = xValue + ',' + yValue +  ',' + grp;\n\n      if (!rows[key]) {\n        rows[key] = {\n          x: xValue,\n          y: yValue,\n          group: grp,\n          size: 1\n        };\n      } else {\n        rows[key].size++;\n      }\n    }\n\n    // change object into array\n    var newRows = [];\n    for (var r in rows) {\n      var newRow = [];\n      if (xAxis) { newRow[xAxis.index] = rows[r].x; }\n      if (yAxis) { newRow[yAxis.index] = rows[r].y; }\n      if (group) { newRow[group.index] = rows[r].group; }\n      newRow[data.rows[0].length] = rows[r].size;\n      newRows.push(newRow);\n    }\n    return newRows;\n  };\n\n  isDiscrete(field) {\n    var getUnique = function(f) {\n      var uniqObj = {};\n      var uniqArr = [];\n      var j = 0;\n      for (var i = 0; i < f.length; i++) {\n        var item = f[i];\n        if (uniqObj[item] !== 1) {\n          uniqObj[item] = 1;\n          uniqArr[j++] = item;\n        }\n      }\n      return uniqArr;\n    };\n\n    for (var i = 0; i < field.length; i++) {\n      if (isNaN(parseFloat(field[i])) &&\n        (typeof field[i] === 'string' || field[i] instanceof String)) {\n        return true;\n      }\n    }\n\n    var threshold = 0.05;\n    var unique = getUnique(field);\n    if (unique.length / field.length < threshold) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  isValidSizeOption(options) {\n    var xValues = [];\n    var yValues = [];\n    var rows = this.tableData.rows;\n\n    for (var i = 0; i < rows.length; i++) {\n      var row = rows[i];\n      var size = row[options.size.index];\n\n      //check if the field is numeric\n      if (isNaN(parseFloat(size)) || !isFinite(size)) {\n        return false;\n      }\n\n      if (options.xAxis) {\n        var x = row[options.xAxis.index];\n        xValues[i] = x;\n      }\n      if (options.yAxis) {\n        var y = row[options.yAxis.index];\n        yValues[i] = y;\n      }\n    }\n\n    //check if all existing fields are discrete\n    var isAllDiscrete = ((options.xAxis && options.yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues)) ||\n    (!options.xAxis && this.isDiscrete(yValues)) ||\n    (!options.yAxis && this.isDiscrete(xValues)));\n\n    if (isAllDiscrete) {\n      return false;\n    }\n\n    return true;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-scatterchart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp')\n  .controller('JobmanagerCtrl', JobmanagerCtrl);\n\nJobmanagerCtrl.$inject = ['$scope', 'websocketMsgSrv', '$interval', 'ngToast', '$q', '$timeout', 'jobManagerFilter'];\n\nfunction JobmanagerCtrl($scope, websocketMsgSrv, $interval, ngToast, $q, $timeout, jobManagerFilter) {\n  ngToast.dismiss();\n  var asyncNotebookJobFilter = function(jobInfomations, filterConfig) {\n    return $q(function(resolve, reject) {\n      $scope.JobInfomationsByFilter = $scope.jobTypeFilter(jobInfomations, filterConfig);\n      resolve($scope.JobInfomationsByFilter);\n    });\n  };\n\n  $scope.doFiltering = function(jobInfomations, filterConfig) {\n    asyncNotebookJobFilter(jobInfomations, filterConfig).then(\n      function() {\n        // success\n        $scope.isLoadingFilter = false;\n      },\n      function() {\n        // failed\n      });\n  };\n\n  $scope.filterValueToName = function(filterValue, maxStringLength) {\n    if ($scope.activeInterpreters === undefined) {\n      return;\n    }\n    var index = _.findIndex($scope.activeInterpreters, {value: filterValue});\n    if ($scope.activeInterpreters[index].name !== undefined) {\n      if (maxStringLength !== undefined && maxStringLength > $scope.activeInterpreters[index].name) {\n        return $scope.activeInterpreters[index].name.substr(0, maxStringLength - 3) + '...';\n      }\n      return $scope.activeInterpreters[index].name;\n    } else {\n      return 'Interpreter is not set';\n    }\n  };\n\n  $scope.setFilterValue = function(filterValue) {\n    $scope.filterConfig.filterValueInterpreter = filterValue;\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  };\n\n  $scope.onChangeRunJobToAlwaysTopToggle = function() {\n    $scope.filterConfig.isRunningAlwaysTop = !$scope.filterConfig.isRunningAlwaysTop;\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  };\n\n  $scope.onChangeSortAsc = function() {\n    $scope.filterConfig.isSortByAsc = !$scope.filterConfig.isSortByAsc;\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  };\n\n  $scope.doFilterInputTyping = function(keyEvent, jobInfomations, filterConfig) {\n    var RETURN_KEY_CODE = 13;\n    $timeout.cancel($scope.dofilterTimeoutObject);\n    $scope.isActiveSearchTimer = true;\n    $scope.dofilterTimeoutObject = $timeout(function() {\n      $scope.doFiltering(jobInfomations, filterConfig);\n      $scope.isActiveSearchTimer = false;\n    }, 10000);\n    if (keyEvent.which === RETURN_KEY_CODE) {\n      $timeout.cancel($scope.dofilterTimeoutObject);\n      $scope.doFiltering(jobInfomations, filterConfig);\n      $scope.isActiveSearchTimer = false;\n    }\n  };\n\n  $scope.doForceFilterInputTyping = function(keyEvent, jobInfomations, filterConfig) {\n    $timeout.cancel($scope.dofilterTimeoutObject);\n    $scope.doFiltering(jobInfomations, filterConfig);\n    $scope.isActiveSearchTimer = false;\n  };\n\n  $scope.init = function() {\n    $scope.isLoadingFilter = true;\n    $scope.jobInfomations = [];\n    $scope.JobInfomationsByFilter = $scope.jobInfomations;\n    $scope.filterConfig = {\n      isRunningAlwaysTop: true,\n      filterValueNotebookName: '',\n      filterValueInterpreter: '*',\n      isSortByAsc: true\n    };\n    $scope.sortTooltipMsg = 'Switch to sort by desc';\n    $scope.jobTypeFilter = jobManagerFilter;\n\n    websocketMsgSrv.getNoteJobsList();\n\n    $scope.$watch('filterConfig.isSortByAsc', function (value) {\n      if (value) {\n        $scope.sortTooltipMsg = 'Switch to sort by desc';\n      } else {\n        $scope.sortTooltipMsg = 'Switch to sort by asc';\n      }\n    });\n\n    $scope.$on('$destroy', function() {\n      websocketMsgSrv.unsubscribeJobManager();\n    });\n  };\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteJobs', function(event, responseData) {\n    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n    $scope.jobInfomations = responseData.jobs;\n    $scope.jobInfomationsIndexs = $scope.jobInfomations ? _.indexBy($scope.jobInfomations, 'noteId') : {};\n    $scope.jobTypeFilter($scope.jobInfomations, $scope.filterConfig);\n    $scope.activeInterpreters = [\n      {\n        name: 'ALL',\n        value: '*'\n      }\n    ];\n    var interpreterLists = _.uniq(_.pluck($scope.jobInfomations, 'interpreter'), false);\n    for (var index = 0, length = interpreterLists.length; index < length; index++) {\n      $scope.activeInterpreters.push({\n        name: interpreterLists[index],\n        value: interpreterLists[index]\n      });\n    }\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  });\n\n  $scope.$on('setUpdateNoteJobs', function(event, responseData) {\n    var jobInfomations = $scope.jobInfomations;\n    var indexStore = $scope.jobInfomationsIndexs;\n    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n    var notes = responseData.jobs;\n    notes.map(function(changedItem) {\n      if (indexStore[changedItem.noteId] === undefined) {\n        var newItem = angular.copy(changedItem);\n        jobInfomations.push(newItem);\n        indexStore[changedItem.noteId] = newItem;\n      } else {\n        var changeOriginTarget = indexStore[changedItem.noteId];\n\n        if (changedItem.isRemoved !== undefined && changedItem.isRemoved === true) {\n\n          // remove Item.\n          var removeIndex = _.findIndex(indexStore, changedItem.noteId);\n          if (removeIndex > -1) {\n            indexStore.splice(removeIndex, 1);\n          }\n\n          removeIndex = _.findIndex(jobInfomations, {'noteId': changedItem.noteId});\n          if (removeIndex) {\n            jobInfomations.splice(removeIndex, 1);\n          }\n\n        } else {\n          // change value for item.\n          changeOriginTarget.isRunningJob = changedItem.isRunningJob;\n          changeOriginTarget.noteName = changedItem.noteName;\n          changeOriginTarget.noteType = changedItem.noteType;\n          changeOriginTarget.interpreter = changedItem.interpreter;\n          changeOriginTarget.unixTimeLastRun = changedItem.unixTimeLastRun;\n          changeOriginTarget.paragraphs = changedItem.paragraphs;\n        }\n      }\n    });\n    $scope.doFiltering(jobInfomations, $scope.filterConfig);\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/jobmanager/jobmanager.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('JobCtrl', JobCtrl);\n\nJobCtrl.$inject = ['$scope', '$http', 'baseUrlSrv'];\n\nfunction JobCtrl($scope, $http, baseUrlSrv) {\n  $scope.init = function(jobInformation) {\n    $scope.progressValue = 0;\n  };\n\n  $scope.getProgress = function() {\n    var statusList = _.pluck($scope.notebookJob.paragraphs, 'status');\n    var runningJob = _.countBy(statusList, function(status) {\n      if (status === 'FINISHED' || status === 'RUNNING') {\n        return 'matchCount';\n      } else {\n        return 'none';\n      }\n    });\n    var totalCount = statusList.length;\n    var runningJobCount = runningJob.matchCount;\n    var result = Math.ceil(runningJobCount / totalCount * 100);\n    return isNaN(result) ? 0 : result;\n  };\n\n  $scope.runNotebookJob = function(notebookId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Run all paragraphs?',\n      callback: function(result) {\n        if (result) {\n          $http({\n            method: 'POST',\n            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            }\n          }).then(function successCallback(response) {\n            // success\n          }, function errorCallback(errorResponse) {\n            var errorText = 'SERVER ERROR';\n            if (!!errorResponse.data.message) {\n              errorText = errorResponse.data.message;\n            }\n            BootstrapDialog.alert({\n              closable: true,\n              title: 'Execution Failure',\n              message: errorText\n            });\n          });\n        }\n      }\n    });\n  };\n\n  $scope.stopNotebookJob = function(notebookId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Stop all paragraphs?',\n      callback: function(result) {\n        if (result) {\n          $http({\n            method: 'DELETE',\n            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            }\n          }).then(function successCallback(response) {\n            // success\n          }, function errorCallback(errorResponse) {\n            var errorText = 'SERVER ERROR';\n            if (!!errorResponse.data.message) {\n\n              errorText = errorResponse.data.message;\n            }\n            BootstrapDialog.alert({\n              closable: true,\n              title: 'Stop Failure',\n              message: errorText\n            });\n          });\n        }\n      }\n    });\n  };\n\n  $scope.lastExecuteTime = function(unixtime) {\n    return moment.unix(unixtime / 1000).fromNow();\n  };\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/jobmanager/jobs/job.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').filter('jobManager', jobManagerFilter);\n\nfunction jobManagerFilter() {\n  function filterContext(jobItems, filterConfig) {\n    var filterValueInterpreter = filterConfig.filterValueInterpreter;\n    var filterValueNotebookName = filterConfig.filterValueNotebookName;\n    var isSortByAsc = filterConfig.isSortByAsc;\n    var filterItems = jobItems;\n\n    if (filterValueInterpreter === undefined) {\n      filterItems = _.filter(filterItems, function(jobItem) {\n        return jobItem.interpreter === undefined ? true : false;\n      });\n    } else if (filterValueInterpreter !== '*') {\n      filterItems = _.where(filterItems, {interpreter: filterValueInterpreter});\n    }\n\n    if (filterValueNotebookName !== '') {\n      filterItems = _.filter(filterItems, function(jobItem) {\n        var lowerFilterValue = filterValueNotebookName.toLocaleLowerCase();\n        var lowerNotebookName = jobItem.noteName.toLocaleLowerCase();\n        return lowerNotebookName.match(new RegExp('.*' + lowerFilterValue + '.*'));\n      });\n    }\n\n    filterItems = _.sortBy(filterItems, function(sortItem) {\n      return sortItem.noteName.toLowerCase();\n    });\n\n    return isSortByAsc ? filterItems : filterItems.reverse();\n  }\n  return filterContext;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/jobmanager/jobmanager.filter.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('InterpreterCtrl', InterpreterCtrl);\n\nInterpreterCtrl.$inject = ['$rootScope', '$scope', '$http', 'baseUrlSrv', 'ngToast', '$timeout', '$route'];\n\nfunction InterpreterCtrl($rootScope, $scope, $http, baseUrlSrv, ngToast, $timeout, $route) {\n  var interpreterSettingsTmp = [];\n  $scope.interpreterSettings = [];\n  $scope.availableInterpreters = {};\n  $scope.showAddNewSetting = false;\n  $scope.showRepositoryInfo = false;\n  $scope.searchInterpreter = '';\n  $scope._ = _;\n  ngToast.dismiss();\n\n  $scope.openPermissions = function() {\n    $scope.showInterpreterAuth = true;\n  };\n\n  $scope.closePermissions = function() {\n    $scope.showInterpreterAuth = false;\n  };\n\n  var getSelectJson = function() {\n    var selectJson = {\n      tags: false,\n      multiple: true,\n      tokenSeparators: [',', ' '],\n      minimumInputLength: 2,\n      ajax: {\n        url: function(params) {\n          if (!params.term) {\n            return false;\n          }\n          return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n        },\n        delay: 250,\n        processResults: function(data, params) {\n          var users = [];\n          if (data.body.users.length !== 0) {\n            for (var i = 0; i < data.body.users.length; i++) {\n              users.push({\n                'id': data.body.users[i],\n                'text': data.body.users[i]\n              });\n            }\n          }\n          return {\n            results: users,\n            pagination: {\n              more: false\n            }\n          };\n        },\n        cache: false\n      }\n    };\n    return selectJson;\n  };\n\n  $scope.togglePermissions = function(intpName) {\n    angular.element('#' + intpName + 'Users').select2(getSelectJson());\n    if ($scope.showInterpreterAuth) {\n      $scope.closePermissions();\n    } else {\n      $scope.openPermissions();\n    }\n  };\n\n  $scope.$on('ngRenderFinished', function(event, data) {\n    for (var setting = 0; setting < $scope.interpreterSettings.length; setting++) {\n      angular.element('#' + $scope.interpreterSettings[setting].name + 'Users').select2(getSelectJson());\n    }\n  });\n\n  var getInterpreterSettings = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting')\n      .success(function(data, status, headers, config) {\n        $scope.interpreterSettings = data.body;\n        checkDownloadingDependencies();\n      }).error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var checkDownloadingDependencies = function() {\n    var isDownloading = false;\n    for (var index = 0; index < $scope.interpreterSettings.length; index++) {\n      var setting = $scope.interpreterSettings[index];\n      if (setting.status === 'DOWNLOADING_DEPENDENCIES') {\n        isDownloading = true;\n      }\n\n      if (setting.status === 'ERROR' || setting.errorReason) {\n        ngToast.danger({content: 'Error setting properties for interpreter \\'' +\n        setting.group + '.' + setting.name + '\\': ' + setting.errorReason,\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    }\n\n    if (isDownloading) {\n      $timeout(function() {\n        if ($route.current.$$route.originalPath === '/interpreter') {\n          getInterpreterSettings();\n        }\n      }, 2000);\n    }\n  };\n\n  var getAvailableInterpreters = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter').success(function(data, status, headers, config) {\n      $scope.availableInterpreters = data.body;\n    }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var emptyNewProperty = function(object) {\n    angular.extend(object, {propertyValue: '', propertyKey: ''});\n  };\n\n  var emptyNewDependency = function(object) {\n    angular.extend(object, {depArtifact: '', depExclude: ''});\n  };\n\n  var removeTMPSettings = function(index) {\n    interpreterSettingsTmp.splice(index, 1);\n  };\n\n  $scope.copyOriginInterpreterSettingProperties = function(settingId) {\n    var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n    interpreterSettingsTmp[index] = angular.copy($scope.interpreterSettings[index]);\n  };\n\n  $scope.setPerNoteOption = function(settingId, sessionOption) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (sessionOption === 'isolated') {\n      option.perNote = sessionOption;\n      option.session = false;\n      option.process = true;\n    } else if (sessionOption === 'scoped') {\n      option.perNote = sessionOption;\n      option.session = true;\n      option.process = false;\n    } else {\n      option.perNote = 'shared';\n      option.session = false;\n      option.process = false;\n    }\n  };\n\n  $scope.setPerUserOption = function(settingId, sessionOption) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (sessionOption === 'isolated') {\n      option.perUser = sessionOption;\n      option.session = false;\n      option.process = true;\n    } else if (sessionOption === 'scoped') {\n      option.perUser = sessionOption;\n      option.session = true;\n      option.process = false;\n    } else {\n      option.perUser = 'shared';\n      option.session = false;\n      option.process = false;\n    }\n  };\n\n  $scope.getPerNoteOption = function(settingId) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (option.perNote === 'scoped') {\n      return 'scoped';\n    } else if (option.perNote === 'isolated') {\n      return 'isolated';\n    } else {\n      return 'shared';\n    }\n  };\n\n  $scope.getPerUserOption = function(settingId) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (option.perUser === 'scoped') {\n      return 'scoped';\n    } else if (option.perUser === 'isolated') {\n      return 'isolated';\n    } else {\n      return 'shared';\n    }\n  };\n\n  $scope.getInterpreterRunningOption = function(settingId) {\n    var sharedModeName = 'shared';\n\n    var globallyModeName = 'Globally';\n    var perNoteModeName = 'Per Note';\n    var perUserModeName = 'Per User';\n\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    var perNote = option.perNote;\n    var perUser = option.perUser;\n\n    // Globally == shared_perNote + shared_perUser\n    if (perNote === sharedModeName && perUser === sharedModeName) {\n      return globallyModeName;\n    }\n\n    if ($rootScope.ticket.ticket === 'anonymous' && $rootScope.ticket.roles === '[]') {\n      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n        return perNoteModeName;\n      }\n    } else if ($rootScope.ticket.ticket !== 'anonymous') {\n      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n        if (perUser !== undefined && typeof perUser === 'string' && perUser !== '') {\n          return perUserModeName;\n        }\n        return perNoteModeName;\n      }\n    }\n\n    option.perNote = sharedModeName;\n    option.perUser = sharedModeName;\n    return globallyModeName;\n  };\n\n  $scope.setInterpreterRunningOption = function(settingId, isPerNoteMode, isPerUserMode) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n    option.perNote = isPerNoteMode;\n    option.perUser = isPerUserMode;\n  };\n\n  $scope.updateInterpreterSetting = function(form, settingId) {\n    var thisConfirm = BootstrapDialog.confirm({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: '',\n      message: 'Do you want to update this interpreter and restart with new settings?',\n      callback: function(result) {\n        if (result) {\n          var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n          var setting = $scope.interpreterSettings[index];\n          if (setting.propertyKey !== '' || setting.propertyKey) {\n            $scope.addNewInterpreterProperty(settingId);\n          }\n          if (setting.depArtifact !== '' || setting.depArtifact) {\n            $scope.addNewInterpreterDependency(settingId);\n          }\n          // add missing field of option\n          if (!setting.option) {\n            setting.option = {};\n          }\n          if (setting.option.isExistingProcess === undefined) {\n            setting.option.isExistingProcess = false;\n          }\n          if (setting.option.setPermission === undefined) {\n            setting.option.setPermission = false;\n          }\n          if (setting.option.isUserImpersonate === undefined) {\n            setting.option.isUserImpersonate = false;\n          }\n          if (!($scope.getInterpreterRunningOption(settingId) === 'Per User' &&\n            $scope.getPerUserOption(settingId) === 'isolated')) {\n            setting.option.isUserImpersonate = false;\n          }\n          if (setting.option.remote === undefined) {\n            // remote always true for now\n            setting.option.remote = true;\n          }\n          setting.option.users = angular.element('#' + setting.name + 'Users').val();\n\n          var request = {\n            option: angular.copy(setting.option),\n            properties: angular.copy(setting.properties),\n            dependencies: angular.copy(setting.dependencies)\n          };\n\n          thisConfirm.$modalFooter.find('button').addClass('disabled');\n          thisConfirm.$modalFooter.find('button:contains(\"OK\")')\n            .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\n          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId, request)\n            .success(function(data, status, headers, config) {\n              $scope.interpreterSettings[index] = data.body;\n              removeTMPSettings(index);\n              checkDownloadingDependencies();\n              thisConfirm.close();\n            })\n            .error(function(data, status, headers, config) {\n              console.log('Error %o %o', status, data.message);\n              ngToast.danger({content: data.message, verticalPosition: 'bottom'});\n              form.$show();\n              thisConfirm.close();\n            });\n          return false;\n        } else {\n          form.$show();\n        }\n      }\n    });\n  };\n\n  $scope.resetInterpreterSetting = function(settingId) {\n    var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n\n    // Set the old settings back\n    $scope.interpreterSettings[index] = angular.copy(interpreterSettingsTmp[index]);\n    removeTMPSettings(index);\n  };\n\n  $scope.removeInterpreterSetting = function(settingId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to delete this interpreter setting?',\n      callback: function(result) {\n        if (result) {\n          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId)\n            .success(function(data, status, headers, config) {\n\n              var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n              $scope.interpreterSettings.splice(index, 1);\n            }).error(function(data, status, headers, config) {\n            console.log('Error %o %o', status, data.message);\n          });\n        }\n      }\n    });\n  };\n\n  $scope.newInterpreterGroupChange = function() {\n    var el = _.pluck(_.filter($scope.availableInterpreters, {'name': $scope.newInterpreterSetting.group}),\n      'properties');\n    var properties = {};\n    for (var i = 0; i < el.length; i++) {\n      var intpInfo = el[i];\n      for (var key in intpInfo) {\n        properties[key] = {\n          value: intpInfo[key].defaultValue,\n          description: intpInfo[key].description\n        };\n      }\n    }\n    $scope.newInterpreterSetting.properties = properties;\n  };\n\n  $scope.restartInterpreterSetting = function(settingId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to restart this interpreter?',\n      callback: function(result) {\n        if (result) {\n          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + settingId)\n            .success(function(data, status, headers, config) {\n              var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n              $scope.interpreterSettings[index] = data.body;\n              ngToast.info('Interpreter stopped. Will be lazily started on next run.');\n            }).error(function(data, status, headers, config) {\n              var errorMsg = (data !== null) ? data.message : 'Could not connect to server.';\n              console.log('Error %o %o', status, errorMsg);\n              ngToast.danger(errorMsg);\n          });\n        }\n      }\n    });\n  };\n\n  $scope.addNewInterpreterSetting = function() {\n    //user input validation on interpreter creation\n    if (!$scope.newInterpreterSetting.name ||\n      !$scope.newInterpreterSetting.name.trim() || !$scope.newInterpreterSetting.group) {\n      BootstrapDialog.alert({\n        closable: true,\n        title: 'Add interpreter',\n        message: 'Please fill in interpreter name and choose a group'\n      });\n      return;\n    }\n\n    if ($scope.newInterpreterSetting.name.indexOf('.') >= 0) {\n      BootstrapDialog.alert({\n        closable: true,\n        title: 'Add interpreter',\n        message: '\\'.\\' is invalid for interpreter name'\n      });\n      return;\n    }\n\n    if (_.findIndex($scope.interpreterSettings, {'name': $scope.newInterpreterSetting.name}) >= 0) {\n      BootstrapDialog.alert({\n        closable: true,\n        title: 'Add interpreter',\n        message: 'Name ' + $scope.newInterpreterSetting.name + ' already exists'\n      });\n      return;\n    }\n\n    var newSetting = $scope.newInterpreterSetting;\n    if (newSetting.propertyKey !== '' || newSetting.propertyKey) {\n      $scope.addNewInterpreterProperty();\n    }\n    if (newSetting.depArtifact !== '' || newSetting.depArtifact) {\n      $scope.addNewInterpreterDependency();\n    }\n    if (newSetting.option.setPermission === undefined) {\n      newSetting.option.setPermission = false;\n    }\n    newSetting.option.users = angular.element('#newInterpreterUsers').val();\n\n    var request = angular.copy($scope.newInterpreterSetting);\n\n    // Change properties to proper request format\n    var newProperties = {};\n    for (var p in newSetting.properties) {\n      newProperties[p] = newSetting.properties[p].value;\n    }\n    request.properties = newProperties;\n\n    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/setting', request)\n      .success(function(data, status, headers, config) {\n        $scope.resetNewInterpreterSetting();\n        getInterpreterSettings();\n        $scope.showAddNewSetting = false;\n        checkDownloadingDependencies();\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n      ngToast.danger({content: data.message, verticalPosition: 'bottom'});\n    });\n  };\n\n  $scope.cancelInterpreterSetting = function() {\n    $scope.showAddNewSetting = false;\n    $scope.resetNewInterpreterSetting();\n  };\n\n  $scope.resetNewInterpreterSetting = function() {\n    $scope.newInterpreterSetting = {\n      name: undefined,\n      group: undefined,\n      properties: {},\n      dependencies: [],\n      option: {\n        remote: true,\n        isExistingProcess: false,\n        setPermission: false,\n        session: false,\n        process: false\n\n      }\n    };\n    emptyNewProperty($scope.newInterpreterSetting);\n  };\n\n  $scope.removeInterpreterProperty = function(key, settingId) {\n    if (settingId === undefined) {\n      delete $scope.newInterpreterSetting.properties[key];\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      delete $scope.interpreterSettings[index].properties[key];\n    }\n  };\n\n  $scope.removeInterpreterDependency = function(artifact, settingId) {\n    if (settingId === undefined) {\n      $scope.newInterpreterSetting.dependencies = _.reject($scope.newInterpreterSetting.dependencies,\n        function(el) {\n          return el.groupArtifactVersion === artifact;\n        });\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      $scope.interpreterSettings[index].dependencies = _.reject($scope.interpreterSettings[index].dependencies,\n        function(el) {\n          return el.groupArtifactVersion === artifact;\n        });\n    }\n  };\n\n  $scope.addNewInterpreterProperty = function(settingId) {\n    if (settingId === undefined) {\n      // Add new property from create form\n      if (!$scope.newInterpreterSetting.propertyKey || $scope.newInterpreterSetting.propertyKey === '') {\n        return;\n      }\n\n      $scope.newInterpreterSetting.properties[$scope.newInterpreterSetting.propertyKey] = {\n        value: $scope.newInterpreterSetting.propertyValue\n      };\n      emptyNewProperty($scope.newInterpreterSetting);\n    } else {\n      // Add new property from edit form\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n\n      if (!setting.propertyKey || setting.propertyKey === '') {\n        return;\n      }\n      setting.properties[setting.propertyKey] = setting.propertyValue;\n      emptyNewProperty(setting);\n    }\n  };\n\n  $scope.addNewInterpreterDependency = function(settingId) {\n    if (settingId === undefined) {\n      // Add new dependency from create form\n      if (!$scope.newInterpreterSetting.depArtifact || $scope.newInterpreterSetting.depArtifact === '') {\n        return;\n      }\n\n      // overwrite if artifact already exists\n      var newSetting = $scope.newInterpreterSetting;\n      for (var d in newSetting.dependencies) {\n        if (newSetting.dependencies[d].groupArtifactVersion === newSetting.depArtifact) {\n          newSetting.dependencies[d] = {\n            'groupArtifactVersion': newSetting.depArtifact,\n            'exclusions': newSetting.depExclude\n          };\n          newSetting.dependencies.splice(d, 1);\n        }\n      }\n\n      newSetting.dependencies.push({\n        'groupArtifactVersion': newSetting.depArtifact,\n        'exclusions': (newSetting.depExclude === '') ? [] : newSetting.depExclude\n      });\n      emptyNewDependency(newSetting);\n    } else {\n      // Add new dependency from edit form\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      if (!setting.depArtifact || setting.depArtifact === '') {\n        return;\n      }\n\n      // overwrite if artifact already exists\n      for (var dep in setting.dependencies) {\n        if (setting.dependencies[dep].groupArtifactVersion === setting.depArtifact) {\n          setting.dependencies[dep] = {\n            'groupArtifactVersion': setting.depArtifact,\n            'exclusions': setting.depExclude\n          };\n          setting.dependencies.splice(dep, 1);\n        }\n      }\n\n      setting.dependencies.push({\n        'groupArtifactVersion': setting.depArtifact,\n        'exclusions': (setting.depExclude === '') ? [] : setting.depExclude\n      });\n      emptyNewDependency(setting);\n    }\n  };\n\n  $scope.resetNewRepositorySetting = function() {\n    $scope.newRepoSetting = {\n      id: '',\n      url: '',\n      snapshot: false,\n      username: '',\n      password: '',\n      proxyProtocol: 'HTTP',\n      proxyHost: '',\n      proxyPort: null,\n      proxyLogin: '',\n      proxyPassword: ''\n    };\n  };\n\n  var getRepositories = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/repository')\n      .success(function(data, status, headers, config) {\n        $scope.repositories = data.body;\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  $scope.addNewRepository = function() {\n    var request = angular.copy($scope.newRepoSetting);\n\n    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/repository', request)\n      .success(function(data, status, headers, config) {\n        getRepositories();\n        $scope.resetNewRepositorySetting();\n        angular.element('#repoModal').modal('hide');\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', headers, config);\n    });\n  };\n\n  $scope.removeRepository = function(repoId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to delete this repository?',\n      callback: function(result) {\n        if (result) {\n          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/repository/' + repoId)\n            .success(function(data, status, headers, config) {\n              var index = _.findIndex($scope.repositories, {'id': repoId});\n              $scope.repositories.splice(index, 1);\n            }).error(function(data, status, headers, config) {\n            console.log('Error %o %o', status, data.message);\n          });\n        }\n      }\n    });\n  };\n\n  $scope.isDefaultRepository = function(repoId) {\n    if (repoId === 'central' || repoId === 'local') {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  $scope.showErrorMessage = function(setting) {\n    BootstrapDialog.show({\n      title: 'Error downloading dependencies',\n      message: setting.errorReason\n    });\n  };\n\n  var init = function() {\n    $scope.resetNewInterpreterSetting();\n    $scope.resetNewRepositorySetting();\n\n    getInterpreterSettings();\n    getAvailableInterpreters();\n    getRepositories();\n  };\n\n  $scope.showSparkUI = function(settingId) {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/getmetainfos/' + settingId + '?propName=url')\n      .success(function(data, status, headers, config) {\n        var url = data.body.url;\n        if (!url) {\n          BootstrapDialog.alert({\n            message: 'No spark application running'\n          });\n          return;\n        }\n        window.open(url, '_blank');\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  init();\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/interpreter/interpreter.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').filter('sortByKey', sortByKey);\n\nfunction sortByKey() {\n  return function(properties) {\n    var sortedKeys = properties ? Object.keys(properties) : [];\n    return sortedKeys.sort();\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/interpreter/interpreter.filter.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('CredentialCtrl', CredentialCtrl);\n\nCredentialCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\nfunction CredentialCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n  $scope._ = _;\n  ngToast.dismiss();\n\n  $scope.credentialInfo = [];\n  $scope.showAddNewCredentialInfo = false;\n  $scope.availableInterpreters = [];\n\n  var getCredentialInfo = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/credential').\n    success(function(data, status, headers, config) {\n      $scope.credentialInfo  = _.map(data.body.userCredentials, function(value, prop) {\n        return {entity: prop, password: value.password, username: value.username};\n      });\n      console.log('Success %o %o', status, $scope.credentialInfo);\n    }).\n    error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  $scope.addNewCredentialInfo = function() {\n    if ($scope.entity && _.isEmpty($scope.entity.trim()) &&\n      $scope.username && _.isEmpty($scope.username.trim())) {\n      ngToast.danger({\n        content: 'Username \\\\ Entity can not be empty.',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      return;\n    }\n\n    var newCredential  = {\n      'entity': $scope.entity,\n      'username': $scope.username,\n      'password': $scope.password\n    };\n\n    $http.put(baseUrlSrv.getRestApiBase() + '/credential', newCredential).\n    success(function(data, status, headers, config) {\n      ngToast.success({\n        content: 'Successfully saved credentials.',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      $scope.credentialInfo.push(newCredential);\n      resetCredentialInfo();\n      $scope.showAddNewCredentialInfo = false;\n      console.log('Success %o %o', status, data.message);\n    }).\n    error(function(data, status, headers, config) {\n      ngToast.danger({\n        content: 'Error saving credentials',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var getAvailableInterpreters = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting')\n      .success(function(data, status, headers, config) {\n        for (var setting = 0; setting < data.body.length; setting++) {\n          $scope.availableInterpreters.push(\n            data.body[setting].group + '.' + data.body[setting].name);\n        }\n        angular.element('#entityname').autocomplete({\n          source: $scope.availableInterpreters,\n          select: function(event, selected) {\n            $scope.entity = selected.item.value;\n            return false;\n          }\n        });\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  $scope.toggleAddNewCredentialInfo = function() {\n    if ($scope.showAddNewCredentialInfo) {\n      $scope.showAddNewCredentialInfo = false;\n    } else {\n      $scope.showAddNewCredentialInfo = true;\n    }\n  };\n\n  $scope.cancelCredentialInfo = function() {\n    $scope.showAddNewCredentialInfo = false;\n    resetCredentialInfo();\n  };\n\n  var resetCredentialInfo = function() {\n    $scope.entity = '';\n    $scope.username = '';\n    $scope.password = '';\n  };\n\n  $scope.copyOriginCredentialsInfo = function() {\n    ngToast.info({\n      content: 'Since entity is a unique key, you can edit only username & password',\n      verticalPosition: 'bottom',\n      timeout: '3000'\n    });\n  };\n\n  $scope.updateCredentialInfo = function(form, data, entity) {\n    var request = {\n      entity: entity,\n      username: data.username,\n      password: data.password\n    };\n\n    $http.put(baseUrlSrv.getRestApiBase() + '/credential/', request).\n    success(function(data, status, headers, config) {\n      var index = _.findIndex($scope.credentialInfo, {'entity': entity});\n      $scope.credentialInfo[index] = request;\n      return true;\n    }).\n    error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n      ngToast.danger({\n        content: 'We couldn\\'t save the credential',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      form.$show();\n    });\n    return false;\n  };\n\n  $scope.removeCredentialInfo = function(entity) {\n    BootstrapDialog.confirm({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: '',\n      message: 'Do you want to delete this credential information?',\n      callback: function(result) {\n        if (result) {\n          $http.delete(baseUrlSrv.getRestApiBase() + '/credential/' + entity).\n          success(function(data, status, headers, config) {\n            var index = _.findIndex($scope.credentialInfo, {'entity': entity});\n            $scope.credentialInfo.splice(index, 1);\n            console.log('Success %o %o', status, data.message);\n          }).\n          error(function(data, status, headers, config) {\n            console.log('Error %o %o', status, data.message);\n          });\n        }\n      }\n    });\n  };\n\n  var init = function() {\n    getAvailableInterpreters();\n    getCredentialInfo();\n  };\n\n  init();\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/credential/credential.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('ConfigurationCtrl', ConfigurationCtrl);\n\nConfigurationCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\nfunction ConfigurationCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n  $scope.configrations = [];\n  $scope._ = _;\n  ngToast.dismiss();\n\n  var getConfigurations = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/configurations/all').\n    success(function(data, status, headers, config) {\n      $scope.configurations = data.body;\n    }).\n    error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var init = function() {\n    getConfigurations();\n  };\n\n  init();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/configuration/configuration.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('ParagraphCtrl', ParagraphCtrl);\n\nParagraphCtrl.$inject = [\n  '$scope',\n  '$rootScope',\n  '$route',\n  '$window',\n  '$routeParams',\n  '$location',\n  '$timeout',\n  '$compile',\n  '$http',\n  '$q',\n  'websocketMsgSrv',\n  'baseUrlSrv',\n  'ngToast',\n  'saveAsService',\n  'noteVarShareService'\n];\n\nfunction ParagraphCtrl($scope, $rootScope, $route, $window, $routeParams, $location,\n                       $timeout, $compile, $http, $q, websocketMsgSrv,\n                       baseUrlSrv, ngToast, saveAsService, noteVarShareService) {\n  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n  $rootScope.keys = Object.keys;\n  $scope.parentNote = null;\n  $scope.paragraph = null;\n  $scope.originalText = '';\n  $scope.editor = null;\n\n  var editorSetting = {};\n  // flag that is used to set editor setting on paste percent sign\n  var pastePercentSign = false;\n  // flag that is used to set editor setting on save interpreter bindings\n  var setInterpreterBindings = false;\n  var paragraphScope = $rootScope.$new(true, $rootScope);\n\n  // to keep backward compatibility\n  $scope.compiledScope = paragraphScope;\n\n  paragraphScope.z = {\n    // z.runParagraph('20150213-231621_168813393')\n    runParagraph: function(paragraphId) {\n      if (paragraphId) {\n        var filtered = $scope.parentNote.paragraphs.filter(function(x) {\n          return x.id === paragraphId;});\n        if (filtered.length === 1) {\n          var paragraph = filtered[0];\n          websocketMsgSrv.runParagraph(paragraph.id, paragraph.title, paragraph.text,\n            paragraph.config, paragraph.settings.params);\n        } else {\n          ngToast.danger({content: 'Cannot find a paragraph with id \\'' + paragraphId + '\\'',\n            verticalPosition: 'top', dismissOnTimeout: false});\n        }\n      } else {\n        ngToast.danger({\n          content: 'Please provide a \\'paragraphId\\' when calling z.runParagraph(paragraphId)',\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    },\n\n    // Example: z.angularBind('my_var', 'Test Value', '20150213-231621_168813393')\n    angularBind: function(varName, value, paragraphId) {\n      // Only push to server if there paragraphId is defined\n      if (paragraphId) {\n        websocketMsgSrv.clientBindAngularObject($routeParams.noteId, varName, value, paragraphId);\n      } else {\n        ngToast.danger({\n          content: 'Please provide a \\'paragraphId\\' when calling ' +\n          'z.angularBind(varName, value, \\'PUT_HERE_PARAGRAPH_ID\\')',\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    },\n\n    // Example: z.angularUnBind('my_var', '20150213-231621_168813393')\n    angularUnbind: function(varName, paragraphId) {\n      // Only push to server if paragraphId is defined\n      if (paragraphId) {\n        websocketMsgSrv.clientUnbindAngularObject($routeParams.noteId, varName, paragraphId);\n      } else {\n        ngToast.danger({\n          content: 'Please provide a \\'paragraphId\\' when calling ' +\n          'z.angularUnbind(varName, \\'PUT_HERE_PARAGRAPH_ID\\')',\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    }\n  };\n\n  var angularObjectRegistry = {};\n\n  // Controller init\n  $scope.init = function(newParagraph, note) {\n    $scope.paragraph = newParagraph;\n    $scope.parentNote = note;\n    $scope.originalText = angular.copy(newParagraph.text);\n    $scope.chart = {};\n    $scope.baseMapOption = ['Streets', 'Satellite', 'Hybrid', 'Topo', 'Gray', 'Oceans', 'Terrain'];\n    $scope.colWidthOption = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n    $scope.paragraphFocused = false;\n    if (newParagraph.focus) {\n      $scope.paragraphFocused = true;\n    }\n    if (!$scope.paragraph.config) {\n      $scope.paragraph.config = {};\n    }\n\n    noteVarShareService.put($scope.paragraph.id + '_paragraphScope', paragraphScope);\n\n    initializeDefault($scope.paragraph.config);\n  };\n\n  var initializeDefault = function(config) {\n    var forms = $scope.paragraph.settings.forms;\n    \n    if (!config.colWidth) {\n      config.colWidth = 12;\n    }\n  \n    if (config.enabled === undefined) {\n      config.enabled = true;\n    }\n  \n    for (var idx in forms) {\n      if (forms[idx]) {\n        if (forms[idx].options) {\n          if (config.runOnSelectionChange === undefined) {\n            config.runOnSelectionChange = true;\n          }\n        }\n      }\n    }\n\n    if (!config.results) {\n      config.results = {};\n    }\n\n    if (!config.editorSetting) {\n      config.editorSetting = {};\n    } else if (config.editorSetting.editOnDblClick) {\n      editorSetting.isOutputHidden = config.editorSetting.editOnDblClick;\n    }\n  };\n\n  $scope.$on('updateParagraphOutput', function(event, data) {\n    if ($scope.paragraph.id === data.paragraphId) {\n      if (!$scope.paragraph.results) {\n        $scope.paragraph.results = {};\n      }\n      if (!$scope.paragraph.results.msg) {\n        $scope.paragraph.results.msg = [];\n      }\n\n      var update = ($scope.paragraph.results.msg[data.index]) ? true : false;\n\n      $scope.paragraph.results.msg[data.index] = {\n        data: data.data,\n        type: data.type\n      };\n\n      if (update) {\n        $rootScope.$broadcast(\n          'updateResult',\n          $scope.paragraph.results.msg[data.index],\n          $scope.paragraph.config.results[data.index],\n          $scope.paragraph,\n          data.index);\n      }\n    }\n  });\n\n  $scope.getIframeDimensions = function() {\n    if ($scope.asIframe) {\n      var paragraphid = '#' + $routeParams.paragraphId + '_container';\n      var height = angular.element(paragraphid).height();\n      return height;\n    }\n    return 0;\n  };\n\n  $scope.$watch($scope.getIframeDimensions, function(newValue, oldValue) {\n    if ($scope.asIframe && newValue) {\n      var message = {};\n      message.height = newValue;\n      message.url = $location.$$absUrl;\n      $window.parent.postMessage(angular.toJson(message), '*');\n    }\n  });\n\n  $scope.getEditor = function() {\n    return $scope.editor;\n  };\n\n  $scope.$watch($scope.getEditor, function(newValue, oldValue) {\n    if (!$scope.editor) {\n      return;\n    }\n    if (newValue === null || newValue === undefined) {\n      console.log('editor isnt loaded yet, returning');\n      return;\n    }\n    if ($scope.revisionView === true) {\n      $scope.editor.setReadOnly(true);\n    } else {\n      $scope.editor.setReadOnly(false);\n    }\n  });\n\n  var isEmpty = function(object) {\n    return !object;\n  };\n\n  $scope.isRunning = function(paragraph) {\n    return paragraph.status === 'RUNNING' || paragraph.status === 'PENDING';\n  };\n\n  $scope.cancelParagraph = function(paragraph) {\n    console.log('Cancel %o', paragraph.id);\n    websocketMsgSrv.cancelParagraphRun(paragraph.id);\n  };\n\n  $scope.runParagraph = function(data) {\n    websocketMsgSrv.runParagraph($scope.paragraph.id, $scope.paragraph.title,\n      data, $scope.paragraph.config, $scope.paragraph.settings.params);\n    $scope.originalText = angular.copy(data);\n    $scope.dirtyText = undefined;\n\n    if ($scope.paragraph.config.editorSetting.editOnDblClick) {\n      closeEditorAndOpenTable($scope.paragraph);\n    } else if (editorSetting.isOutputHidden &&\n      !$scope.paragraph.config.editorSetting.editOnDblClick) {\n      // %md/%angular repl make output to be hidden by default after running\n      // so should open output if repl changed from %md/%angular to another\n      openEditorAndOpenTable($scope.paragraph);\n    }\n    editorSetting.isOutputHidden = $scope.paragraph.config.editorSetting.editOnDblClick;\n  };\n\n  $scope.saveParagraph = function(paragraph) {\n    const dirtyText = paragraph.text;\n    if (dirtyText === undefined || dirtyText === $scope.originalText) {\n      return;\n    }\n    commitParagraph(paragraph);\n    $scope.originalText = dirtyText;\n    $scope.dirtyText = undefined;\n  };\n\n  $scope.toggleEnableDisable = function(paragraph) {\n    paragraph.config.enabled = !paragraph.config.enabled;\n    commitParagraph(paragraph);\n  };\n\n  $scope.run = function(paragraph, editorValue) {\n    if (editorValue && !$scope.isRunning(paragraph)) {\n      $scope.runParagraph(editorValue);\n    }\n  };\n\n  $scope.turnOnAutoRun = function (paragraph) {\n    paragraph.config.runOnSelectionChange = !paragraph.config.runOnSelectionChange;\n    commitParagraph(paragraph);\n  };\n\n  $scope.moveUp = function(paragraph) {\n    $scope.$emit('moveParagraphUp', paragraph);\n  };\n\n  $scope.moveDown = function(paragraph) {\n    $scope.$emit('moveParagraphDown', paragraph);\n  };\n\n  $scope.insertNew = function(position) {\n    $scope.$emit('insertParagraph', $scope.paragraph.id, position);\n  };\n\n  $scope.copyPara = function(position) {\n    var editorValue = $scope.getEditorValue();\n    if (editorValue) {\n      $scope.copyParagraph(editorValue, position);\n    }\n  };\n\n  $scope.copyParagraph = function(data, position) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === $scope.paragraph.id) {\n        //determine position of where to add new paragraph; default is below\n        if (position === 'above') {\n          newIndex = i;\n        } else {\n          newIndex = i + 1;\n        }\n        break;\n      }\n    }\n\n    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n      return;\n    }\n\n    var config = angular.copy($scope.paragraph.config);\n    config.editorHide = false;\n\n    websocketMsgSrv.copyParagraph(newIndex, $scope.paragraph.title, data,\n      config, $scope.paragraph.settings.params);\n  };\n\n  $scope.removeParagraph = function(paragraph) {\n    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n    if (paragraphs[paragraphs.length - 1].id.indexOf(paragraph.id) === 0) {\n      BootstrapDialog.alert({\n        closable: true,\n        message: 'The last paragraph can\\'t be deleted.',\n        callback: function(result) {\n          if (result) {\n            $scope.editor.focus();\n          }\n        }\n      });\n    } else {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: '',\n        message: 'Do you want to delete this paragraph?',\n        callback: function(result) {\n          if (result) {\n            console.log('Remove paragraph');\n            websocketMsgSrv.removeParagraph(paragraph.id);\n            $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n          }\n        }\n      });\n    }\n  };\n\n  $scope.clearParagraphOutput = function(paragraph) {\n    websocketMsgSrv.clearParagraphOutput(paragraph.id);\n  };\n\n  $scope.toggleEditor = function(paragraph) {\n    if (paragraph.config.editorHide) {\n      $scope.openEditor(paragraph);\n    } else {\n      $scope.closeEditor(paragraph);\n    }\n  };\n\n  $scope.closeEditor = function(paragraph) {\n    console.log('close the note');\n    paragraph.config.editorHide = true;\n    commitParagraph(paragraph);\n  };\n\n  $scope.openEditor = function(paragraph) {\n    console.log('open the note');\n    paragraph.config.editorHide = false;\n    commitParagraph(paragraph);\n  };\n\n  $scope.closeTable = function(paragraph) {\n    console.log('close the output');\n    paragraph.config.tableHide = true;\n    commitParagraph(paragraph);\n  };\n\n  $scope.openTable = function(paragraph) {\n    console.log('open the output');\n    paragraph.config.tableHide = false;\n    commitParagraph(paragraph);\n  };\n\n  var openEditorAndCloseTable = function(paragraph) {\n    manageEditorAndTableState(paragraph, false, true);\n  };\n\n  var closeEditorAndOpenTable = function(paragraph) {\n    manageEditorAndTableState(paragraph, true, false);\n  };\n\n  var openEditorAndOpenTable = function(paragraph) {\n    manageEditorAndTableState(paragraph, false, false);\n  };\n\n  var manageEditorAndTableState = function(paragraph, hideEditor, hideTable) {\n    paragraph.config.editorHide = hideEditor;\n    paragraph.config.tableHide = hideTable;\n    commitParagraph(paragraph);\n  };\n\n  $scope.showTitle = function(paragraph) {\n    paragraph.config.title = true;\n    commitParagraph(paragraph);\n  };\n\n  $scope.hideTitle = function(paragraph) {\n    paragraph.config.title = false;\n    commitParagraph(paragraph);\n  };\n\n  $scope.setTitle = function(paragraph) {\n    commitParagraph(paragraph);\n  };\n\n  $scope.showLineNumbers = function(paragraph) {\n    if ($scope.editor) {\n      paragraph.config.lineNumbers = true;\n      $scope.editor.renderer.setShowGutter(true);\n      commitParagraph(paragraph);\n    }\n  };\n\n  $scope.hideLineNumbers = function(paragraph) {\n    if ($scope.editor) {\n      paragraph.config.lineNumbers = false;\n      $scope.editor.renderer.setShowGutter(false);\n      commitParagraph(paragraph);\n    }\n  };\n\n  $scope.columnWidthClass = function(n) {\n    if ($scope.asIframe) {\n      return 'col-md-12';\n    } else {\n      return 'paragraph-col col-md-' + n;\n    }\n  };\n\n  $scope.changeColWidth = function(paragraph, width) {\n    angular.element('.navbar-right.open').removeClass('open');\n    paragraph.config.colWidth = width;\n    commitParagraph(paragraph);\n  };\n\n  $scope.toggleOutput = function(paragraph) {\n    paragraph.config.tableHide = !paragraph.config.tableHide;\n    commitParagraph(paragraph);\n  };\n\n  $scope.loadForm = function(formulaire, params) {\n    var value = formulaire.defaultValue;\n    if (params[formulaire.name]) {\n      value = params[formulaire.name];\n    }\n\n    $scope.paragraph.settings.params[formulaire.name] = value;\n  };\n\n  $scope.toggleCheckbox = function(formulaire, option) {\n    var idx = $scope.paragraph.settings.params[formulaire.name].indexOf(option.value);\n    if (idx > -1) {\n      $scope.paragraph.settings.params[formulaire.name].splice(idx, 1);\n    } else {\n      $scope.paragraph.settings.params[formulaire.name].push(option.value);\n    }\n  };\n\n  $scope.aceChanged = function(_, editor) {\n    var session = editor.getSession();\n    var dirtyText = session.getValue();\n    $scope.dirtyText = dirtyText;\n    $scope.$broadcast('startSaveTimer');\n    setParagraphMode(session, dirtyText, editor.getCursorPosition());\n  };\n\n  $scope.aceLoaded = function(_editor) {\n    var langTools = ace.require('ace/ext/language_tools');\n    var Range = ace.require('ace/range').Range;\n\n    _editor.$blockScrolling = Infinity;\n    $scope.editor = _editor;\n    $scope.editor.on('input', $scope.aceChanged);\n    if (_editor.container.id !== '{{paragraph.id}}_editor') {\n      $scope.editor.renderer.setShowGutter($scope.paragraph.config.lineNumbers);\n      $scope.editor.setShowFoldWidgets(false);\n      $scope.editor.setHighlightActiveLine(false);\n      $scope.editor.setHighlightGutterLine(false);\n      $scope.editor.getSession().setUseWrapMode(true);\n      $scope.editor.setTheme('ace/theme/chrome');\n      $scope.editor.setReadOnly($scope.isRunning($scope.paragraph));\n      if ($scope.paragraphFocused) {\n        $scope.editor.focus();\n        $scope.goToEnd($scope.editor);\n      }\n\n      autoAdjustEditorHeight(_editor);\n      angular.element(window).resize(function() {\n        autoAdjustEditorHeight(_editor);\n      });\n\n      if (navigator.appVersion.indexOf('Mac') !== -1) {\n        $scope.editor.setKeyboardHandler('ace/keyboard/emacs');\n        $rootScope.isMac = true;\n      } else if (navigator.appVersion.indexOf('Win') !== -1 ||\n        navigator.appVersion.indexOf('X11') !== -1 ||\n        navigator.appVersion.indexOf('Linux') !== -1) {\n        $rootScope.isMac = false;\n        // not applying emacs key binding while the binding override Ctrl-v. default behavior of paste text on windows.\n      }\n\n      var remoteCompleter = {\n        getCompletions: function(editor, session, pos, prefix, callback) {\n          if (!editor.isFocused()) {\n            return;\n          }\n\n          pos = session.getTextRange(new Range(0, 0, pos.row, pos.column)).length;\n          var buf = session.getValue();\n\n          websocketMsgSrv.completion($scope.paragraph.id, buf, pos);\n\n          $scope.$on('completionList', function(event, data) {\n            if (data.completions) {\n              var completions = [];\n              for (var c in data.completions) {\n                var v = data.completions[c];\n                completions.push({\n                  name: v.name,\n                  value: v.value,\n                  score: 300\n                });\n              }\n              callback(null, completions);\n            }\n          });\n        }\n      };\n\n      langTools.setCompleters([remoteCompleter, langTools.keyWordCompleter, langTools.snippetCompleter,\n        langTools.textCompleter]);\n\n      $scope.editor.setOptions({\n        enableBasicAutocompletion: true,\n        enableSnippets: false,\n        enableLiveAutocompletion: false\n      });\n\n      $scope.editor.on('focus', function() {\n        handleFocus(true);\n      });\n\n      $scope.editor.on('blur', function() {\n        handleFocus(false);\n      });\n\n      $scope.editor.on('paste', function(e) {\n        if (e.text.indexOf('%') === 0) {\n          pastePercentSign = true;\n        }\n      });\n\n      $scope.editor.getSession().on('change', function(e, editSession) {\n        autoAdjustEditorHeight(_editor);\n      });\n\n      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n\n      // autocomplete on '.'\n      /*\n       $scope.editor.commands.on(\"afterExec\", function(e, t) {\n       if (e.command.name == \"insertstring\" && e.args == \".\" ) {\n       var all = e.editor.completers;\n       //e.editor.completers = [remoteCompleter];\n       e.editor.execCommand(\"startAutocomplete\");\n       //e.editor.completers = all;\n       }\n       });\n       */\n\n      // remove binding\n      $scope.editor.commands.bindKey('ctrl-alt-n.', null);\n      $scope.editor.commands.removeCommand('showSettingsMenu');\n\n      $scope.editor.commands.bindKey('ctrl-alt-l', null);\n      $scope.editor.commands.bindKey('ctrl-alt-w', null);\n      $scope.editor.commands.bindKey('ctrl-alt-a', null);\n      $scope.editor.commands.bindKey('ctrl-alt-k', null);\n      $scope.editor.commands.bindKey('ctrl-alt-e', null);\n      $scope.editor.commands.bindKey('ctrl-alt-t', null);\n\n      // autocomplete on 'ctrl+.'\n      $scope.editor.commands.bindKey('ctrl-.', 'startAutocomplete');\n      $scope.editor.commands.bindKey('ctrl-space', null);\n\n      var keyBindingEditorFocusAction = function(scrollValue) {\n        var numRows = $scope.editor.getSession().getLength();\n        var currentRow = $scope.editor.getCursorPosition().row;\n        if (currentRow === 0 && scrollValue <= 0) {\n          // move focus to previous paragraph\n          $scope.$emit('moveFocusToPreviousParagraph', $scope.paragraph.id);\n        } else if (currentRow === numRows - 1 && scrollValue >= 0) {\n          $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n        } else {\n          $scope.scrollToCursor($scope.paragraph.id, scrollValue);\n        }\n      };\n\n      // handle cursor moves\n      $scope.editor.keyBinding.origOnCommandKey = $scope.editor.keyBinding.onCommandKey;\n      $scope.editor.keyBinding.onCommandKey = function(e, hashId, keyCode) {\n        if ($scope.editor.completer && $scope.editor.completer.activated) { // if autocompleter is active\n        } else {\n          // fix ace editor focus issue in chrome (textarea element goes to top: -1000px after focused by cursor move)\n          if (parseInt(angular.element('#' + $scope.paragraph.id + '_editor > textarea')\n              .css('top').replace('px', '')) < 0) {\n            var position = $scope.editor.getCursorPosition();\n            var cursorPos = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n            angular.element('#' + $scope.paragraph.id + '_editor > textarea').css('top', cursorPos.top);\n          }\n\n          var ROW_UP = -1;\n          var ROW_DOWN = 1;\n\n          switch (keyCode) {\n            case 38:\n              keyBindingEditorFocusAction(ROW_UP);\n              break;\n            case 80:\n              if (e.ctrlKey && !e.altKey) {\n                keyBindingEditorFocusAction(ROW_UP);\n              }\n              break;\n            case 40:\n              keyBindingEditorFocusAction(ROW_DOWN);\n              break;\n            case 78:\n              if (e.ctrlKey && !e.altKey) {\n                keyBindingEditorFocusAction(ROW_DOWN);\n              }\n              break;\n          }\n        }\n        this.origOnCommandKey(e, hashId, keyCode);\n      };\n    }\n  };\n\n  var handleFocus = function(value, isDigestPass) {\n    $scope.paragraphFocused = value;\n    if (isDigestPass === false || isDigestPass === undefined) {\n      // Protect against error in case digest is already running\n      $timeout(function() {\n        // Apply changes since they come from 3rd party library\n        $scope.$digest();\n      });\n    }\n  };\n\n  var getEditorSetting = function(paragraph, interpreterName) {\n    var deferred = $q.defer();\n    websocketMsgSrv.getEditorSetting(paragraph.id, interpreterName);\n    $timeout(\n      $scope.$on('editorSetting', function(event, data) {\n          if (paragraph.id === data.paragraphId) {\n            deferred.resolve(data);\n          }\n        }\n      ), 1000);\n    return deferred.promise;\n  };\n\n  var setEditorLanguage = function(session, language) {\n    var mode = 'ace/mode/';\n    mode += language;\n    $scope.paragraph.config.editorMode = mode;\n    session.setMode(mode);\n  };\n\n  var setParagraphMode = function(session, paragraphText, pos) {\n    // Evaluate the mode only if the the position is undefined\n    // or the first 30 characters of the paragraph have been modified\n    // or cursor position is at beginning of second line.(in case user hit enter after typing %magic)\n    if ((typeof pos === 'undefined') || (pos.row === 0 && pos.column < 30) ||\n      (pos.row === 1 && pos.column === 0) || pastePercentSign) {\n      // If paragraph loading, use config value if exists\n      if ((typeof pos === 'undefined') && $scope.paragraph.config.editorMode &&\n        !setInterpreterBindings) {\n        session.setMode($scope.paragraph.config.editorMode);\n      } else {\n        var magic = getInterpreterName(paragraphText);\n        if (editorSetting.magic !== magic) {\n          editorSetting.magic = magic;\n          getEditorSetting($scope.paragraph, magic)\n            .then(function(setting) {\n              setEditorLanguage(session, setting.editor.language);\n              _.merge($scope.paragraph.config.editorSetting, setting.editor);\n            });\n        }\n      }\n    }\n    pastePercentSign = false;\n    setInterpreterBindings = false;\n  };\n\n  var getInterpreterName = function(paragraphText) {\n    var intpNameRegexp = /^\\s*%(.+?)\\s/g;\n    var match = intpNameRegexp.exec(paragraphText);\n    if (match) {\n      return match[1].trim();\n      // get default interpreter name if paragraph text doesn't start with '%'\n      // TODO(mina): dig into the cause what makes interpreterBindings to have no element\n    } else if ($scope.$parent.interpreterBindings && $scope.$parent.interpreterBindings.length !== 0) {\n      return $scope.$parent.interpreterBindings[0].name;\n    }\n    return '';\n  };\n\n  var autoAdjustEditorHeight = function(editor) {\n    var height =\n      editor.getSession().getScreenLength() *\n      editor.renderer.lineHeight +\n      editor.renderer.scrollBar.getWidth();\n\n    angular.element('#' + editor.container.id).height(height.toString() + 'px');\n    editor.resize();\n  };\n\n  $rootScope.$on('scrollToCursor', function(event) {\n    // scroll on 'scrollToCursor' event only when cursor is in the last paragraph\n    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n    if (paragraphs[paragraphs.length - 1].id.indexOf($scope.paragraph.id) === 0) {\n      $scope.scrollToCursor($scope.paragraph.id, 0);\n    }\n  });\n\n  /** scrollToCursor if it is necessary\n   * when cursor touches scrollTriggerEdgeMargin from the top (or bottom) of the screen, it autoscroll to place cursor around 1/3 of screen height from the top (or bottom)\n   * paragraphId : paragraph that has active cursor\n   * lastCursorMove : 1(down), 0, -1(up) last cursor move event\n   **/\n  $scope.scrollToCursor = function(paragraphId, lastCursorMove) {\n    if (!$scope.editor || !$scope.editor.isFocused()) {\n      // only make sense when editor is focused\n      return;\n    }\n    var lineHeight = $scope.editor.renderer.lineHeight;\n    var headerHeight = 103; // menubar, notebook titlebar\n    var scrollTriggerEdgeMargin = 50;\n\n    var documentHeight = angular.element(document).height();\n    var windowHeight = angular.element(window).height();  // actual viewport height\n\n    var scrollPosition = angular.element(document).scrollTop();\n    var editorPosition = angular.element('#' + paragraphId + '_editor').offset();\n    var position = $scope.editor.getCursorPosition();\n    var lastCursorPosition = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n\n    var calculatedCursorPosition = editorPosition.top + lastCursorPosition.top + lineHeight * lastCursorMove;\n\n    var scrollTargetPos;\n    if (calculatedCursorPosition < scrollPosition + headerHeight + scrollTriggerEdgeMargin) {\n      scrollTargetPos = calculatedCursorPosition - headerHeight - ((windowHeight - headerHeight) / 3);\n      if (scrollTargetPos < 0) {\n        scrollTargetPos = 0;\n      }\n    } else if (calculatedCursorPosition > scrollPosition + scrollTriggerEdgeMargin + windowHeight - headerHeight) {\n      scrollTargetPos = calculatedCursorPosition - headerHeight - ((windowHeight - headerHeight) * 2 / 3);\n\n      if (scrollTargetPos > documentHeight) {\n        scrollTargetPos = documentHeight;\n      }\n    }\n\n    // cancel previous scroll animation\n    var bodyEl = angular.element('body');\n    bodyEl.stop();\n    bodyEl.finish();\n\n    // scroll to scrollTargetPos\n    bodyEl.scrollTo(scrollTargetPos, {axis: 'y', interrupt: true, duration: 100});\n  };\n\n  $scope.getEditorValue = function() {\n    return !$scope.editor ? $scope.paragraph.text : $scope.editor.getValue();\n  };\n\n  $scope.getProgress = function() {\n    return $scope.currentProgress || 0;\n  };\n\n  $scope.getExecutionTime = function(pdata) {\n    var timeMs = Date.parse(pdata.dateFinished) - Date.parse(pdata.dateStarted);\n    if (isNaN(timeMs) || timeMs < 0) {\n      if ($scope.isResultOutdated(pdata)) {\n        return 'outdated';\n      }\n      return '';\n    }\n    var user = (pdata.user === undefined || pdata.user === null) ? 'anonymous' : pdata.user;\n    var desc = 'Took ' + moment.duration((timeMs / 1000), 'seconds').format('h [hrs] m [min] s [sec]') +\n      '. Last updated by ' + user + ' at ' + moment(pdata.dateFinished).format('MMMM DD YYYY, h:mm:ss A') + '.';\n    if ($scope.isResultOutdated(pdata)) {\n      desc += ' (outdated)';\n    }\n    return desc;\n  };\n\n  $scope.getElapsedTime = function(paragraph) {\n    return 'Started ' + moment(paragraph.dateStarted).fromNow() + '.';\n  };\n\n  $scope.isResultOutdated = function(pdata) {\n    if (pdata.dateUpdated !== undefined && Date.parse(pdata.dateUpdated) > Date.parse(pdata.dateStarted)) {\n      return true;\n    }\n    return false;\n  };\n\n  $scope.goToEnd = function(editor) {\n    editor.navigateFileEnd();\n  };\n\n  $scope.getResultType = function(paragraph) {\n    var pdata = (paragraph) ? paragraph : $scope.paragraph;\n    if (pdata.results && pdata.results.type) {\n      return pdata.results.type;\n    } else {\n      return 'TEXT';\n    }\n  };\n\n  $scope.parseTableCell = function(cell) {\n    if (!isNaN(cell)) {\n      if (cell.length === 0 || Number(cell) > Number.MAX_SAFE_INTEGER || Number(cell) < Number.MIN_SAFE_INTEGER) {\n        return cell;\n      } else {\n        return Number(cell);\n      }\n    }\n    var d = moment(cell);\n    if (d.isValid()) {\n      return d;\n    }\n    return cell;\n  };\n\n  var commitParagraph = function(paragraph) {\n    const {\n      id,\n      title,\n      text,\n      config,\n      settings: {params},\n    } = paragraph;\n\n    websocketMsgSrv.commitParagraph(id, title, text, config, params);\n  };\n\n  /** Utility function */\n  $scope.goToSingleParagraph = function() {\n    var noteId = $route.current.pathParams.noteId;\n    var redirectToUrl = location.protocol + '//' + location.host + location.pathname + '#/notebook/' + noteId +\n      '/paragraph/' + $scope.paragraph.id + '?asIframe';\n    $window.open(redirectToUrl);\n  };\n\n  $scope.showScrollDownIcon = function(id) {\n    var doc = angular.element('#p' + id + '_text');\n    if (doc[0]) {\n      return doc[0].scrollHeight > doc.innerHeight();\n    }\n    return false;\n  };\n\n  $scope.scrollParagraphDown = function(id) {\n    var doc = angular.element('#p' + id + '_text');\n    doc.animate({scrollTop: doc[0].scrollHeight}, 500);\n    $scope.keepScrollDown = true;\n  };\n\n  $scope.showScrollUpIcon = function(id) {\n    if (angular.element('#p' + id + '_text')[0]) {\n      return angular.element('#p' + id + '_text')[0].scrollTop !== 0;\n    }\n    return false;\n\n  };\n\n  $scope.scrollParagraphUp = function(id) {\n    var doc = angular.element('#p' + id + '_text');\n    doc.animate({scrollTop: 0}, 500);\n    $scope.keepScrollDown = false;\n  };\n\n  $scope.$on('angularObjectUpdate', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n        scope = paragraphScope;\n        registry = angularObjectRegistry;\n      } else {\n        return;\n      }\n      var varName = data.angularObject.name;\n\n      if (angular.equals(data.angularObject.object, scope[varName])) {\n        // return when update has no change\n        return;\n      }\n\n      if (!registry[varName]) {\n        registry[varName] = {\n          interpreterGroupId: data.interpreterGroupId,\n          noteId: data.noteId,\n          paragraphId: data.paragraphId\n        };\n      } else {\n        registry[varName].noteId = registry[varName].noteId || data.noteId;\n        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n      }\n\n      registry[varName].skipEmit = true;\n\n      if (!registry[varName].clearWatcher) {\n        registry[varName].clearWatcher = scope.$watch(varName, function(newValue, oldValue) {\n          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n          if (registry[varName].skipEmit) {\n            registry[varName].skipEmit = false;\n            return;\n          }\n          websocketMsgSrv.updateAngularObject(\n            registry[varName].noteId,\n            registry[varName].paragraphId,\n            varName,\n            newValue,\n            registry[varName].interpreterGroupId);\n        });\n      }\n      console.log('angular object (paragraph) created %o', varName);\n      scope[varName] = data.angularObject.object;\n\n      // create proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = function() {\n          scope[varName] = arguments;\n          console.log('angular function (paragraph) invoked %o', arguments);\n        };\n\n        console.log('angular function (paragraph) created %o', scope[funcName]);\n      }\n    }\n  });\n\n  $scope.$on('angularObjectRemove', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n        scope = paragraphScope;\n        registry = angularObjectRegistry;\n      } else {\n        return;\n      }\n\n      var varName = data.name;\n\n      // clear watcher\n      if (registry[varName]) {\n        registry[varName].clearWatcher();\n        registry[varName] = undefined;\n      }\n\n      // remove scope variable\n      scope[varName] = undefined;\n\n      // remove proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = undefined;\n      }\n    }\n  });\n\n  $scope.$on('updateParagraph', function(event, data) {\n    if (data.paragraph.id === $scope.paragraph.id &&\n      (data.paragraph.dateCreated !== $scope.paragraph.dateCreated ||\n      data.paragraph.dateFinished !== $scope.paragraph.dateFinished ||\n      data.paragraph.dateStarted !== $scope.paragraph.dateStarted ||\n      data.paragraph.dateUpdated !== $scope.paragraph.dateUpdated ||\n      data.paragraph.status !== $scope.paragraph.status ||\n      data.paragraph.jobName !== $scope.paragraph.jobName ||\n      data.paragraph.title !== $scope.paragraph.title ||\n      isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) ||\n      data.paragraph.errorMessage !== $scope.paragraph.errorMessage ||\n      !angular.equals(data.paragraph.settings, $scope.paragraph.settings) ||\n      !angular.equals(data.paragraph.config, $scope.paragraph.config))\n    ) {\n      var statusChanged = (data.paragraph.status !== $scope.paragraph.status);\n      var resultRefreshed = (data.paragraph.dateFinished !== $scope.paragraph.dateFinished) ||\n        isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) ||\n        data.paragraph.status === 'ERROR' || (data.paragraph.status === 'FINISHED' && statusChanged);\n\n      if ($scope.paragraph.text !== data.paragraph.text) {\n        if ($scope.dirtyText) {         // check if editor has local update\n          if ($scope.dirtyText === data.paragraph.text) {  // when local update is the same from remote, clear local update\n            $scope.paragraph.text = data.paragraph.text;\n            $scope.dirtyText = undefined;\n            $scope.originalText = angular.copy(data.paragraph.text);\n          } else { // if there're local update, keep it.\n            $scope.paragraph.text = data.paragraph.text;\n          }\n        } else {\n          $scope.paragraph.text = data.paragraph.text;\n          $scope.originalText = angular.copy(data.paragraph.text);\n        }\n      }\n\n      /** broadcast update to result controller **/\n      if (data.paragraph.results && data.paragraph.results.msg) {\n        for (var i in data.paragraph.results.msg) {\n          var newResult = data.paragraph.results.msg ? data.paragraph.results.msg[i] : {};\n          var oldResult = ($scope.paragraph.results && $scope.paragraph.results.msg) ?\n            $scope.paragraph.results.msg[i] : {};\n          var newConfig = data.paragraph.config.results ? data.paragraph.config.results[i] : {};\n          var oldConfig = $scope.paragraph.config.results ? $scope.paragraph.config.results[i] : {};\n          if (!angular.equals(newResult, oldResult) ||\n            !angular.equals(newConfig, oldConfig)) {\n            $rootScope.$broadcast('updateResult', newResult, newConfig, data.paragraph, parseInt(i));\n          }\n        }\n      }\n\n      // resize col width\n      if ($scope.paragraph.config.colWidth !== data.paragraph.colWidth) {\n        $rootScope.$broadcast('paragraphResized', $scope.paragraph.id);\n      }\n\n      /** push the rest */\n      $scope.paragraph.aborted = data.paragraph.aborted;\n      $scope.paragraph.user = data.paragraph.user;\n      $scope.paragraph.dateUpdated = data.paragraph.dateUpdated;\n      $scope.paragraph.dateCreated = data.paragraph.dateCreated;\n      $scope.paragraph.dateFinished = data.paragraph.dateFinished;\n      $scope.paragraph.dateStarted = data.paragraph.dateStarted;\n      $scope.paragraph.errorMessage = data.paragraph.errorMessage;\n      $scope.paragraph.jobName = data.paragraph.jobName;\n      $scope.paragraph.title = data.paragraph.title;\n      $scope.paragraph.lineNumbers = data.paragraph.lineNumbers;\n      $scope.paragraph.status = data.paragraph.status;\n      if (data.paragraph.status !== 'RUNNING') {\n        $scope.paragraph.results = data.paragraph.results;\n      }\n      $scope.paragraph.settings = data.paragraph.settings;\n      if ($scope.editor) {\n        $scope.editor.setReadOnly($scope.isRunning(data.paragraph));\n      }\n\n      if (!$scope.asIframe) {\n        $scope.paragraph.config = data.paragraph.config;\n        initializeDefault(data.paragraph.config);\n      } else {\n        data.paragraph.config.editorHide = true;\n        data.paragraph.config.tableHide = false;\n        $scope.paragraph.config = data.paragraph.config;\n      }\n\n      if (statusChanged || resultRefreshed) {\n        // when last paragraph runs, zeppelin automatically appends new paragraph.\n        // this broadcast will focus to the newly inserted paragraph\n        var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n        if (paragraphs.length >= 2 && paragraphs[paragraphs.length - 2].id.indexOf($scope.paragraph.id) === 0) {\n          // rendering output can took some time. So delay scrolling event firing for sometime.\n          setTimeout(function() {\n            $rootScope.$broadcast('scrollToCursor');\n          }, 500);\n        }\n      }\n    }\n  });\n\n  $scope.$on('updateProgress', function(event, data) {\n    if (data.id === $scope.paragraph.id) {\n      $scope.currentProgress = data.progress;\n    }\n  });\n\n  $scope.$on('keyEvent', function(event, keyEvent) {\n    if ($scope.paragraphFocused) {\n\n      var paragraphId = $scope.paragraph.id;\n      var keyCode = keyEvent.keyCode;\n      var noShortcutDefined = false;\n      var editorHide = $scope.paragraph.config.editorHide;\n\n      if (editorHide && (keyCode === 38 || (keyCode === 80 && keyEvent.ctrlKey && !keyEvent.altKey))) { // up\n        // move focus to previous paragraph\n        $scope.$emit('moveFocusToPreviousParagraph', paragraphId);\n      } else if (editorHide && (keyCode === 40 || (keyCode === 78 && keyEvent.ctrlKey && !keyEvent.altKey))) { // down\n        // move focus to next paragraph\n        $scope.$emit('moveFocusToNextParagraph', paragraphId);\n      } else if (keyEvent.shiftKey && keyCode === 13) { // Shift + Enter\n        $scope.run($scope.paragraph, $scope.getEditorValue());\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 67) { // Ctrl + Alt + c\n        $scope.cancelParagraph($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 68) { // Ctrl + Alt + d\n        $scope.removeParagraph($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 75) { // Ctrl + Alt + k\n        $scope.moveUp($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 74) { // Ctrl + Alt + j\n        $scope.moveDown($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 65) { // Ctrl + Alt + a\n        $scope.insertNew('above');\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 66) { // Ctrl + Alt + b\n        $scope.insertNew('below');\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 79) { // Ctrl + Alt + o\n        $scope.toggleOutput($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 82) { // Ctrl + Alt + r\n        $scope.toggleEnableDisable($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 69) { // Ctrl + Alt + e\n        $scope.toggleEditor($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 77) { // Ctrl + Alt + m\n        if ($scope.paragraph.config.lineNumbers) {\n          $scope.hideLineNumbers($scope.paragraph);\n        } else {\n          $scope.showLineNumbers($scope.paragraph);\n        }\n      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 189) { // Ctrl + Shift + -\n        $scope.changeColWidth($scope.paragraph, Math.max(1, $scope.paragraph.config.colWidth - 1));\n      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 187) { // Ctrl + Shift + =\n        $scope.changeColWidth($scope.paragraph, Math.min(12, $scope.paragraph.config.colWidth + 1));\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 84) { // Ctrl + Alt + t\n        if ($scope.paragraph.config.title) {\n          $scope.hideTitle($scope.paragraph);\n        } else {\n          $scope.showTitle($scope.paragraph);\n        }\n      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 67) { // Ctrl + Alt + c\n        $scope.copyPara('below');\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 76) { // Ctrl + Alt + l\n        $scope.clearParagraphOutput($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 87) { // Ctrl + Alt + w\n        $scope.goToSingleParagraph();\n      } else {\n        noShortcutDefined = true;\n      }\n\n      if (!noShortcutDefined) {\n        keyEvent.preventDefault();\n      }\n    }\n  });\n\n  $scope.$on('focusParagraph', function(event, paragraphId, cursorPos, mouseEvent) {\n    if ($scope.paragraph.id === paragraphId) {\n      // focus editor\n      if (!$scope.paragraph.config.editorHide) {\n        if (!mouseEvent) {\n          $scope.editor.focus();\n          // move cursor to the first row (or the last row)\n          var row;\n          if (cursorPos >= 0) {\n            row = cursorPos;\n            $scope.editor.gotoLine(row, 0);\n          } else {\n            row = $scope.editor.session.getLength();\n            $scope.editor.gotoLine(row, 0);\n          }\n          $scope.scrollToCursor($scope.paragraph.id, 0);\n        }\n      }\n      handleFocus(true);\n    } else {\n      if ($scope.editor !== undefined && $scope.editor !== null) {\n        $scope.editor.blur();\n      }\n      var isDigestPass = true;\n      handleFocus(false, isDigestPass);\n    }\n  });\n\n  $scope.$on('saveInterpreterBindings', function(event, paragraphId) {\n    if ($scope.paragraph.id === paragraphId && $scope.editor) {\n      setInterpreterBindings = true;\n      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n    }\n  });\n\n  $scope.$on('doubleClickParagraph', function(event, paragraphId) {\n    if ($scope.paragraph.id === paragraphId && $scope.paragraph.config.editorHide &&\n      $scope.paragraph.config.editorSetting.editOnDblClick && $scope.revisionView !== true) {\n      var deferred = $q.defer();\n      openEditorAndCloseTable($scope.paragraph);\n      $timeout(\n        $scope.$on('updateParagraph', function(event, data) {\n            deferred.resolve(data);\n          }\n        ), 1000);\n\n      deferred.promise.then(function(data) {\n        if ($scope.editor) {\n          $scope.editor.focus();\n          $scope.goToEnd($scope.editor);\n        }\n      });\n    }\n  });\n\n  $scope.$on('openEditor', function(event) {\n    $scope.openEditor($scope.paragraph);\n  });\n\n  $scope.$on('closeEditor', function(event) {\n    $scope.closeEditor($scope.paragraph);\n  });\n\n  $scope.$on('openTable', function(event) {\n    $scope.openTable($scope.paragraph);\n  });\n\n  $scope.$on('closeTable', function(event) {\n    $scope.closeTable($scope.paragraph);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebook/paragraph/paragraph.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TableData from '../../../tabledata/tabledata';\nimport TableVisualization from '../../../visualization/builtins/visualization-table';\nimport BarchartVisualization from '../../../visualization/builtins/visualization-barchart';\nimport PiechartVisualization from '../../../visualization/builtins/visualization-piechart';\nimport AreachartVisualization from '../../../visualization/builtins/visualization-areachart';\nimport LinechartVisualization from '../../../visualization/builtins/visualization-linechart';\nimport ScatterchartVisualization from '../../../visualization/builtins/visualization-scatterchart';\n\nangular.module('zeppelinWebApp').controller('ResultCtrl', ResultCtrl);\n\nResultCtrl.$inject = [\n  '$scope',\n  '$rootScope',\n  '$route',\n  '$window',\n  '$routeParams',\n  '$location',\n  '$timeout',\n  '$compile',\n  '$http',\n  '$q',\n  '$templateRequest',\n  '$sce',\n  'websocketMsgSrv',\n  'baseUrlSrv',\n  'ngToast',\n  'saveAsService',\n  'noteVarShareService',\n  'heliumService'\n];\n\nfunction ResultCtrl($scope, $rootScope, $route, $window, $routeParams, $location,\n                    $timeout, $compile, $http, $q, $templateRequest, $sce, websocketMsgSrv,\n                    baseUrlSrv, ngToast, saveAsService, noteVarShareService, heliumService) {\n\n  /**\n   * Built-in visualizations\n   */\n  $scope.builtInTableDataVisualizationList = [\n    {\n      id: 'table',   // paragraph.config.graph.mode\n      name: 'Table', // human readable name. tooltip\n      icon: '<i class=\"fa fa-table\"></i>'\n    },\n    {\n      id: 'multiBarChart',\n      name: 'Bar Chart',\n      icon: '<i class=\"fa fa-bar-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'pieChart',\n      name: 'Pie Chart',\n      icon: '<i class=\"fa fa-pie-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'stackedAreaChart',\n      name: 'Area Chart',\n      icon: '<i class=\"fa fa-area-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'lineChart',\n      name: 'Line Chart',\n      icon: '<i class=\"fa fa-line-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'scatterChart',\n      name: 'Scatter Chart',\n      icon: '<i class=\"cf cf-scatter-chart\"></i>'\n    }\n  ];\n\n  /**\n   * Holds class and actual runtime instance and related infos of built-in visualizations\n   */\n  var builtInVisualizations = {\n    'table': {\n      class: TableVisualization,\n      instance: undefined   // created from setGraphMode()\n    },\n    'multiBarChart': {\n      class: BarchartVisualization,\n      instance: undefined\n    },\n    'pieChart': {\n      class: PiechartVisualization,\n      instance: undefined\n    },\n    'stackedAreaChart': {\n      class: AreachartVisualization,\n      instance: undefined\n    },\n    'lineChart': {\n      class: LinechartVisualization,\n      instance: undefined\n    },\n    'scatterChart': {\n      class: ScatterchartVisualization,\n      instance: undefined\n    }\n  };\n\n  // type\n  $scope.type;\n\n  // Data of the result\n  var data;\n\n  // config\n  $scope.config;\n\n  // resultId = paragraph.id + index\n  $scope.id;\n\n  // referece to paragraph\n  var paragraph;\n\n  // index of the result\n  var resultIndex;\n\n  // TableData instance\n  var tableData;\n\n  // available columns in tabledata\n  $scope.tableDataColumns = [];\n\n  // enable helium\n  var enableHelium = false;\n\n  // graphMode\n  $scope.graphMode;\n\n  // image data\n  $scope.imageData;\n\n  $scope.init = function(result, config, paragraph, index) {\n    console.log('result controller init %o %o %o', result, config, index);\n\n    // register helium plugin vis\n    var heliumVis = heliumService.get();\n    console.log('Helium visualizations %o', heliumVis);\n    heliumVis.forEach(function(vis) {\n      $scope.builtInTableDataVisualizationList.push({\n        id: vis.id,\n        name: vis.name,\n        icon: $sce.trustAsHtml(vis.icon)\n      });\n      builtInVisualizations[vis.id] = {\n        class: vis.class\n      };\n    });\n\n    updateData(result, config, paragraph, index);\n    renderResult($scope.type);\n  };\n\n  $scope.$on('updateResult', function(event, result, newConfig, paragraphRef, index) {\n    if (paragraph.id !== paragraphRef.id || index !== resultIndex) {\n      return;\n    }\n    console.log('updateResult %o %o %o %o', result, newConfig, paragraphRef, index);\n    var refresh = !angular.equals(newConfig, $scope.config) ||\n      !angular.equals(result.type, $scope.type) ||\n      !angular.equals(result.data, data);\n\n    updateData(result, newConfig, paragraph, resultIndex);\n    renderResult($scope.type, refresh);\n  });\n\n  $scope.$on('appendParagraphOutput', function(event, data) {\n    /* It has been observed that append events\n     * can be errorneously called even if paragraph\n     * execution has ended, and in that case, no append\n     * should be made. Also, it was observed that between PENDING\n     * and RUNNING states, append-events can be called and we can't\n     * miss those, else during the length of paragraph run, few\n     * initial output line/s will be missing.\n     */\n    if (paragraph.id === data.paragraphId &&\n      resultIndex === data.index &&\n      (paragraph.status === 'RUNNING' || paragraph.status === 'PENDING')) {\n      appendTextOutput(data.data);\n    }\n  });\n\n  $scope.$on('updateParagraphOutput', function(event, data) {\n    if (paragraph.id === data.paragraphId &&\n      resultIndex === data.index) {\n      clearTextOutput();\n      appendTextOutput(data.data);\n    }\n  });\n\n  var updateData = function(result, config, paragraphRef, index) {\n    data = result.data;\n    paragraph = paragraphRef;\n    resultIndex = parseInt(index);\n\n    $scope.id = paragraph.id + '_' + index;\n    $scope.type = result.type;\n    config = config ? config : {};\n\n    // initialize default config values\n    if (!config.graph) {\n      config.graph = {};\n    }\n\n    if (!config.graph.mode) {\n      config.graph.mode = 'table';\n    }\n\n    if (!config.graph.height) {\n      config.graph.height = 300;\n    }\n\n    if (!config.graph.optionOpen) {\n      config.graph.optionOpen = false;\n    }\n\n    $scope.graphMode = config.graph.mode;\n    $scope.config = angular.copy(config);\n\n    // enable only when it is last result\n    enableHelium = (index === paragraphRef.results.msg.length - 1);\n\n    if ($scope.type === 'TABLE') {\n      tableData = new TableData();\n      tableData.loadParagraphResult({type: $scope.type, msg: data});\n      $scope.tableDataColumns = tableData.columns;\n      $scope.tableDataComment = tableData.comment;\n    } else if ($scope.type === 'IMG') {\n      $scope.imageData = data;\n    }\n  };\n\n  var renderResult = function(type, refresh) {\n    var activeApp;\n    if (enableHelium) {\n      getSuggestions();\n      getApplicationStates();\n      activeApp = _.get($scope.config, 'helium.activeApp');\n    }\n\n    if (activeApp) {\n      var app = _.find($scope.apps, {id: activeApp});\n      renderApp(app);\n    } else {\n      if (type === 'TABLE') {\n        var retryRenderer = function() {\n          var elem = angular.element('#p' + $scope.id + '_graph');\n          if (elem.length) { $scope.renderGraph($scope.graphMode, refresh); }\n          else { $timeout(retryRenderer, 10); }\n        };\n        $timeout(retryRenderer);\n      } else if (type === 'HTML') {\n        renderHtml();\n      } else if (type === 'ANGULAR') {\n        renderAngular();\n      } else if (type === 'TEXT') {\n        renderText();\n      }\n    }\n  };\n\n  var renderHtml = function() {\n    var retryRenderer = function() {\n      var htmlEl = angular.element('#p' + $scope.id + '_html');\n      if (htmlEl.length) {\n        try {\n          htmlEl.html(data);\n\n          htmlEl.find('pre code').each(function(i, e) {\n            hljs.highlightBlock(e);\n          });\n          /*eslint new-cap: [2, {\"capIsNewExceptions\": [\"MathJax.Hub.Queue\"]}]*/\n          MathJax.Hub.Queue(['Typeset', MathJax.Hub, htmlEl[0]]);\n        } catch (err) {\n          console.log('HTML rendering error %o', err);\n        }\n      } else {\n        $timeout(retryRenderer, 10);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  var renderAngular = function() {\n    var retryRenderer = function() {\n      if (angular.element('#p' + $scope.id + '_angular').length) {\n        try {\n          angular.element('#p' + $scope.id + '_angular').html(data);\n\n          var paragraphScope = noteVarShareService.get(paragraph.id + '_paragraphScope');\n          $compile(angular.element('#p' + $scope.id + '_angular').contents())(paragraphScope);\n        } catch (err) {\n          console.log('ANGULAR rendering error %o', err);\n        }\n      } else {\n        $timeout(retryRenderer, 10);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  var getTextEl = function (paragraphId) {\n    return angular.element('#p' + $scope.id + '_text');\n  }\n\n  var textRendererInitialized = false;\n  var renderText = function() {\n    var retryRenderer = function() {\n      var textEl = getTextEl($scope.id);\n      if (textEl.length) {\n        // clear all lines before render\n        clearTextOutput();\n        textRendererInitialized = true;\n\n        if (data) {\n          appendTextOutput(data);\n        } else {\n          flushAppendQueue();\n        }\n\n        getTextEl($scope.id).bind('mousewheel', function(e) {\n          $scope.keepScrollDown = false;\n        });\n      } else {\n        $timeout(retryRenderer, 10);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  var clearTextOutput = function() {\n    var textEl = getTextEl($scope.id);\n    if (textEl.length) {\n      textEl.children().remove();\n    }\n  };\n\n  var textAppendQueueBeforeInitialize = [];\n\n  var flushAppendQueue = function() {\n    while (textAppendQueueBeforeInitialize.length > 0) {\n      appendTextOutput(textAppendQueueBeforeInitialize.pop());\n    }\n  };\n\n  var appendTextOutput = function(msg) {\n    if (!textRendererInitialized) {\n      textAppendQueueBeforeInitialize.push(msg);\n    } else {\n      flushAppendQueue();\n      var textEl = getTextEl($scope.id);\n      if (textEl.length) {\n        var lines = msg.split('\\n');\n        for (var i = 0; i < lines.length; i++) {\n          textEl.append(angular.element('<div></div>').text(lines[i]));\n        }\n      }\n      if ($scope.keepScrollDown) {\n        var doc = getTextEl($scope.id);\n        doc[0].scrollTop = doc[0].scrollHeight;\n      }\n    }\n  };\n\n  $scope.renderGraph = function(type, refresh) {\n    // set graph height\n    var height = $scope.config.graph.height;\n    var graphContainerEl = angular.element('#p' + $scope.id + '_graph');\n    graphContainerEl.height(height);\n\n    if (!type) {\n      type = 'table';\n    }\n\n    var builtInViz = builtInVisualizations[type];\n    if (builtInViz) {\n      // deactive previsouly active visualization\n      for (var t in builtInVisualizations) {\n        var v = builtInVisualizations[t].instance;\n\n        if (t !== type && v && v.isActive()) {\n          v.deactivate();\n          break;\n        }\n      }\n\n      if (!builtInViz.instance) { // not instantiated yet\n        // render when targetEl is available\n        var retryRenderer = function() {\n          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n          var visualizationSettingTargetEl = angular.element('#vizsetting' + $scope.id + '_' + type);\n          if (targetEl.length) {\n            try {\n              // set height\n              targetEl.height(height);\n\n              // instantiate visualization\n              var config = getVizConfig(type);\n              var Visualization = builtInViz.class;\n              builtInViz.instance = new Visualization(targetEl, config);\n\n              // inject emitter, $templateRequest\n              var emitter = function(graphSetting) {\n                commitVizConfigChange(graphSetting, type);\n              };\n              builtInViz.instance._emitter = emitter;\n              builtInViz.instance._compile = $compile;\n              builtInViz.instance._createNewScope = createNewScope;\n              var transformation = builtInViz.instance.getTransformation();\n              transformation._emitter = emitter;\n              transformation._templateRequest = $templateRequest;\n              transformation._compile = $compile;\n              transformation._createNewScope = createNewScope;\n\n              // render\n              var transformed = transformation.transform(tableData);\n              transformation.renderSetting(transformationSettingTargetEl);\n              builtInViz.instance.render(transformed);\n              builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n              builtInViz.instance.activate();\n              angular.element(window).resize(function() {\n                builtInViz.instance.resize();\n              });\n            } catch (err) {\n              console.error('Graph drawing error %o', err);\n            }\n          } else {\n            $timeout(retryRenderer, 10);\n          }\n        };\n        $timeout(retryRenderer);\n      } else if (refresh) {\n        console.log('Refresh data %o', tableData);\n        // when graph options or data are changed\n        var retryRenderer = function() {\n          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n          var visualizationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n          if (targetEl.length) {\n            var config = getVizConfig(type);\n            targetEl.height(height);\n            var transformation = builtInViz.instance.getTransformation();\n            transformation.setConfig(config);\n            var transformed = transformation.transform(tableData);\n            transformation.renderSetting(transformationSettingTargetEl);\n            builtInViz.instance.setConfig(config);\n            builtInViz.instance.render(transformed);\n            builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n          } else {\n            $timeout(retryRenderer, 10);\n          }\n        };\n        $timeout(retryRenderer);\n      } else {\n        var retryRenderer = function() {\n          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n          if (targetEl.length) {\n            targetEl.height(height);\n            builtInViz.instance.activate();\n          } else {\n            $timeout(retryRenderer, 10);\n          }\n        };\n        $timeout(retryRenderer);\n      }\n    }\n  };\n  $scope.switchViz = function(newMode) {\n    var newConfig = angular.copy($scope.config);\n    var newParams = angular.copy(paragraph.settings.params);\n\n    // graph options\n    newConfig.graph.mode = newMode;\n\n    // see switchApp()\n    _.set(newConfig, 'helium.activeApp', undefined);\n\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  var createNewScope = function() {\n    return $rootScope.$new(true);\n  };\n\n  var commitParagraphResult = function(title, text, config, params) {\n    var newParagraphConfig = angular.copy(paragraph.config);\n    newParagraphConfig.results = newParagraphConfig.results || [];\n    newParagraphConfig.results[resultIndex] = config;\n    if ($scope.revisionView === true) {\n      // local update without commit\n      updateData({\n        type: $scope.type,\n        data: data\n      }, newParagraphConfig.results[resultIndex], paragraph, resultIndex);\n      renderResult($scope.type, true);\n    } else {\n      websocketMsgSrv.commitParagraph(paragraph.id, title, text, newParagraphConfig, params);\n    }\n  };\n\n  $scope.toggleGraphSetting = function() {\n    var newConfig = angular.copy($scope.config);\n    if (newConfig.graph.optionOpen) {\n      newConfig.graph.optionOpen = false;\n    } else {\n      newConfig.graph.optionOpen = true;\n    }\n    var newParams = angular.copy(paragraph.settings.params);\n\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  var getVizConfig = function(vizId) {\n    var config;\n    var graph = $scope.config.graph;\n    if (graph) {\n      // copy setting for vizId\n      if (graph.setting) {\n        config = angular.copy(graph.setting[vizId]);\n      }\n\n      if (!config) {\n        config = {};\n      }\n\n      // copy common setting\n      config.common = angular.copy(graph.commonSetting) || {};\n\n      // copy pivot setting\n      if (graph.keys) {\n        config.common.pivot = {\n          keys: angular.copy(graph.keys),\n          groups: angular.copy(graph.groups),\n          values: angular.copy(graph.values)\n        };\n      }\n    }\n    console.log('getVizConfig', config);\n    return config;\n  };\n\n  var commitVizConfigChange = function(config, vizId) {\n    var newConfig = angular.copy($scope.config);\n    if (!newConfig.graph) {\n      newConfig.graph = {};\n    }\n\n    // copy setting for vizId\n    if (!newConfig.graph.setting) {\n      newConfig.graph.setting = {};\n    }\n    newConfig.graph.setting[vizId] = angular.copy(config);\n\n    // copy common setting\n    if (newConfig.graph.setting[vizId]) {\n      newConfig.graph.commonSetting = newConfig.graph.setting[vizId].common;\n      delete newConfig.graph.setting[vizId].common;\n    }\n\n    // copy pivot setting\n    if (newConfig.graph.commonSetting && newConfig.graph.commonSetting.pivot) {\n      newConfig.graph.keys = newConfig.graph.commonSetting.pivot.keys;\n      newConfig.graph.groups = newConfig.graph.commonSetting.pivot.groups;\n      newConfig.graph.values = newConfig.graph.commonSetting.pivot.values;\n      delete newConfig.graph.commonSetting.pivot;\n    }\n    console.log('committVizConfig', newConfig);\n    var newParams = angular.copy(paragraph.settings.params);\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  $scope.$on('paragraphResized', function(event, paragraphId) {\n    // paragraph col width changed\n    if (paragraphId === paragraph.id) {\n      var builtInViz = builtInVisualizations[$scope.graphMode];\n      if (builtInViz && builtInViz.instance) {\n        builtInViz.instance.resize();\n      }\n    }\n  });\n\n  $scope.resize = function(width, height) {\n    $timeout(function() {\n      changeHeight(width, height);\n    }, 200);\n  };\n\n  var changeHeight = function(width, height) {\n    var newParams = angular.copy(paragraph.settings.params);\n    var newConfig = angular.copy($scope.config);\n\n    newConfig.graph.height = height;\n    paragraph.config.colWidth = width;\n\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  $scope.exportToDSV = function(delimiter) {\n    var dsv = '';\n    var dateFinished = moment(paragraph.dateFinished).format('YYYY-MM-DD hh:mm:ss A');\n    var exportedFileName = paragraph.title ? paragraph.title + '_' + dateFinished : 'data_' + dateFinished;\n\n    for (var titleIndex in tableData.columns) {\n      dsv += tableData.columns[titleIndex].name + delimiter;\n    }\n    dsv = dsv.substring(0, dsv.length - 1) + '\\n';\n    for (var r in tableData.rows) {\n      var row = tableData.rows[r];\n      var dsvRow = '';\n      for (var index in row) {\n        var stringValue =  (row[index]).toString();\n        if (stringValue.indexOf(delimiter) > -1) {\n          dsvRow += '\"' + stringValue + '\"' + delimiter;\n        } else {\n          dsvRow += row[index] + delimiter;\n        }\n      }\n      dsv += dsvRow.substring(0, dsvRow.length - 1) + '\\n';\n    }\n    var extension = '';\n    if (delimiter === '\\t') {\n      extension = 'tsv';\n    } else if (delimiter === ',') {\n      extension = 'csv';\n    }\n    saveAsService.saveAs(dsv, exportedFileName, extension);\n  };\n\n  $scope.getBase64ImageSrc = function(base64Data) {\n    return 'data:image/png;base64,' + base64Data;\n  };\n\n  // Helium ----------------\n  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n\n  // app states\n  $scope.apps = [];\n\n  // suggested apps\n  $scope.suggestion = {};\n\n  $scope.switchApp = function(appId) {\n    var newConfig = angular.copy($scope.config);\n    var newParams = angular.copy(paragraph.settings.params);\n\n    // 'helium.activeApp' can be cleared by switchViz()\n    _.set(newConfig, 'helium.activeApp', appId);\n\n    commitConfig(newConfig, newParams);\n  };\n\n  $scope.loadApp = function(heliumPackage) {\n    var noteId = $route.current.pathParams.noteId;\n    $http.post(baseUrlSrv.getRestApiBase() + '/helium/load/' + noteId + '/' + paragraph.id, heliumPackage)\n      .success(function(data, status, headers, config) {\n        console.log('Load app %o', data);\n      })\n      .error(function(err, status, headers, config) {\n        console.log('Error %o', err);\n      });\n  };\n\n  var commitConfig = function(config, params) {\n    commitParagraphResult(paragraph.title, paragraph.text, config, params);\n  };\n\n  var getApplicationStates = function() {\n    var appStates = [];\n\n    // Display ApplicationState\n    if (paragraph.apps) {\n      _.forEach(paragraph.apps, function(app) {\n        appStates.push({\n          id: app.id,\n          pkg: app.pkg,\n          status: app.status,\n          output: app.output\n        });\n      });\n    }\n\n    // update or remove app states no longer exists\n    _.forEach($scope.apps, function(currentAppState, idx) {\n      var newAppState = _.find(appStates, {id: currentAppState.id});\n      if (newAppState) {\n        angular.extend($scope.apps[idx], newAppState);\n      } else {\n        $scope.apps.splice(idx, 1);\n      }\n    });\n\n    // add new app states\n    _.forEach(appStates, function(app, idx) {\n      if ($scope.apps.length <= idx || $scope.apps[idx].id !== app.id) {\n        $scope.apps.splice(idx, 0, app);\n      }\n    });\n  };\n\n  var getSuggestions = function() {\n    // Get suggested apps\n    var noteId = $route.current.pathParams.noteId;\n    if (!noteId) {\n    return;\n    }\n    $http.get(baseUrlSrv.getRestApiBase() + '/helium/suggest/' + noteId + '/' + paragraph.id)\n      .success(function(data, status, headers, config) {\n        $scope.suggestion = data.body;\n      })\n      .error(function(err, status, headers, config) {\n        console.log('Error %o', err);\n      });\n  };\n\n  var renderApp = function(appState) {\n    var retryRenderer = function() {\n      var targetEl = angular.element(document.getElementById('p' + appState.id));\n      console.log('retry renderApp %o', targetEl);\n      if (targetEl.length) {\n        try {\n          console.log('renderApp %o', appState);\n          targetEl.html(appState.output);\n          $compile(targetEl.contents())(getAppScope(appState));\n        } catch (err) {\n          console.log('App rendering error %o', err);\n        }\n      } else {\n        $timeout(retryRenderer, 1000);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  /*\n   ** $scope.$on functions below\n   */\n  $scope.$on('appendAppOutput', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (app) {\n        app.output += data.data;\n\n        var paragraphAppState = _.find(paragraph.apps, {id: data.appId});\n        paragraphAppState.output = app.output;\n\n        var targetEl = angular.element(document.getElementById('p' + app.id));\n        targetEl.html(app.output);\n        $compile(targetEl.contents())(getAppScope(app));\n        console.log('append app output %o', $scope.apps);\n      }\n    }\n  });\n\n  $scope.$on('updateAppOutput', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (app) {\n        app.output = data.data;\n\n        var paragraphAppState = _.find(paragraph.apps, {id: data.appId});\n        paragraphAppState.output = app.output;\n\n        var targetEl = angular.element(document.getElementById('p' + app.id));\n        targetEl.html(app.output);\n        $compile(targetEl.contents())(getAppScope(app));\n        console.log('append app output');\n      }\n    }\n  });\n\n  $scope.$on('appLoad', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (!app) {\n        app = {\n          id: data.appId,\n          pkg: data.pkg,\n          status: 'UNLOADED',\n          output: ''\n        };\n\n        $scope.apps.push(app);\n        paragraph.apps.push(app);\n        $scope.switchApp(app.id);\n      }\n    }\n  });\n\n  $scope.$on('appStatusChange', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (app) {\n        app.status = data.status;\n        var paragraphAppState = _.find(paragraph.apps, {id: data.appId});\n        paragraphAppState.status = app.status;\n      }\n    }\n  });\n\n  var getAppRegistry = function(appState) {\n    if (!appState.registry) {\n      appState.registry = {};\n    }\n\n    return appState.registry;\n  };\n\n  var getAppScope = function(appState) {\n    if (!appState.scope) {\n      appState.scope = $rootScope.$new(true, $rootScope);\n    }\n    return appState.scope;\n  };\n\n  $scope.$on('angularObjectUpdate', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      var app = _.find($scope.apps, {id: data.paragraphId});\n      if (app) {\n        scope = getAppScope(app);\n        registry = getAppRegistry(app);\n      } else {\n        // no matching app in this paragraph\n        return;\n      }\n\n      var varName = data.angularObject.name;\n\n      if (angular.equals(data.angularObject.object, scope[varName])) {\n        // return when update has no change\n        return;\n      }\n\n      if (!registry[varName]) {\n        registry[varName] = {\n          interpreterGroupId: data.interpreterGroupId,\n          noteId: data.noteId,\n          paragraphId: data.paragraphId\n        };\n      } else {\n        registry[varName].noteId = registry[varName].noteId || data.noteId;\n        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n      }\n\n      registry[varName].skipEmit = true;\n\n      if (!registry[varName].clearWatcher) {\n        registry[varName].clearWatcher = scope.$watch(varName, function(newValue, oldValue) {\n          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n          if (registry[varName].skipEmit) {\n            registry[varName].skipEmit = false;\n            return;\n          }\n          websocketMsgSrv.updateAngularObject(\n            registry[varName].noteId,\n            registry[varName].paragraphId,\n            varName,\n            newValue,\n            registry[varName].interpreterGroupId);\n        });\n      }\n      console.log('angular object (paragraph) created %o', varName);\n      scope[varName] = data.angularObject.object;\n\n      // create proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = function() {\n          scope[varName] = arguments;\n          console.log('angular function (paragraph) invoked %o', arguments);\n        };\n\n        console.log('angular function (paragraph) created %o', scope[funcName]);\n      }\n    }\n  });\n\n  $scope.$on('angularObjectRemove', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      var app = _.find($scope.apps, {id: data.paragraphId});\n      if (app) {\n        scope = getAppScope(app);\n        registry = getAppRegistry(app);\n      } else {\n        // no matching app in this paragraph\n        return;\n      }\n\n      var varName = data.name;\n\n      // clear watcher\n      if (registry[varName]) {\n        registry[varName].clearWatcher();\n        registry[varName] = undefined;\n      }\n\n      // remove scope variable\n      scope[varName] = undefined;\n\n      // remove proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = undefined;\n      }\n    }\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebook/paragraph/result/result.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('SearchResultCtrl', SearchResultCtrl);\n\nSearchResultCtrl.$inject = ['$scope', '$routeParams', 'searchService'];\n\nfunction SearchResultCtrl($scope, $routeParams, searchService) {\n  $scope.isResult = true ;\n  $scope.searchTerm = $routeParams.searchTerm;\n  var results = searchService.search({'q': $routeParams.searchTerm}).query();\n\n  results.$promise.then(function(result) {\n    $scope.notes = result.body.map(function(note) {\n      // redirect to notebook when search result is a notebook itself,\n      // not a paragraph\n      if (!/\\/paragraph\\//.test(note.id)) {\n        return note;\n      }\n\n      note.id = note.id.replace('paragraph/', '?paragraph=') +\n        '&term=' + $routeParams.searchTerm;\n\n      return note;\n    });\n    if ($scope.notes.length === 0) {\n      $scope.isResult = false;\n    } else {\n      $scope.isResult = true;\n    }\n\n    $scope.$on('$routeChangeStart', function(event, next, current) {\n      if (next.originalPath !== '/search/:searchTerm') {\n        searchService.searchTerm = '';\n      }\n    });\n  });\n\n  $scope.page = 0;\n  $scope.allResults = false;\n\n  $scope.highlightSearchResults = function(note) {\n    return function(_editor) {\n      function getEditorMode(text) {\n        var editorModes = {\n          'ace/mode/scala': /^%(\\w*\\.)?spark/,\n          'ace/mode/python': /^%(\\w*\\.)?(pyspark|python)/,\n          'ace/mode/r': /^%(\\w*\\.)?(r|sparkr|knitr)/,\n          'ace/mode/sql': /^%(\\w*\\.)?\\wql/,\n          'ace/mode/markdown': /^%md/,\n          'ace/mode/sh': /^%sh/\n        };\n\n        return Object.keys(editorModes).reduce(function(res, mode) {\n          return editorModes[mode].test(text) ? mode : res;\n        }, 'ace/mode/scala');\n      }\n\n      var Range = ace.require('ace/range').Range;\n\n      _editor.setOption('highlightActiveLine', false);\n      _editor.$blockScrolling = Infinity;\n      _editor.setReadOnly(true);\n      _editor.renderer.setShowGutter(false);\n      _editor.setTheme('ace/theme/chrome');\n      _editor.getSession().setMode(getEditorMode(note.text));\n\n      function getIndeces(term) {\n        return function(str) {\n          var indeces = [];\n          var i = -1;\n          while ((i = str.indexOf(term, i + 1)) >= 0) {\n            indeces.push(i);\n          }\n          return indeces;\n        };\n      }\n\n      var result = '';\n      if (note.header !== '') {\n        result = note.header + '\\n\\n' + note.snippet;\n      } else {\n        result = note.snippet;\n      }\n\n      var lines = result\n        .split('\\n')\n        .map(function(line, row) {\n\n          var match = line.match(/<B>(.+?)<\\/B>/);\n\n          // return early if nothing to highlight\n          if (!match) {\n            return line;\n          }\n\n          var term = match[1];\n          var __line = line\n            .replace(/<B>/g, '')\n            .replace(/<\\/B>/g, '');\n\n          var indeces = getIndeces(term)(__line);\n\n          indeces.forEach(function(start) {\n            var end = start + term.length;\n            if (note.header !== '' && row === 0) {\n              _editor\n                .getSession()\n                .addMarker(\n                  new Range(row, 0, row, line.length),\n                  'search-results-highlight-header',\n                  'background'\n                );\n              _editor\n                .getSession()\n                .addMarker(\n                  new Range(row, start, row, end),\n                  'search-results-highlight',\n                  'line'\n                );\n            } else {\n              _editor\n                .getSession()\n                .addMarker(\n                  new Range(row, start, row, end),\n                  'search-results-highlight',\n                  'line'\n                );\n            }\n          });\n          return __line;\n        });\n\n      // resize editor based on content length\n      _editor.setOption(\n        'maxLines',\n        lines.reduce(function(len, line) {return len + line.length;}, 0)\n      );\n\n      _editor.getSession().setValue(lines.join('\\n'));\n\n    };\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/search/result-list.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NotebookReposCtrl', NotebookReposCtrl);\n\nNotebookReposCtrl.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\nfunction NotebookReposCtrl($http, baseUrlSrv, ngToast) {\n  var vm = this;\n  vm.notebookRepos = [];\n  vm.showDropdownSelected = showDropdownSelected;\n  vm.saveNotebookRepo = saveNotebookRepo;\n\n  _init();\n\n  // Public functions\n\n  function saveNotebookRepo(valueform, repo, data) {\n    console.log('data %o', data);\n    $http.put(baseUrlSrv.getRestApiBase() + '/notebook-repositories', {\n      'name': repo.className,\n      'settings': data\n    }).success(function(data) {\n      var index = _.findIndex(vm.notebookRepos, {'className': repo.className});\n      if (index >= 0) {\n        vm.notebookRepos[index] = data.body;\n        console.log('repos %o, data %o', vm.notebookRepos, data.body);\n      }\n      valueform.$show();\n    }).error(function() {\n      ngToast.danger({\n        content: 'We couldn\\'t save that NotebookRepo\\'s settings',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      valueform.$show();\n    });\n\n    return 'manual';\n  }\n\n  function showDropdownSelected(setting) {\n    var index = _.findIndex(setting.value, {'value': setting.selected});\n    if (index < 0) {\n      return 'No value';\n    } else {\n      return setting.value[index].name;\n    }\n  }\n\n  // Private functions\n\n  function _getInterpreterSettings() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/notebook-repositories')\n      .success(function(data, status, headers, config) {\n        vm.notebookRepos = data.body;\n        console.log('ya notebookRepos %o', vm.notebookRepos);\n      }).error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  }\n\n  function _init() {\n    _getInterpreterSettings();\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebookRepos/notebookRepos.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\n  angular.module('zeppelinWebApp').controller('HeliumCtrl', HeliumCtrl);\n\n  HeliumCtrl.$inject = ['$scope', '$rootScope', '$sce', 'baseUrlSrv', 'ngToast', 'heliumService'];\n\n  function HeliumCtrl($scope, $rootScope, $sce, baseUrlSrv, ngToast, heliumService) {\n    $scope.packageInfos = {};\n    $scope.defaultVersions = {};\n    $scope.showVersions = {};\n    $scope.visualizationOrder = [];\n    $scope.visualizationOrderChanged = false;\n\n    var buildDefaultVersionListToDisplay = function(packageInfos) {\n      var defaultVersions = {};\n      // show enabled version if any version of package is enabled\n      for (var name in packageInfos) {\n        var pkgs = packageInfos[name];\n        for (var pkgIdx in pkgs) {\n          var pkg = pkgs[pkgIdx];\n          pkg.pkg.icon = $sce.trustAsHtml(pkg.pkg.icon);\n          if (pkg.enabled) {\n            defaultVersions[name] = pkg;\n            pkgs.splice(pkgIdx, 1);\n            break;\n          }\n        }\n\n        // show first available version if package is not enabled\n        if (!defaultVersions[name]) {\n          defaultVersions[name] = pkgs[0];\n          pkgs.splice(0, 1);\n        }\n      }\n      $scope.defaultVersions = defaultVersions;\n    };\n\n    var getAllPackageInfo = function() {\n      heliumService.getAllPackageInfo().\n        success(function(data, status) {\n          $scope.packageInfos = data.body;\n          buildDefaultVersionListToDisplay($scope.packageInfos);\n        }).\n        error(function(data, status) {\n          console.log('Can not load package info %o %o', status, data);\n        });\n    };\n\n    var getVisualizationOrder = function() {\n      heliumService.getVisualizationOrder().\n        success(function(data, status) {\n          $scope.visualizationOrder = data.body;\n        }).\n        error(function(data, status) {\n          console.log('Can not get visualization order %o %o', status, data);\n        });\n    };\n\n    $scope.visualizationOrderListeners = {\n      accept: function(sourceItemHandleScope, destSortableScope) {return true;},\n      itemMoved: function(event) {},\n      orderChanged: function(event) {\n        $scope.visualizationOrderChanged = true;\n      }\n    };\n\n    var init = function() {\n      getAllPackageInfo();\n      getVisualizationOrder();\n      $scope.visualizationOrderChanged = false;\n    };\n\n    init();\n\n    $scope.saveVisualizationOrder = function() {\n      var confirm = BootstrapDialog.confirm({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: '',\n        message: 'Save changes?',\n        callback: function(result) {\n          if (result) {\n            confirm.$modalFooter.find('button').addClass('disabled');\n            confirm.$modalFooter.find('button:contains(\"OK\")')\n              .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n            heliumService.setVisualizationOrder($scope.visualizationOrder).\n              success(function(data, status) {\n                init();\n                confirm.close();\n              }).\n              error(function(data, status) {\n                confirm.close();\n                console.log('Failed to save order');\n                BootstrapDialog.show({\n                  title: 'Error on saving order ',\n                  message: data.message\n                });\n              });\n            return false;\n          }\n        }\n      });\n    }\n\n    var getLicense = function(name, artifact) {\n      var pkg = _.filter($scope.defaultVersions[name], function(p) {\n        return p.artifact === artifact;\n      });\n\n      var license;\n      if (pkg.length === 0) {\n        pkg = _.filter($scope.packageInfos[name], function(p) {\n          return p.pkg.artifact === artifact;\n        });\n\n        if (pkg.length > 0) {\n          license  = pkg[0].pkg.license;\n        }\n      } else {\n        license = pkg[0].license;\n      }\n\n      if (!license) {\n        license = 'Unknown';\n      }\n      return license;\n    }\n\n    $scope.enable = function(name, artifact) {\n      var license = getLicense(name, artifact);\n\n      var confirm = BootstrapDialog.confirm({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: '',\n        message: 'Do you want to enable ' + name + '?' +\n          '<div style=\"color:gray\">' + artifact + '</div>' +\n          '<div style=\"border-top: 1px solid #efefef; margin-top: 10px; padding-top: 5px;\">License</div>' +\n          '<div style=\"color:gray\">' + license + '</div>',\n        callback: function(result) {\n          if (result) {\n            confirm.$modalFooter.find('button').addClass('disabled');\n            confirm.$modalFooter.find('button:contains(\"OK\")')\n              .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n            heliumService.enable(name, artifact).\n              success(function(data, status) {\n                init();\n                confirm.close();\n              }).\n              error(function(data, status) {\n                confirm.close();\n                console.log('Failed to enable package %o %o. %o', name, artifact, data);\n                BootstrapDialog.show({\n                  title: 'Error on enabling ' + name,\n                  message: data.message\n                });\n              });\n            return false;\n          }\n        }\n      });\n    };\n\n    $scope.disable = function(name) {\n      var confirm = BootstrapDialog.confirm({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: '',\n        message: 'Do you want to disable ' + name + '?',\n        callback: function(result) {\n          if (result) {\n            confirm.$modalFooter.find('button').addClass('disabled');\n            confirm.$modalFooter.find('button:contains(\"OK\")')\n              .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Disabling');\n            heliumService.disable(name).\n              success(function(data, status) {\n                init();\n                confirm.close();\n              }).\n              error(function(data, status) {\n                confirm.close();\n                console.log('Failed to disable package %o. %o', name, data);\n                BootstrapDialog.show({\n                  title: 'Error on disabling ' + name,\n                  message: data.message\n                });\n              });\n            return false;\n          }\n        }\n      });\n    };\n\n    $scope.toggleVersions = function(pkgName) {\n      if ($scope.showVersions[pkgName]) {\n        $scope.showVersions[pkgName] = false;\n      } else {\n        $scope.showVersions[pkgName] = true;\n      }\n    };\n  }\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/helium/helium.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('arrayOrderingSrv', arrayOrderingSrv);\n\narrayOrderingSrv.$inject = ['TRASH_FOLDER_ID'];\n\nfunction arrayOrderingSrv(TRASH_FOLDER_ID) {\n  var arrayOrderingSrv = this;\n\n  this.noteListOrdering = function(note) {\n    if (note.id === TRASH_FOLDER_ID) {\n      return '\\uFFFF';\n    }\n    return arrayOrderingSrv.getNoteName(note);\n  };\n\n  this.getNoteName = function(note) {\n    if (note.name === undefined || note.name.trim() === '') {\n      return 'Note ' + note.id;\n    } else {\n      return note.name;\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/arrayOrderingSrv/arrayOrdering.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nangular.module('zeppelinWebApp').controller('clipboardCtrl', clipboardCtrl);\nclipboardCtrl.$inject = ['$scope'];\n\nfunction clipboardCtrl($scope) {\n  $scope.complete = function(e) {\n    $scope.copied = true;\n    $scope.tooltip = 'Copied!';\n    setTimeout(function() {\n      $scope.tooltip = 'Copy to clipboard';\n    }, 400);\n  };\n  $scope.$watch('input', function() {\n    $scope.copied = false;\n    $scope.tooltip = 'Copy to clipboard';\n  });\n  $scope.clipError = function(e) {\n    console.log('Error: ' + e.name + ' - ' + e.message);\n    $scope.tooltip = 'Not supported browser';\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/clipboard/clipboard.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NavCtrl', NavCtrl);\n\nNavCtrl.$inject = [\n  '$scope',\n  '$rootScope',\n  '$http',\n  '$routeParams',\n  '$location',\n  'noteListDataFactory',\n  'baseUrlSrv',\n  'websocketMsgSrv',\n  'arrayOrderingSrv',\n  'searchService',\n  'TRASH_FOLDER_ID'\n];\n\nfunction NavCtrl($scope, $rootScope, $http, $routeParams, $location,\n                 noteListDataFactory, baseUrlSrv, websocketMsgSrv,\n                 arrayOrderingSrv, searchService, TRASH_FOLDER_ID) {\n  var vm = this;\n  vm.arrayOrderingSrv = arrayOrderingSrv;\n  vm.connected = websocketMsgSrv.isConnected();\n  vm.isActive = isActive;\n  vm.logout = logout;\n  vm.notes = noteListDataFactory;\n  vm.search = search;\n  vm.searchForm = searchService;\n  vm.showLoginWindow = showLoginWindow;\n  vm.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n  vm.isFilterNote = isFilterNote;\n\n  $scope.query = {q: ''};\n\n  initController();\n\n  function getZeppelinVersion() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/version').success(\n      function(data, status, headers, config) {\n        $rootScope.zeppelinVersion = data.body;\n      }).error(\n      function(data, status, headers, config) {\n        console.log('Error %o %o', status, data.message);\n      });\n  }\n\n  function initController() {\n    $scope.isDrawNavbarNoteList = false;\n    angular.element('#notebook-list').perfectScrollbar({suppressScrollX: true});\n\n    angular.element(document).click(function() {\n      $scope.query.q = '';\n    });\n\n    getZeppelinVersion();\n    loadNotes();\n  }\n\n  function isFilterNote(note) {\n    if (!$scope.query.q) {\n      return true;\n    }\n\n    var noteName = note.name;\n    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n      return true;\n    }\n    return false;\n  }\n\n  function isActive(noteId) {\n    return ($routeParams.noteId === noteId);\n  }\n\n  function listConfigurations() {\n    websocketMsgSrv.listConfigurations();\n  }\n\n  function loadNotes() {\n    websocketMsgSrv.getNoteList();\n  }\n\n  function getHomeNote(){\n    websocketMsgSrv.getHomeNote();\n  }\n\n  function logout() {\n    var logoutURL = baseUrlSrv.getRestApiBase() + '/login/logout';\n\n    //for firefox and safari\n    logoutURL = logoutURL.replace('//', '//false:false@');\n    $http.post(logoutURL).error(function() {\n      //force authcBasic (if configured) to logout\n      $http.post(logoutURL).error(function() {\n        $rootScope.userName = '';\n        $rootScope.ticket.principal = '';\n        $rootScope.ticket.ticket = '';\n        $rootScope.ticket.roles = '';\n        BootstrapDialog.show({\n          message: 'Logout Success'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 1000);\n      });\n    });\n  }\n\n  function search(searchTerm) {\n    $location.path('/search/' + searchTerm);\n  }\n\n  function showLoginWindow() {\n    setTimeout(function() {\n      angular.element('#userName').focus();\n    }, 500);\n  }\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteMenu', function(event, notes) {\n    noteListDataFactory.setNotes(notes);\n    initNotebookListEventListener();\n  });\n\n  $scope.$on('setConnectedStatus', function(event, param) {\n    vm.connected = param;\n  });\n\n  $scope.$on('loginSuccess', function(event, param) {\n    listConfigurations();\n    loadNotes();\n    getHomeNote();\n  });\n\n  /*\n   ** Performance optimization for Browser Render.\n   */\n  function initNotebookListEventListener() {\n    angular.element(document).ready(function() {\n      angular.element('.notebook-list-dropdown').on('show.bs.dropdown', function() {\n        $scope.isDrawNavbarNoteList = true;\n      });\n\n      angular.element('.notebook-list-dropdown').on('hide.bs.dropdown', function() {\n        $scope.isDrawNavbarNoteList = false;\n      });\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/navbar/navbar.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('ngEscape', ngEscape);\n\nfunction ngEscape() {\n  return function(scope, element, attrs) {\n    element.bind('keydown keyup', function(event) {\n      if (event.which === 27) {\n        scope.$apply(function() {\n          scope.$eval(attrs.ngEscape);\n        });\n        event.preventDefault();\n      }\n    });\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/ngescape/ngescape.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('interpreterDirective', interpreterDirective);\n\ninterpreterDirective.$inject = ['$timeout'];\n\nfunction interpreterDirective($timeout) {\n  return {\n    restrict: 'A',\n    link: function(scope, element, attr) {\n      if (scope.$last === true) {\n        $timeout(function() {\n          var id = 'ngRenderFinished';\n          scope.$emit(id);\n        });\n      }\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/interpreter/interpreter.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('expandCollapse', expandCollapse);\n\nfunction expandCollapse() {\n  return {\n    restrict: 'EA',\n    link: function(scope, element, attrs) {\n      angular.element(element).click(function(event) {\n        if (angular.element(element).find('.expandable:visible').length > 1) {\n          angular.element(element).find('.expandable:visible').slideUp('slow');\n          angular.element(element).find('i.icon-folder-alt').toggleClass('icon-folder icon-folder-alt');\n        } else {\n          angular.element(element).find('.expandable').first().slideToggle('200',function() {\n            // do not toggle trash folder\n            if (angular.element(element).find('.fa-trash-o').length === 0) {\n              angular.element(element).find('i').first().toggleClass('icon-folder icon-folder-alt');\n            }\n          });\n        }\n        event.stopPropagation();\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/expandCollapse/expandCollapse.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NotenameCtrl', NotenameCtrl);\n\nNotenameCtrl.$inject = [\n  '$scope',\n  'noteListDataFactory',\n  '$routeParams',\n  'websocketMsgSrv'\n];\n\nfunction NotenameCtrl($scope, noteListDataFactory, $routeParams, websocketMsgSrv) {\n  var vm = this;\n  vm.clone = false;\n  vm.notes = noteListDataFactory;\n  vm.websocketMsgSrv = websocketMsgSrv;\n  $scope.note = {};\n  $scope.interpreterSettings = {};\n  $scope.note.defaultInterpreter = null;\n\n  vm.createNote = function() {\n    if (!vm.clone) {\n      var defaultInterpreterId = '';\n      if ($scope.note.defaultInterpreter !== null) {\n        defaultInterpreterId = $scope.note.defaultInterpreter.id;\n      }\n      vm.websocketMsgSrv.createNotebook($scope.note.notename, defaultInterpreterId);\n      $scope.note.defaultInterpreter = $scope.interpreterSettings[0];\n    } else {\n      var noteId = $routeParams.noteId;\n      vm.websocketMsgSrv.cloneNote(noteId, $scope.note.notename);\n    }\n  };\n\n  vm.handleNameEnter = function() {\n    angular.element('#noteNameModal').modal('toggle');\n    vm.createNote();\n  };\n\n  vm.preVisible = function(clone, sourceNoteName) {\n    vm.clone = clone;\n    vm.sourceNoteName = sourceNoteName;\n    $scope.note.notename = vm.clone ? vm.cloneNoteName() : vm.newNoteName();\n    $scope.$apply();\n  };\n\n  vm.newNoteName = function() {\n    var newCount = 1;\n    angular.forEach(vm.notes.flatList, function(noteName) {\n      noteName = noteName.name;\n      if (noteName.match(/^Untitled Note [0-9]*$/)) {\n        var lastCount = noteName.substr(14) * 1;\n        if (newCount <= lastCount) {\n          newCount = lastCount + 1;\n        }\n      }\n    });\n    return 'Untitled Note ' + newCount;\n  };\n\n  vm.cloneNoteName = function() {\n    var copyCount = 1;\n    var newCloneName = '';\n    var lastIndex = vm.sourceNoteName.lastIndexOf(' ');\n    var endsWithNumber = !!vm.sourceNoteName.match('^.+?\\\\s\\\\d$');\n    var noteNamePrefix = endsWithNumber ? vm.sourceNoteName.substr(0, lastIndex) : vm.sourceNoteName;\n    var regexp = new RegExp('^' + noteNamePrefix + ' .+');\n\n    angular.forEach(vm.notes.flatList, function(noteName) {\n      noteName = noteName.name;\n      if (noteName.match(regexp)) {\n        var lastCopyCount = noteName.substr(lastIndex).trim();\n        newCloneName = noteNamePrefix;\n        lastCopyCount = parseInt(lastCopyCount);\n        if (copyCount <= lastCopyCount) {\n          copyCount = lastCopyCount + 1;\n        }\n      }\n    });\n\n    if (!newCloneName) {\n      newCloneName = vm.sourceNoteName;\n    }\n    return newCloneName + ' ' + copyCount;\n  };\n\n  vm.getInterpreterSettings = function() {\n    vm.websocketMsgSrv.getInterpreterSettings();\n  };\n\n\n  $scope.$on('interpreterSettings', function(event, data) {\n    $scope.interpreterSettings = data.interpreterSettings;\n\n    //initialize default interpreter with Spark interpreter\n    $scope.note.defaultInterpreter = data.interpreterSettings[0];\n  });\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteName-create/notename.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NoteImportCtrl', NoteImportCtrl);\n\nNoteImportCtrl.$inject = ['$scope', '$timeout', 'websocketMsgSrv'];\n\nfunction NoteImportCtrl($scope, $timeout, websocketMsgSrv) {\n  var vm = this;\n  $scope.note = {};\n  $scope.note.step1 = true;\n  $scope.note.step2 = false;\n  $scope.maxLimit = '';\n  var limit = 0;\n\n  websocketMsgSrv.listConfigurations();\n  $scope.$on('configurationsInfo', function(scope, event) {\n    limit = event.configurations['zeppelin.websocket.max.text.message.size'];\n    $scope.maxLimit = Math.round(limit / 1048576);\n  });\n\n  vm.resetFlags = function() {\n    $scope.note = {};\n    $scope.note.step1 = true;\n    $scope.note.step2 = false;\n    angular.element('#noteImportFile').val('');\n  };\n\n  $scope.uploadFile = function() {\n    angular.element('#noteImportFile').click();\n  };\n\n  $scope.importFile = function(element) {\n    $scope.note.errorText = '';\n    $scope.note.importFile = element.files[0];\n    var file = $scope.note.importFile;\n    var reader = new FileReader();\n\n    if (file.size > limit) {\n      $scope.note.errorText = 'File size limit Exceeded!';\n      $scope.$apply();\n      return;\n    }\n\n    reader.onloadend = function() {\n      vm.processImportJson(reader.result);\n    };\n\n    if (file) {\n      reader.readAsText(file);\n    }\n  };\n\n  $scope.uploadURL = function() {\n    $scope.note.errorText = '';\n    $scope.note.step1 = false;\n    $timeout(function() {\n      $scope.note.step2 = true;\n    }, 400);\n  };\n\n  vm.importBack = function() {\n    $scope.note.errorText = '';\n    $timeout(function() {\n      $scope.note.step1 = true;\n    }, 400);\n    $scope.note.step2 = false;\n  };\n\n  vm.importNote = function() {\n    $scope.note.errorText = '';\n    if ($scope.note.importUrl) {\n      jQuery.ajax({\n        url: $scope.note.importUrl,\n        type: 'GET',\n        dataType: 'json',\n        jsonp: false,\n        xhrFields: {\n          withCredentials: false\n        },\n        error: function(xhr, ajaxOptions, thrownError) {\n          $scope.note.errorText = 'Unable to Fetch URL';\n          $scope.$apply();\n        }}).done(function(data) {\n        vm.processImportJson(data);\n      });\n    } else {\n      $scope.note.errorText = 'Enter URL';\n      $scope.$apply();\n    }\n  };\n\n  vm.processImportJson = function(result) {\n    if (typeof result !== 'object') {\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        $scope.note.errorText = 'JSON parse exception';\n        $scope.$apply();\n        return;\n      }\n\n    }\n    if (result.paragraphs && result.paragraphs.length > 0) {\n      if (!$scope.note.noteImportName) {\n        $scope.note.noteImportName = result.name;\n      } else {\n        result.name = $scope.note.noteImportName;\n      }\n      websocketMsgSrv.importNote(result);\n      //angular.element('#noteImportModal').modal('hide');\n    } else {\n      $scope.note.errorText = 'Invalid JSON';\n    }\n    $scope.$apply();\n  };\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteMenu', function(event, notes) {\n    vm.resetFlags();\n    angular.element('#noteImportModal').modal('hide');\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteName-import/notenameImport.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('popoverHtmlUnsafe', popoverHtmlUnsafe);\n\npopoverHtmlUnsafe.$inject = ['$tooltip'];\n\nfunction popoverHtmlUnsafe($tooltip) {\n  return $tooltip('popoverHtmlUnsafe', 'popover', 'click');\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/popover-html-unsafe/popover-html-unsafe.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('popoverHtmlUnsafePopup', popoverHtmlUnsafePopup);\n\nfunction popoverHtmlUnsafePopup() {\n  return {\n    restrict: 'EA',\n    replace: true,\n    scope: {title: '@', content: '@', placement: '@', animation: '&', isOpen: '&'},\n    templateUrl: 'components/popover-html-unsafe/popover-html-unsafe-popup.html'\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/popover-html-unsafe/popover-html-unsafe-popup.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('codeEditor', codeEditor);\n\nfunction codeEditor($templateRequest, $compile) {\n  return {\n    restrict: 'AE',\n    scope: {\n      paragraphId: '=paragraphId',\n      paragraph: '=paragraphContext',\n      dirtyText: '=dirtyText',\n      originalText: '=originalText',\n      onLoad: '=onLoad',\n      revisionView: '=revisionView'\n    },\n    link: function(scope, element, attrs, controller) {\n      $templateRequest('components/editor/ace.editor.directive.html').then(function(editorHtml) {\n        var editor = angular.element(editorHtml);\n        editor.attr('id', scope.paragraphId + '_editor');\n        element.append(editor);\n        $compile(editor)(scope);\n        console.log('codeEditor directive revision view is ' + scope.revisionView);\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/editor/codeEditor.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('ngEnter', ngEnter);\n\nfunction ngEnter() {\n  return function(scope, element, attrs) {\n    element.bind('keydown keypress', function(event) {\n      if (event.which === 13) {\n        if (!event.shiftKey) {\n          scope.$apply(function() {\n            scope.$eval(attrs.ngEnter);\n          });\n        }\n        event.preventDefault();\n      }\n    });\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/ngenter/ngenter.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('dropdownInput', dropdownInput);\n\nfunction dropdownInput() {\n  return {\n    restrict: 'A',\n    link: function(scope, element) {\n      element.bind('click', function(event) {\n        event.stopPropagation();\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/dropdowninput/dropdowninput.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('resizable', resizable);\n\nfunction resizable() {\n  var resizableConfig = {\n    autoHide: true,\n    handles: 'se',\n    helper: 'resizable-helper',\n    stop: function() {\n      angular.element(this).css({'width': '100%', 'height': '100%'});\n    }\n  };\n\n  return {\n    restrict: 'A',\n    scope: {\n      callback: '&onResize'\n    },\n    link: function postLink(scope, elem, attrs) {\n      attrs.$observe('resize', function(resize) {\n        var resetResize = function(elem, resize) {\n          var colStep = window.innerWidth / 12;\n          elem.off('resizestop');\n          var conf = angular.copy(resizableConfig);\n          if (resize.graphType === 'TABLE' || resize.graphType === 'TEXT') {\n            conf.grid = [colStep, 10];\n            conf.minHeight = 100;\n          } else {\n            conf.grid = [colStep, 10000];\n            conf.minHeight = 0;\n          }\n          conf.maxWidth = window.innerWidth;\n\n          elem.resizable(conf);\n          elem.on('resizestop', function() {\n            if (scope.callback) {\n              var height = elem.height();\n              if (height < 50) {\n                height = 300;\n              }\n              scope.callback({width: Math.ceil(elem.width() / colStep), height: height});\n            }\n          });\n        };\n\n        resize = JSON.parse(resize);\n        if (resize.allowresize === 'true') {\n          resetResize(elem, resize);\n          angular.element(window).resize(function() {\n            resetResize(elem, resize);\n          });\n        }\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/resizable/resizable.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('modalvisible', modalvisible);\n\nfunction modalvisible() {\n  return {\n    restrict: 'A',\n    scope: {\n      preVisibleCallback: '&previsiblecallback',\n      postVisibleCallback: '&postvisiblecallback',\n      targetinput: '@targetinput'\n    },\n    link: function(scope, element, attrs) {\n      // Add some listeners\n      var previsibleMethod = scope.preVisibleCallback;\n      var postVisibleMethod = scope.postVisibleCallback;\n      element.on('show.bs.modal',function(e) {\n        var relatedTarget = angular.element(e.relatedTarget);\n        var clone = relatedTarget.data('clone');\n        var sourceNoteName = relatedTarget.data('source-note-name');\n        var cloneNote = clone ? true : false;\n        previsibleMethod()(cloneNote, sourceNoteName);\n      });\n      element.on('shown.bs.modal', function(e) {\n        if (scope.targetinput) {\n          angular.element(e.target).find('input#' + scope.targetinput).select();\n        }\n        postVisibleMethod();\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteName-create/visible.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('websocketMsgSrv', websocketMsgSrv);\n\nwebsocketMsgSrv.$inject = ['$rootScope', 'websocketEvents'];\n\nfunction websocketMsgSrv($rootScope, websocketEvents) {\n  return {\n\n    getHomeNote: function() {\n      websocketEvents.sendNewEvent({op: 'GET_HOME_NOTE'});\n    },\n\n    createNotebook: function(noteName, defaultInterpreterId) {\n      websocketEvents.sendNewEvent({\n        op: 'NEW_NOTE',\n        data: {\n          name: noteName,\n          defaultInterpreterId: defaultInterpreterId\n        }\n      });\n    },\n\n    moveNoteToTrash: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'MOVE_NOTE_TO_TRASH', data: {id: noteId}});\n    },\n\n    moveFolderToTrash: function(folderId) {\n      websocketEvents.sendNewEvent({op: 'MOVE_FOLDER_TO_TRASH', data: {id: folderId}});\n    },\n\n    restoreNote: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'RESTORE_NOTE', data: {id: noteId}});\n    },\n\n    restoreFolder: function(folderId) {\n      websocketEvents.sendNewEvent({op: 'RESTORE_FOLDER', data: {id: folderId}});\n    },\n\n    restoreAll: function() {\n      websocketEvents.sendNewEvent({op: 'RESTORE_ALL'});\n    },\n\n    deleteNote: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'DEL_NOTE', data: {id: noteId}});\n    },\n\n    removeFolder: function(folderId) {\n      websocketEvents.sendNewEvent({op: 'REMOVE_FOLDER', data: {id: folderId}});\n    },\n\n    emptyTrash: function() {\n      websocketEvents.sendNewEvent({op: 'EMPTY_TRASH'});\n    },\n\n    cloneNote: function(noteIdToClone, newNoteName) {\n      websocketEvents.sendNewEvent({op: 'CLONE_NOTE', data: {id: noteIdToClone, name: newNoteName}});\n    },\n\n    getNoteList: function() {\n      websocketEvents.sendNewEvent({op: 'LIST_NOTES'});\n    },\n\n    reloadAllNotesFromRepo: function() {\n      websocketEvents.sendNewEvent({op: 'RELOAD_NOTES_FROM_REPO'});\n    },\n\n    getNote: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'GET_NOTE', data: {id: noteId}});\n    },\n\n    updateNote: function(noteId, noteName, noteConfig) {\n      websocketEvents.sendNewEvent({op: 'NOTE_UPDATE', data: {id: noteId, name: noteName, config: noteConfig}});\n    },\n\n    updatePersonalizedMode: function(noteId, modeValue) {\n      websocketEvents.sendNewEvent({op: 'UPDATE_PERSONALIZED_MODE', data: {id: noteId, personalized: modeValue}});\n    },\n\n    renameNote: function(noteId, noteName) {\n      websocketEvents.sendNewEvent({op: 'NOTE_RENAME', data: {id: noteId, name: noteName}});\n    },\n\n    renameFolder: function(folderId, folderName) {\n      websocketEvents.sendNewEvent({op: 'FOLDER_RENAME', data: {id: folderId, name: folderName}});\n    },\n\n    moveParagraph: function(paragraphId, newIndex) {\n      websocketEvents.sendNewEvent({op: 'MOVE_PARAGRAPH', data: {id: paragraphId, index: newIndex}});\n    },\n\n    insertParagraph: function(newIndex) {\n      websocketEvents.sendNewEvent({op: 'INSERT_PARAGRAPH', data: {index: newIndex}});\n    },\n\n    copyParagraph: function(newIndex, paragraphTitle, paragraphData,\n                            paragraphConfig, paragraphParams) {\n      websocketEvents.sendNewEvent({\n        op: 'COPY_PARAGRAPH',\n        data: {\n          index: newIndex,\n          title: paragraphTitle,\n          paragraph: paragraphData,\n          config: paragraphConfig,\n          params: paragraphParams\n        }\n      });\n    },\n\n    updateAngularObject: function(noteId, paragraphId, name, value, interpreterGroupId) {\n      websocketEvents.sendNewEvent({\n        op: 'ANGULAR_OBJECT_UPDATED',\n        data: {\n          noteId: noteId,\n          paragraphId: paragraphId,\n          name: name,\n          value: value,\n          interpreterGroupId: interpreterGroupId\n        }\n      });\n    },\n\n    clientBindAngularObject: function(noteId, name, value, paragraphId) {\n      websocketEvents.sendNewEvent({\n        op: 'ANGULAR_OBJECT_CLIENT_BIND',\n        data: {\n          noteId: noteId,\n          name: name,\n          value: value,\n          paragraphId: paragraphId\n        }\n      });\n    },\n\n    clientUnbindAngularObject: function(noteId, name, paragraphId) {\n      websocketEvents.sendNewEvent({\n        op: 'ANGULAR_OBJECT_CLIENT_UNBIND',\n        data: {\n          noteId: noteId,\n          name: name,\n          paragraphId: paragraphId\n        }\n      });\n    },\n\n    cancelParagraphRun: function(paragraphId) {\n      websocketEvents.sendNewEvent({op: 'CANCEL_PARAGRAPH', data: {id: paragraphId}});\n    },\n\n    runParagraph: function(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n      websocketEvents.sendNewEvent({\n        op: 'RUN_PARAGRAPH',\n        data: {\n          id: paragraphId,\n          title: paragraphTitle,\n          paragraph: paragraphData,\n          config: paragraphConfig,\n          params: paragraphParams\n        }\n      });\n    },\n\n    runAllParagraphs: function(noteId, paragraphs) {\n      websocketEvents.sendNewEvent({\n        op: 'RUN_ALL_PARAGRAPHS',\n        data: {\n          noteId: noteId,\n          paragraphs: JSON.stringify(paragraphs)\n        }\n      });\n    },\n\n    removeParagraph: function(paragraphId) {\n      websocketEvents.sendNewEvent({op: 'PARAGRAPH_REMOVE', data: {id: paragraphId}});\n    },\n\n    clearParagraphOutput: function(paragraphId) {\n      websocketEvents.sendNewEvent({op: 'PARAGRAPH_CLEAR_OUTPUT', data: {id: paragraphId}});\n    },\n\n    clearAllParagraphOutput: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'PARAGRAPH_CLEAR_ALL_OUTPUT', data: {id: noteId}});\n    },\n\n    completion: function(paragraphId, buf, cursor) {\n      websocketEvents.sendNewEvent({\n        op: 'COMPLETION',\n        data: {\n          id: paragraphId,\n          buf: buf,\n          cursor: cursor\n        }\n      });\n    },\n\n    commitParagraph: function(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n      websocketEvents.sendNewEvent({\n        op: 'COMMIT_PARAGRAPH',\n        data: {\n          id: paragraphId,\n          title: paragraphTitle,\n          paragraph: paragraphData,\n          config: paragraphConfig,\n          params: paragraphParams\n        }\n      });\n    },\n\n    importNote: function(note) {\n      websocketEvents.sendNewEvent({\n        op: 'IMPORT_NOTE',\n        data: {\n          note: note\n        }\n      });\n    },\n\n    checkpointNote: function(noteId, commitMessage) {\n      websocketEvents.sendNewEvent({\n        op: 'CHECKPOINT_NOTE',\n        data: {\n          noteId: noteId,\n          commitMessage: commitMessage\n        }\n      });\n    },\n\n    setNoteRevision: function(noteId, revisionId) {\n      websocketEvents.sendNewEvent({\n        op: 'SET_NOTE_REVISION',\n        data: {\n          noteId: noteId,\n          revisionId: revisionId\n        }\n      });\n    },\n\n    listRevisionHistory: function(noteId) {\n      websocketEvents.sendNewEvent({\n        op: 'LIST_REVISION_HISTORY',\n        data: {\n          noteId: noteId\n        }\n      });\n    },\n\n    getNoteByRevision: function(noteId, revisionId) {\n      websocketEvents.sendNewEvent({\n        op: 'NOTE_REVISION',\n        data: {\n          noteId: noteId,\n          revisionId: revisionId\n        }\n      });\n    },\n\n    getEditorSetting: function(paragraphId, replName) {\n      websocketEvents.sendNewEvent({\n        op: 'EDITOR_SETTING',\n        data: {\n          paragraphId: paragraphId,\n          magic: replName\n        }\n      });\n    },\n\n    isConnected: function() {\n      return websocketEvents.isConnected();\n    },\n\n    getNoteJobsList: function() {\n      websocketEvents.sendNewEvent({op: 'LIST_NOTE_JOBS'});\n    },\n\n    getUpdateNoteJobsList: function(lastUpdateServerUnixTime) {\n      websocketEvents.sendNewEvent(\n        {op: 'LIST_UPDATE_NOTE_JOBS', data: {lastUpdateUnixTime: lastUpdateServerUnixTime * 1}}\n      );\n    },\n\n    unsubscribeJobManager: function() {\n      websocketEvents.sendNewEvent({op: 'UNSUBSCRIBE_UPDATE_NOTE_JOBS'});\n    },\n\n    getInterpreterBindings: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'GET_INTERPRETER_BINDINGS', data: {noteId: noteId}});\n    },\n\n    saveInterpreterBindings: function(noteId, selectedSettingIds) {\n      websocketEvents.sendNewEvent({op: 'SAVE_INTERPRETER_BINDINGS',\n        data: {noteId: noteId, selectedSettingIds: selectedSettingIds}});\n    },\n\n    listConfigurations: function() {\n      websocketEvents.sendNewEvent({op: 'LIST_CONFIGURATIONS'});\n    },\n\n    getInterpreterSettings: function() {\n      websocketEvents.sendNewEvent({op: 'GET_INTERPRETER_SETTINGS'});\n    }\n\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/websocketEvents/websocketMsg.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').factory('websocketEvents', websocketEvents);\n\nwebsocketEvents.$inject = ['$rootScope', '$websocket', '$location', 'baseUrlSrv'];\n\nfunction websocketEvents($rootScope, $websocket, $location, baseUrlSrv) {\n  var websocketCalls = {};\n  var pingIntervalId;\n\n  websocketCalls.ws = $websocket(baseUrlSrv.getWebsocketUrl());\n  websocketCalls.ws.reconnectIfNotNormalClose = true;\n\n  websocketCalls.ws.onOpen(function() {\n    console.log('Websocket created');\n    $rootScope.$broadcast('setConnectedStatus', true);\n    pingIntervalId = setInterval(function() {\n      websocketCalls.sendNewEvent({op: 'PING'});\n    }, 10000);\n  });\n\n  websocketCalls.sendNewEvent = function(data) {\n    if ($rootScope.ticket !== undefined) {\n      data.principal = $rootScope.ticket.principal;\n      data.ticket = $rootScope.ticket.ticket;\n      data.roles = $rootScope.ticket.roles;\n    } else {\n      data.principal = '';\n      data.ticket = '';\n      data.roles = '';\n    }\n    console.log('Send >> %o, %o, %o, %o, %o', data.op, data.principal, data.ticket, data.roles, data);\n    websocketCalls.ws.send(JSON.stringify(data));\n  };\n\n  websocketCalls.isConnected = function() {\n    return (websocketCalls.ws.socket.readyState === 1);\n  };\n\n  websocketCalls.ws.onMessage(function(event) {\n    var payload;\n    if (event.data) {\n      payload = angular.fromJson(event.data);\n    }\n    console.log('Receive << %o, %o', payload.op, payload);\n    var op = payload.op;\n    var data = payload.data;\n    if (op === 'NOTE') {\n      $rootScope.$broadcast('setNoteContent', data.note);\n    } else if (op === 'NEW_NOTE') {\n      $location.path('/notebook/' + data.note.id);\n    } else if (op === 'NOTES_INFO') {\n      $rootScope.$broadcast('setNoteMenu', data.notes);\n    } else if (op === 'LIST_NOTE_JOBS') {\n      $rootScope.$broadcast('setNoteJobs', data.noteJobs);\n    } else if (op === 'LIST_UPDATE_NOTE_JOBS') {\n      $rootScope.$broadcast('setUpdateNoteJobs', data.noteRunningJobs);\n    } else if (op === 'AUTH_INFO') {\n      var btn = [];\n      if ($rootScope.ticket.roles === '[]') {\n        btn = [{\n          label: 'Close',\n          action: function(dialog) {\n            dialog.close();\n          }\n        }];\n      } else {\n        btn = [{\n          label: 'Login',\n          action: function(dialog) {\n            dialog.close();\n            angular.element('#loginModal').modal({\n              show: 'true'\n            });\n          }\n        }, {\n          label: 'Cancel',\n          action: function(dialog) {\n            dialog.close();\n            // using $rootScope.apply to trigger angular digest cycle\n            // changing $location.path inside bootstrap modal wont trigger digest\n            $rootScope.$apply(function() {\n              $location.path('/');\n            });\n          }\n        }];\n      }\n\n      BootstrapDialog.show({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: 'Insufficient privileges',\n        message: data.info.toString(),\n        buttons: btn\n      });\n\n    } else if (op === 'PARAGRAPH') {\n      $rootScope.$broadcast('updateParagraph', data);\n    } else if (op === 'PARAGRAPH_APPEND_OUTPUT') {\n      $rootScope.$broadcast('appendParagraphOutput', data);\n    } else if (op === 'PARAGRAPH_UPDATE_OUTPUT') {\n      $rootScope.$broadcast('updateParagraphOutput', data);\n    } else if (op === 'PROGRESS') {\n      $rootScope.$broadcast('updateProgress', data);\n    } else if (op === 'COMPLETION_LIST') {\n      $rootScope.$broadcast('completionList', data);\n    } else if (op === 'EDITOR_SETTING') {\n      $rootScope.$broadcast('editorSetting', data);\n    } else if (op === 'ANGULAR_OBJECT_UPDATE') {\n      $rootScope.$broadcast('angularObjectUpdate', data);\n    } else if (op === 'ANGULAR_OBJECT_REMOVE') {\n      $rootScope.$broadcast('angularObjectRemove', data);\n    } else if (op === 'APP_APPEND_OUTPUT') {\n      $rootScope.$broadcast('appendAppOutput', data);\n    } else if (op === 'APP_UPDATE_OUTPUT') {\n      $rootScope.$broadcast('updateAppOutput', data);\n    } else if (op === 'APP_LOAD') {\n      $rootScope.$broadcast('appLoad', data);\n    } else if (op === 'APP_STATUS_CHANGE') {\n      $rootScope.$broadcast('appStatusChange', data);\n    } else if (op === 'LIST_REVISION_HISTORY') {\n      $rootScope.$broadcast('listRevisionHistory', data);\n    } else if (op === 'NOTE_REVISION') {\n      $rootScope.$broadcast('noteRevision', data);\n    } else if (op === 'INTERPRETER_BINDINGS') {\n      $rootScope.$broadcast('interpreterBindings', data);\n    } else if (op === 'ERROR_INFO') {\n      BootstrapDialog.show({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: 'Details',\n        message: data.info.toString(),\n        buttons: [{\n          // close all the dialogs when there are error on running all paragraphs\n          label: 'Close',\n          action: function() {\n            BootstrapDialog.closeAll();\n          }\n        }]\n      });\n    } else if (op === 'SESSION_LOGOUT') {\n      $rootScope.$broadcast('session_logout', data);\n    } else if (op === 'CONFIGURATIONS_INFO') {\n      $rootScope.$broadcast('configurationsInfo', data);\n    } else if (op === 'INTERPRETER_SETTINGS') {\n      $rootScope.$broadcast('interpreterSettings', data);\n    } else if (op === 'PARAGRAPH_ADDED') {\n      $rootScope.$broadcast('addParagraph', data.paragraph, data.index);\n    } else if (op === 'PARAGRAPH_REMOVED') {\n      $rootScope.$broadcast('removeParagraph', data.id);\n    } else if (op === 'PARAGRAPH_MOVED') {\n      $rootScope.$broadcast('moveParagraph', data.id, data.index);\n    } else if (op === 'NOTE_UPDATED') {\n      $rootScope.$broadcast('updateNote', data.name, data.config, data.info);\n    } else if (op === 'SET_NOTE_REVISION') {\n      $rootScope.$broadcast('setNoteRevisionResult', data);\n    }\n  });\n\n  websocketCalls.ws.onError(function(event) {\n    console.log('error message: ', event);\n    $rootScope.$broadcast('setConnectedStatus', false);\n  });\n\n  websocketCalls.ws.onClose(function(event) {\n    console.log('close message: ', event);\n    if (pingIntervalId !== undefined) {\n      clearInterval(pingIntervalId);\n      pingIntervalId = undefined;\n    }\n    $rootScope.$broadcast('setConnectedStatus', false);\n  });\n\n  return websocketCalls;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/websocketEvents/websocketEvents.factory.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').factory('noteListDataFactory', noteListDataFactory);\n\nnoteListDataFactory.$inject = ['TRASH_FOLDER_ID'];\n\nfunction noteListDataFactory(TRASH_FOLDER_ID) {\n  var notes = {\n    root: {children: []},\n    flatList: [],\n    flatFolderMap: {},\n\n    setNotes: function(notesList) {\n      // a flat list to boost searching\n      notes.flatList = _.map(notesList, (note) => {\n        note.isTrash = note.name ?\n          note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n        return note;\n      });\n\n      // construct the folder-based tree\n      notes.root = {children: []};\n      notes.flatFolderMap = {};\n      _.reduce(notesList, function(root, note) {\n        var noteName = note.name || note.id;\n        var nodes = noteName.match(/([^\\/][^\\/]*)/g);\n\n        // recursively add nodes\n        addNode(root, nodes, note.id);\n\n        return root;\n      }, notes.root);\n    }\n  };\n\n  var addNode = function(curDir, nodes, noteId) {\n    if (nodes.length === 1) {  // the leaf\n      curDir.children.push({\n        name: nodes[0],\n        id: noteId,\n        path: curDir.id ? curDir.id + '/' + nodes[0] : nodes[0],\n        isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n      });\n    } else {  // a folder node\n      var node = nodes.shift();\n      var dir = _.find(curDir.children,\n        function(c) {return c.name === node && c.children !== undefined;});\n      if (dir !== undefined) { // found an existing dir\n        addNode(dir, nodes, noteId);\n      } else {\n        var newDir = {\n          id: curDir.id ? curDir.id + '/' + node : node,\n          name: node,\n          hidden: true,\n          children: [],\n          isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n        };\n\n        // add the folder to flat folder map\n        notes.flatFolderMap[newDir.id] = newDir;\n\n        curDir.children.push(newDir);\n        addNode(newDir, nodes, noteId);\n      }\n    }\n  };\n\n  return notes;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteListDataFactory/noteList.datafactory.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('baseUrlSrv', baseUrlSrv);\n\nfunction baseUrlSrv() {\n  this.getPort = function() {\n    var port = Number(location.port);\n    if (!port) {\n      port = 80;\n      if (location.protocol === 'https:') {\n        port = 443;\n      }\n    }\n    //Exception for when running locally via grunt\n    if (port === 3333 || port === 9000) {\n      port = 8080;\n    }\n    return port;\n  };\n\n  this.getWebsocketUrl = function() {\n    var wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';\n    return wsProtocol + '//' + location.hostname + ':' + this.getPort() +\n      skipTrailingSlash(location.pathname) + '/ws';\n  };\n\n  this.getRestApiBase = function() {\n    return location.protocol + '//' + location.hostname + ':' +\n      this.getPort() + skipTrailingSlash(location.pathname) +\n      '/api';\n  };\n\n  var skipTrailingSlash = function(path) {\n    return path.replace(/\\/$/, '');\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/baseUrl/baseUrl.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('browserDetectService', browserDetectService);\n\nfunction browserDetectService() {\n  this.detectIE = function() {\n    var ua = window.navigator.userAgent;\n    var msie = ua.indexOf('MSIE ');\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n    var trident = ua.indexOf('Trident/');\n    if (trident > 0) {\n      // IE 11 => return version number\n      var rv = ua.indexOf('rv:');\n      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n    var edge = ua.indexOf('Edge/');\n    if (edge > 0) {\n      // IE 12 (aka Edge) => return version number\n      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n    }\n    // other browser\n    return false;\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/browser-detect/browserDetect.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('saveAsService', saveAsService);\n\nsaveAsService.$inject = ['browserDetectService'];\n\nfunction saveAsService(browserDetectService) {\n  this.saveAs = function(content, filename, extension) {\n    var BOM = '\\uFEFF';\n    if (browserDetectService.detectIE()) {\n      angular.element('body').append('<iframe id=\"SaveAsId\" style=\"display: none\"></iframe>');\n      var frameSaveAs = angular.element('body > iframe#SaveAsId')[0].contentWindow;\n      content = BOM + content;\n      frameSaveAs.document.open('text/json', 'replace');\n      frameSaveAs.document.write(content);\n      frameSaveAs.document.close();\n      frameSaveAs.focus();\n      var t1 = Date.now();\n      frameSaveAs.document.execCommand('SaveAs', false, filename + '.' + extension);\n      var t2 = Date.now();\n\n      //This means, this version of IE dosen't support auto download of a file with extension provided in param\n      //falling back to \".txt\"\n      if (t1 === t2) {\n        frameSaveAs.document.execCommand('SaveAs', true, filename + '.txt');\n      }\n      angular.element('body > iframe#SaveAsId').remove();\n    } else {\n      content = 'data:image/svg;charset=utf-8,' + BOM + encodeURIComponent(content);\n      angular.element('body').append('<a id=\"SaveAsId\"></a>');\n      var saveAsElement = angular.element('body > a#SaveAsId');\n      saveAsElement.attr('href', content);\n      saveAsElement.attr('download', filename + '.' + extension);\n      saveAsElement.attr('target', '_blank');\n      saveAsElement[0].click();\n      saveAsElement.remove();\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/saveAs/saveAs.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('searchService', searchService);\n\nsearchService.$inject = ['$resource', 'baseUrlSrv'];\n\nfunction searchService($resource, baseUrlSrv) {\n  this.search = function(term) {\n    this.searchTerm = term.q;\n    console.log('Searching for: %o', term.q);\n    if (!term.q) { //TODO(bzz): empty string check\n      return;\n    }\n    var encQuery = window.encodeURIComponent(term.q);\n    return $resource(baseUrlSrv.getRestApiBase() + '/notebook/search?q=' + encQuery, {}, {\n      query: {method: 'GET'}\n    });\n  };\n\n  this.searchTerm = '';\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/searchService/search.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('LoginCtrl', LoginCtrl);\n\nLoginCtrl.$inject = ['$scope', '$rootScope', '$http', '$httpParamSerializer', 'baseUrlSrv', '$location', '$timeout'];\nfunction LoginCtrl($scope, $rootScope, $http, $httpParamSerializer, baseUrlSrv, $location, $timeout) {\n\n  $scope.SigningIn = false;\n  $scope.loginParams = {};\n  $scope.login = function() {\n\n    $scope.SigningIn = true;\n    $http({\n      method: 'POST',\n      url: baseUrlSrv.getRestApiBase() + '/login',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      data: $httpParamSerializer({\n        'userName': $scope.loginParams.userName,\n        'password': $scope.loginParams.password\n      })\n    }).then(function successCallback(response) {\n      $rootScope.ticket = response.data.body;\n      angular.element('#loginModal').modal('toggle');\n      $rootScope.$broadcast('loginSuccess', true);\n      $rootScope.userName = $scope.loginParams.userName;\n      $scope.SigningIn = false;\n\n      //redirect to the page from where the user originally was\n      if ($location.search() && $location.search()['ref']) {\n        $timeout(function() {\n          var redirectLocation = $location.search()['ref'];\n          $location.$$search = {};\n          $location.path(redirectLocation);\n        }, 100);\n\n      }\n    }, function errorCallback(errorResponse) {\n      $scope.loginParams.errorText = 'The username and password that you entered don\\'t match.';\n      $scope.SigningIn = false;\n    });\n\n  };\n\n  var initValues = function() {\n    $scope.loginParams = {\n      userName: '',\n      password: ''\n    };\n  };\n\n  //handle session logout message received from WebSocket\n  $rootScope.$on('session_logout', function(event, data) {\n    if ($rootScope.userName !== '') {\n      $rootScope.userName = '';\n      $rootScope.ticket = undefined;\n\n      setTimeout(function() {\n        $scope.loginParams = {};\n        $scope.loginParams.errorText = data.info;\n        angular.element('.nav-login-btn').click();\n      }, 1000);\n      var locationPath = $location.path();\n      $location.path('/').search('ref', locationPath);\n    }\n  });\n\n  /*\n   ** $scope.$on functions below\n   */\n  $scope.$on('initLoginValues', function() {\n    initValues();\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/login/login.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('ElasticInputCtrl', ElasticInputCtrl);\n\nfunction ElasticInputCtrl() {\n  var vm = this;\n  vm.showEditor = false;\n  vm.value = '';\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/elasticInputCtrl/elasticInput.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('noteActionSrv', noteActionSrv);\n\nnoteActionSrv.$inject = ['websocketMsgSrv', '$location', 'renameSrv', 'noteListDataFactory'];\n\nfunction noteActionSrv(websocketMsgSrv, $location, renameSrv, noteListDataFactory) {\n  this.moveNoteToTrash = function(noteId, redirectToHome) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: 'Move this note to trash?',\n      message: 'This note will be moved to <strong>trash</strong>.',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.moveNoteToTrash(noteId);\n          if (redirectToHome) {\n            $location.path('/');\n          }\n        }\n      }\n    });\n  };\n\n  this.moveFolderToTrash = function(folderId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: 'Move this folder to trash?',\n      message: 'This folder will be moved to <strong>trash</strong>.',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.moveFolderToTrash(folderId);\n        }\n      }\n    });\n  };\n\n  this.removeNote = function(noteId, redirectToHome) {\n    BootstrapDialog.confirm({\n      type: BootstrapDialog.TYPE_WARNING,\n      closable: true,\n      title: 'WARNING! This note will be removed permanently',\n      message: 'This cannot be undone. Are you sure?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.deleteNote(noteId);\n          if (redirectToHome) {\n            $location.path('/');\n          }\n        }\n      }\n    });\n  };\n\n  this.removeFolder = function(folderId) {\n    BootstrapDialog.confirm({\n      type: BootstrapDialog.TYPE_WARNING,\n      closable: true,\n      title: 'WARNING! This folder will be removed permanently',\n      message: 'This cannot be undone. Are you sure?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.removeFolder(folderId);\n        }\n      }\n    });\n  };\n\n  this.restoreAll = function() {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: 'Are you sure want to restore all notes in the trash?',\n      message: 'Folders and notes in the trash will be ' +\n      '<strong>merged</strong> into their original position.',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.restoreAll();\n        }\n      }\n    });\n  };\n\n  this.emptyTrash = function() {\n    BootstrapDialog.confirm({\n      type: BootstrapDialog.TYPE_WARNING,\n      closable: true,\n      title: 'WARNING! Notes under trash will be removed permanently',\n      message: 'This cannot be undone. Are you sure?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.emptyTrash();\n        }\n      }\n    });\n  };\n\n  this.clearAllParagraphOutput = function(noteId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to clear all output?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.clearAllParagraphOutput(noteId);\n        }\n      }\n    });\n  };\n\n  this.renameNote = function(noteId, notePath) {\n    renameSrv.openRenameModal({\n      title: 'Rename note',\n      oldName: notePath,\n      callback: function(newName) {\n        websocketMsgSrv.renameNote(noteId, newName);\n      }\n    });\n  };\n\n  this.renameFolder = function(folderId) {\n    renameSrv.openRenameModal({\n      title: 'Rename folder',\n      oldName: folderId,\n      callback: function(newName) {\n        var newFolderId = normalizeFolderId(newName);\n        if (_.has(noteListDataFactory.flatFolderMap, newFolderId)) {\n          BootstrapDialog.confirm({\n            type: BootstrapDialog.TYPE_WARNING,\n            closable: true,\n            title: 'WARNING! The folder will be MERGED',\n            message: 'The folder will be merged into <strong>' + newFolderId + '</strong>. Are you sure?',\n            callback: function(result) {\n              if (result) {\n                websocketMsgSrv.renameFolder(folderId, newFolderId);\n              }\n            }\n          });\n        } else {\n          websocketMsgSrv.renameFolder(folderId, newFolderId);\n        }\n      }\n    });\n  };\n\n  function normalizeFolderId(folderId) {\n    folderId = folderId.trim();\n\n    while (folderId.indexOf('\\\\') > -1) {\n      folderId = folderId.replace('\\\\', '/');\n    }\n\n    while (folderId.indexOf('///') > -1) {\n      folderId = folderId.replace('///', '/');\n    }\n\n    folderId = folderId.replace('//', '/');\n\n    if (folderId === '/') {\n      return '/';\n    }\n\n    if (folderId[0] === '/') {\n      folderId = folderId.substring(1);\n    }\n\n    if (folderId.slice(-1) === '/') {\n      folderId = folderId.slice(0, -1);\n    }\n\n    return folderId;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteAction/noteAction.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('noteVarShareService', noteVarShareService);\n\nnoteVarShareService.$inject = [];\n\nfunction noteVarShareService() {\n  var store = {};\n\n  this.clear = function() {\n    store = {};\n  };\n\n  this.put = function(key, value) {\n    store[key] = value;\n  };\n\n  this.get = function(key) {\n    return store[key];\n  };\n\n  this.del = function(key) {\n    var v = store[key];\n    delete store[key];\n    return v;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/notevarshareService/notevarshare.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('RenameCtrl', RenameCtrl);\n\nRenameCtrl.$inject = ['$scope'];\n\nfunction RenameCtrl($scope) {\n  var self = this;\n\n  $scope.params = {newName: ''};\n  $scope.isValid = true;\n\n  $scope.rename = function() {\n    angular.element('#renameModal').modal('hide');\n    self.callback($scope.params.newName);\n  };\n\n  $scope.$on('openRenameModal', function(event, options) {\n    self.validator = options.validator || defaultValidator;\n    self.callback = options.callback || function() {};\n\n    $scope.title = options.title || 'Rename';\n    $scope.params.newName = options.oldName || '';\n    $scope.validate = function() {\n      $scope.isValid = self.validator($scope.params.newName);\n    };\n\n    angular.element('#renameModal').modal('show');\n  });\n\n  function defaultValidator(str) {\n    return !!str.trim();\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/rename/rename.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('renameSrv', renameSrv);\n\nrenameSrv.$inject = ['$rootScope'];\n\nfunction renameSrv($rootScope) {\n  var self = this;\n\n  /**\n   * <options schema>\n   * title: string - Modal title\n   * oldName: string - name to initialize input\n   * callback: (newName: string)=>void - callback onButtonClick\n   * validator: (str: string)=>boolean - input validator\n   */\n  self.openRenameModal = function(options) {\n    $rootScope.$broadcast('openRenameModal', options);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/rename/rename.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\n  angular.module('zeppelinWebApp').service('heliumService', heliumService);\n\n  heliumService.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\n  function heliumService($http, baseUrlSrv, ngToast) {\n\n    var url = baseUrlSrv.getRestApiBase() + '/helium/visualizations/load';\n    if (process.env.HELIUM_VIS_DEV) {\n      url = url + '?refresh=true';\n    }\n    var visualizations = [];\n\n    // load should be promise\n    this.load = $http.get(url).success(function(response) {\n      if (response.substring(0, 'ERROR:'.length) !== 'ERROR:') {\n        eval(response);\n      } else {\n        console.error(response);\n      }\n    });\n\n    this.get = function() {\n      return visualizations;\n    };\n\n    this.getVisualizationOrder = function() {\n      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder');\n    };\n\n    this.setVisualizationOrder = function(list) {\n      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder', list);\n    };\n\n    this.getAllPackageInfo = function() {\n      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/all');\n    };\n\n    this.enable = function(name, artifact) {\n      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/enable/' + name, artifact);\n    };\n\n    this.disable = function(name) {\n      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/disable/' + name);\n    };\n  };\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/helium/helium.service.js"],"sourceRoot":""}